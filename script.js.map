{"version":3,"file":"script.js","mappings":"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","sources":["webpack://cam-3d-animation/webpack/bootstrap","webpack://cam-3d-animation/webpack/runtime/compat get default export","webpack://cam-3d-animation/webpack/runtime/define property getters","webpack://cam-3d-animation/webpack/runtime/hasOwnProperty shorthand","webpack://cam-3d-animation/external var \"THREE\"","webpack://cam-3d-animation/./src/config/config.ts","webpack://cam-3d-animation/./src/animation/constants.ts","webpack://cam-3d-animation/./src/config/dom-elements.ts","webpack://cam-3d-animation/./src/paths/coordinates.ts","webpack://cam-3d-animation/./src/paths/pathpoints.ts","webpack://cam-3d-animation/./src/core/camera.ts","webpack://cam-3d-animation/./src/core/scene.ts","webpack://cam-3d-animation/external var \"ScrollTrigger\"","webpack://cam-3d-animation/./src/core/materials.ts","webpack://cam-3d-animation/./src/core/objects.ts","webpack://cam-3d-animation/./src/paths/paths.ts","webpack://cam-3d-animation/external var \"gsap\"","webpack://cam-3d-animation/./src/animation/util.ts","webpack://cam-3d-animation/./src/core/material-utils.ts","webpack://cam-3d-animation/./src/animation/scene-utils.ts","webpack://cam-3d-animation/./src/animation/scene-presets.ts","webpack://cam-3d-animation/./src/animation/object-state.ts","webpack://cam-3d-animation/./src/animation/home-scroll.ts","webpack://cam-3d-animation/./src/animation/home-loop.ts","webpack://cam-3d-animation/./src/animation/pov-scroll.ts","webpack://cam-3d-animation/./src/animation/intro-scroll.ts","webpack://cam-3d-animation/./src/animation/outro-scroll.ts","webpack://cam-3d-animation/./src/core/debug-pill.ts","webpack://cam-3d-animation/./src/core/debug-hud.ts","webpack://cam-3d-animation/./src/main.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = THREE;","export const isMobile = window.innerWidth < 768;\n\nexport const ASSETS = {\n  mazeTexture: \"https://c-am.b-cdn.net/CAM/matcap24.png\",\n  mazeModel: \"https://c-am.b-cdn.net/CAM/c-am-assets-3.glb\",\n};\n","export const SCALE = {\n  PACMAN_HOME: 0.05,\n  PACMAN_INTRO: 0.1,\n  GHOST_NORMAL: 1.0,\n  GHOST_INTRO: 1.5,\n  GHOST_POV: 0.5,\n} as const;\n\nexport const OPACITY = {\n  FULL: 1.0,\n  HIDDEN: 0.0,\n} as const;\n\nexport const SCROLL_SELECTORS = {\n  HOME: \".sc--home.sc\",\n  INTRO: \".sc--intro.sc\",\n  POV: \".sc--pov.sc\",\n  OUTRO: \".sc--outro.sc\",\n} as const;\n\nexport const TANGENT_SMOOTHING = {\n  HOME_LOOP: 0.06,\n  POV: 0.08,\n} as const;\n\nexport const PARAMETER_SMOOTHING_FACTOR = 0.1;\nexport const GHOST_FADE_THRESHOLD = 0.9;\nexport const GHOST_FADE_OUT_DURATION = 0.1;\n\nexport const INTRO_WALK_DISTANCE = 10.0;\nexport const INTRO_FADE_IN_DURATION = 0.2;\nexport const INTRO_POSITION_OFFSET = {\n  x: 4.3,\n  y: -2.0,\n  z: 0.0,\n} as const;\n\nexport const FIND_CLOSEST_SAMPLES = 800;\n\nexport const SCRUB_DURATION = 0.5;\nexport const STAGGER_AMOUNT = 0.15;\nexport const ROTATION_TRANSITION_DURATION = 1.5;\n\nexport const POV_SEQUENCE_PHASE_END = 0.05;\nexport const POV_TRANSITION_PHASE_END = 0.07;\nexport const POV_Y_CONSTRAINT_THRESHOLD = 0.15;\nexport const OPACITY_VISIBILITY_THRESHOLD = 0.01;\n\nexport const KEYFRAME_SCALE = {\n  START: 0.5,\n  MID: 0.8,\n  LARGE: 1.2,\n  END: 1.5,\n} as const;\n\nexport const KEYFRAME_DURATION = {\n  NONE: 0,\n  FADE_IN: 0.3,\n  HOLD: 0.4,\n  FADE_OUT: 0.3,\n} as const;\n\nexport const INTRO_GHOST_OFFSETS = {\n  GHOST1: 0.0,\n  GHOST2: -0.005,\n  GHOST3: -0.01,\n  GHOST4: -0.015,\n  GHOST5: -0.02,\n} as const;\n\nexport function clamp(value: number, min: number = 0, max: number = 1): number {\n  return Math.max(min, Math.min(max, value));\n}\n","import { SCROLL_SELECTORS } from \"../animation/constants\";\n\nconst SELECTORS = {\n  mazeContainer: \".el--home-maze.el\",\n  canvas: \"canvas\",\n\n  homeSection: SCROLL_SELECTORS.HOME,\n  introSection: SCROLL_SELECTORS.INTRO,\n  povSection: SCROLL_SELECTORS.POV,\n  finalSection: SCROLL_SELECTORS.OUTRO,\n  finalContainer: \".cr--outro.cr\",\n\n  scrollComponent: \".cmp--scroll.cmp\",\n  parentElements: \".cmp--pov.cmp\",\n\n  pov: \".pov\",\n  cam: \".cam\",\n};\n\nexport const DOM_ELEMENTS = {\n  mazeContainer: document.querySelector(SELECTORS.mazeContainer) as HTMLElement,\n  canvas: document.querySelector(SELECTORS.canvas) as HTMLCanvasElement,\n\n  homeSection: document.querySelector(SELECTORS.homeSection) as HTMLElement,\n  introSection: document.querySelector(SELECTORS.introSection) as HTMLElement,\n  povSection: document.querySelector(SELECTORS.povSection) as HTMLElement,\n  finalSection: document.querySelector(SELECTORS.finalSection) as HTMLElement,\n  finalContainer: document.querySelector(\n    SELECTORS.finalContainer\n  ) as HTMLElement,\n\n  parentElements: document.querySelectorAll(\n    SELECTORS.parentElements\n  ) as NodeListOf<Element>,\n};\n","import * as THREE from \"three\";\n\nexport type XCoordKey =\n  | \"0\"\n  | \"0.5\"\n  | \"1\"\n  | \"1.5\"\n  | \"2\"\n  | \"2.5\"\n  | \"3\"\n  | \"3.5\"\n  | \"4\"\n  | \"4.5\"\n  | \"5\"\n  | \"5.5\"\n  | \"6\"\n  | \"6.5\"\n  | \"7\"\n  | \"7.5\"\n  | \"8\"\n  | \"8.5\"\n  | \"9\"\n  | \"9.5\"\n  | \"10\"\n  | \"10.5\"\n  | \"11\"\n  | \"11.5\"\n  | \"12\"\n  | \"12.5\"\n  | \"13\"\n  | \"13.5\"\n  | \"14\"\n  | \"14.5\"\n  | \"15\"\n  | \"15.5\"\n  | \"16\"\n  | \"16.5\"\n  | \"17\"\n  | \"17.5\"\n  | \"18\"\n  | \"18.5\"\n  | \"19\"\n  | \"19.5\"\n  | \"20\"\n\nexport type ZCoordKey =\n  | \"0\"\n  | \"0.5\"\n  | \"1\"\n  | \"1.5\"\n  | \"2\"\n  | \"2.5\"\n  | \"3\"\n  | \"3.5\"\n  | \"4\"\n  | \"4.5\"\n  | \"5\"\n  | \"5.5\"\n  | \"6\"\n  | \"6.5\"\n  | \"7\"\n  | \"7.5\"\n  | \"8\"\n  | \"8.5\"\n  | \"9\"\n  | \"9.5\"\n  | \"10\"\n  | \"10.5\"\n  | \"11\"\n  | \"11.5\"\n  | \"12\"\n  | \"12.5\"\n  | \"13\"\n  | \"13.5\"\n  | \"14\"\n  | \"14.5\"\n  | \"15\"\n  | \"15.5\"\n  | \"16\"\n\nexport const Y = 0.55;\n\nexport const X: Record<XCoordKey, number> = {\n  \"0\": -0.54875,\n  \"0.5\": -0.4985,\n  \"1\": -0.44825,\n  \"1.5\": -0.398,\n  \"2\": -0.34775,\n  \"2.5\": -0.2975,\n  \"3\": -0.24725,\n  \"3.5\": -0.197,\n  \"4\": -0.14675,\n  \"4.5\": -0.0965,\n  \"5\": -0.04625,\n  \"5.5\": 0.004,\n  \"6\": 0.05425,\n  \"6.5\": 0.1045,\n  \"7\": 0.15475,\n  \"7.5\": 0.205,\n  \"8\": 0.25525,\n  \"8.5\": 0.3055,\n  \"9\": 0.35575,\n  \"9.5\": 0.406,\n  \"10\": 0.45625,\n  \"10.5\": 0.5065,\n  \"11\": 0.55675,\n  \"11.5\": 0.607,\n  \"12\": 0.65725,\n  \"12.5\": 0.7075,\n  \"13\": 0.75775,\n  \"13.5\": 0.808,\n  \"14\": 0.85825,\n  \"14.5\": 0.9085,\n  \"15\": 0.95875,\n  \"15.5\": 1.009,\n  \"16\": 1.05925,\n  \"16.5\": 1.1095,\n  \"17\": 1.15975,\n  \"17.5\": 1.21,\n  \"18\": 1.26025,\n  \"18.5\": 1.3105,\n  \"19\": 1.36075,\n  \"19.5\": 1.411,\n  \"20\": 1.46125,\n};\n\nexport const Z: Record<ZCoordKey, number> = {\n  \"0\": -0.302,\n  \"0.5\": -0.25175,\n  \"1\": -0.2015,\n  \"1.5\": -0.15125,\n  \"2\": -0.101,\n  \"2.5\": -0.05075,\n  \"3\": -0.0005,\n  \"3.5\": 0.04975,\n  \"4\": 0.1,\n  \"4.5\": 0.15025,\n  \"5\": 0.2005,\n  \"5.5\": 0.25075,\n  \"6\": 0.301,\n  \"6.5\": 0.35125,\n  \"7\": 0.4015,\n  \"7.5\": 0.45175,\n  \"8\": 0.502,\n  \"8.5\": 0.55225,\n  \"9\": 0.6025,\n  \"9.5\": 0.65275,\n  \"10\": 0.703,\n  \"10.5\": 0.75325,\n  \"11\": 0.8035,\n  \"11.5\": 0.85375,\n  \"12\": 0.904,\n  \"12.5\": 0.95425,\n  \"13\": 1.0045,\n  \"13.5\": 1.05475,\n  \"14\": 1.105,\n  \"14.5\": 1.15525,\n  \"15\": 1.2055,\n  \"15.5\": 1.25575,\n  \"16\": 1.306,\n}\n\nexport const getCoord = (x: XCoordKey, z: ZCoordKey) => {\n  return new THREE.Vector3(X[x], Y, Z[z])\n};","import * as THREE from \"three\";\nimport { MazePathPoint, PathPoint, CameraPathPoint } from \"../types/types\";\nimport { isMobile } from \"../config/config\";\nimport { getCoord, X, Y, Z } from \"./coordinates\";\n\nexport const objectHomeScrollEndPathPoint = new THREE.Vector3(\n  0.55675,\n  0.35,\n  0.45175\n);\n\nconst cameraPathPointsConfig = {\n  startMobile: new THREE.Vector3(0.5, 2.5, 2.5),\n  startDesktop: new THREE.Vector3(-2, 2.5, 2),\n  secondMobile: new THREE.Vector3(0.5, 2.5, 2),\n  secondDesktop: new THREE.Vector3(-1.5, 3, 0.75),\n  mobileLookAt: new THREE.Vector3(0.5, 0.5, -1.5),\n  desktopLookAt: new THREE.Vector3(-1.25, 0.5, 0.25),\n  cameraLookAtSecondDesktop: new THREE.Vector3(-0.75, 0.5, -0.75),\n  cameraLookAtSecondMobile: new THREE.Vector3(-0.75, 0.5, -0.75),\n\n  cameraHomeScrollEndLookAt: new THREE.Vector3(0.55675, -5, 0.35),\n  thirdPosition: new THREE.Vector3(0.55675, 3, 0.45175),\n\n  cameraHomeScrollEndPathPoint: new THREE.Vector3(0.55675, 0.5, 0.45175),\n};\n\nconst startPosition = isMobile\n  ? cameraPathPointsConfig.startMobile\n  : cameraPathPointsConfig.startDesktop;\nconst secondPosition = isMobile\n  ? cameraPathPointsConfig.secondMobile\n  : cameraPathPointsConfig.secondDesktop;\nconst lookAtPosition = isMobile\n  ? cameraPathPointsConfig.mobileLookAt\n  : cameraPathPointsConfig.desktopLookAt;\nconst cameraLookAtSecondPosition = isMobile\n  ? cameraPathPointsConfig.cameraLookAtSecondMobile\n  : cameraPathPointsConfig.cameraLookAtSecondDesktop;\n\nconst thirdPosition = cameraPathPointsConfig.thirdPosition;\nconst cameraHomeScrollEndLookAt =\n  cameraPathPointsConfig.cameraHomeScrollEndLookAt;\nconst cameraHomeScrollEndPathPoint =\n  cameraPathPointsConfig.cameraHomeScrollEndPathPoint;\n\nconst pacmanHomePathPoints: MazePathPoint[] = [\n  { pos: getCoord(\"8\", \"9\"), type: \"straight\" },\n  {\n    pos: getCoord(\"8\", \"6\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"9\", \"5\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  { pos: getCoord(\"10\", \"4\"), type: \"straight\" },\n  {\n    pos: getCoord(\"10\", \"2\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"9\", \"1\"), type: \"straight\" },\n  {\n    pos: getCoord(\"7\", \"1\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"6\", \"2\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"5\", \"3\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"4\", \"2\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"3\", \"1\"),\n    type: \"straight\",\n    curveCheckPoints: [\n      getCoord(\"2\", \"1\"),\n      getCoord(\"1\", \"2\"),\n      getCoord(\"1\", \"2.5\"),\n      getCoord(\"1.5\", \"3\"),\n      getCoord(\"2\", \"3.5\"),\n    ],\n  },\n  {\n    pos: getCoord(\"2\", \"4\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"3\", \"5\"), type: \"straight\" },\n  {\n    pos: getCoord(\"5\", \"5\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"6\", \"6\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"5\", \"7\"), type: \"straight\" },\n  {\n    pos: getCoord(\"4\", \"7\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"3\", \"8\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"4\", \"9\"), type: \"straight\" },\n  {\n    pos: getCoord(\"5\", \"9\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"6\", \"10\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"5\", \"11\"),\n    type: \"straight\",\n    curveCheckPoints: [\n      getCoord(\"3\", \"11\"),\n      getCoord(\"2\", \"12\"),\n      getCoord(\"1.5\", \"13\"),\n      getCoord(\"1\", \"14\"),\n      getCoord(\"2\", \"15\"),\n      getCoord(\"3\", \"15\"),\n      getCoord(\"4\", \"14\"),\n      getCoord(\"5\", \"13\"),\n    ],\n  },\n  {\n    pos: getCoord(\"6\", \"13\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"7\", \"14\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"6\", \"15\"), type: \"straight\" },\n  {\n    pos: getCoord(\"5\", \"15\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"4\", \"14\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"5\", \"13\"),\n    type: \"straight\",\n    curveCheckPoints: [\n      getCoord(\"12\", \"13\"),\n      getCoord(\"13\", \"12\"),\n      getCoord(\"12.5\", \"11\"),\n      getCoord(\"12\", \"10.5\"),\n      getCoord(\"11\", \"10\"),\n      getCoord(\"10\", \"10.5\"),\n      getCoord(\"9\", \"11\"),\n      getCoord(\"8\", \"10\"),\n      getCoord(\"8\", \"9.5\"),\n    ],\n  },\n  {\n    pos: getCoord(\"8\", \"9\"),\n    type: \"straight\",\n  },\n];\n\nconst ghost1HomePathPoints: MazePathPoint[] = [\n  { pos: getCoord(\"1\", \"10\"), type: \"straight\" },\n  {\n    pos: getCoord(\"1\", \"6\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"2\", \"5\"), type: \"straight\" },\n  {\n    pos: getCoord(\"3\", \"5\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"4\", \"4\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"5\", \"3\"), type: \"straight\" },\n  {\n    pos: getCoord(\"9\", \"3\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"10\", \"4\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"9\", \"5\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"8\", \"6\"),\n    type: \"straight\",\n    curveCheckPoints: [\n      getCoord(\"8\", \"10\"),\n      getCoord(\"9\", \"11\"),\n      getCoord(\"10\", \"10.5\"),\n      getCoord(\"11\", \"10\"),\n      getCoord(\"12\", \"10.5\"),\n      getCoord(\"13\", \"11\"),\n      getCoord(\"15\", \"11\"),\n      getCoord(\"16\", \"10.5\"),\n      getCoord(\"17\", \"10\"),\n      getCoord(\"18\", \"10.5\"),\n      getCoord(\"19\", \"11\"),\n      getCoord(\"20\", \"10\"),\n    ],\n  },\n  {\n    pos: getCoord(\"20\", \"6\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"19\", \"5\"), type: \"straight\" },\n  {\n    pos: getCoord(\"9\", \"5\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"8\", \"6\"),\n    type: \"straight\",\n    curveCheckPoints: [\n      getCoord(\"8\", \"8\"),\n      getCoord(\"7\", \"9\"),\n      getCoord(\"6\", \"10\"),\n      getCoord(\"5.5\", \"11\"),\n      getCoord(\"5\", \"12\"),\n      getCoord(\"6\", \"13\"),\n      getCoord(\"7\", \"14\"),\n      getCoord(\"6\", \"15\"),\n      getCoord(\"5\", \"15\"),\n      getCoord(\"4\", \"14\"),\n      getCoord(\"4.5\", \"13\"),\n      getCoord(\"5\", \"12\"),\n      getCoord(\"4\", \"11\"),\n    ],\n  },\n  { pos: getCoord(\"1\", \"10\"), type: \"straight\" },\n];\n\nconst ghost2HomePathPoints: MazePathPoint[] = [\n  {\n    pos: getCoord(\"5\", \"12\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n    curveCheckPoints: [getCoord(\"5.5\", \"11\")],\n  },\n  {\n    pos: getCoord(\"6\", \"10\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"5\", \"9\"), type: \"straight\" },\n  {\n    pos: getCoord(\"4\", \"9\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"3\", \"8\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"4\", \"7\"), type: \"straight\" },\n  {\n    pos: getCoord(\"7\", \"7\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  { pos: getCoord(\"8\", \"8\"), type: \"straight\" },\n  {\n    pos: getCoord(\"8\", \"10\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n    curveCheckPoints: [getCoord(\"8.5\", \"11\"), getCoord(\"9\", \"12\")],\n  },\n  { pos: getCoord(\"10\", \"13\"), type: \"straight\" },\n  {\n    pos: getCoord(\"12\", \"13\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"13\", \"14\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"14\", \"15\"), type: \"straight\" },\n  {\n    pos: getCoord(\"19\", \"15\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  { pos: getCoord(\"20\", \"14\"), type: \"straight\" },\n  {\n    pos: getCoord(\"20\", \"4\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"19\", \"3\"), type: \"straight\" },\n  {\n    pos: getCoord(\"17\", \"3\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"16\", \"4\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"15\", \"5\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  { pos: getCoord(\"14\", \"4\"), type: \"straight\" },\n  {\n    pos: getCoord(\"14\", \"2\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"13\", \"1\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n    curveCheckPoints: [getCoord(\"12\", \"1.5\")],\n  },\n  {\n    pos: getCoord(\"11\", \"2\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  { pos: getCoord(\"10\", \"3\"), type: \"straight\" },\n  {\n    pos: getCoord(\"10\", \"4\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"9\", \"5\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  { pos: getCoord(\"8\", \"6\"), type: \"straight\" },\n  {\n    pos: getCoord(\"8\", \"10\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n    curveCheckPoints: [getCoord(\"8.5\", \"11\")],\n  },\n  {\n    pos: getCoord(\"9\", \"12\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"8\", \"13\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"7\", \"14\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"6\", \"15\"), type: \"straight\" },\n  {\n    pos: getCoord(\"5\", \"15\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"4\", \"14\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n    curveCheckPoints: [getCoord(\"4.5\", \"13\"), getCoord(\"5\", \"12\")],\n  },\n];\n\nconst ghost3HomePathPoints: MazePathPoint[] = [\n  { pos: getCoord(\"14\", \"10.5\"), type: \"straight\" },\n  {\n    pos: getCoord(\"14\", \"2\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"13\", \"1\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n    curveCheckPoints: [\n      getCoord(\"12\", \"1.5\"),\n      getCoord(\"11\", \"2\"),\n      getCoord(\"10\", \"1.5\"),\n    ],\n  },\n  { pos: getCoord(\"9\", \"1\"), type: \"straight\" },\n  {\n    pos: getCoord(\"7\", \"1\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"6\", \"2\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"7\", \"3\"), type: \"straight\" },\n  {\n    pos: getCoord(\"9\", \"3\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"10\", \"4\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"11\", \"5\"), type: \"straight\" },\n  {\n    pos: getCoord(\"19\", \"5\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  { pos: getCoord(\"20\", \"6\"), type: \"straight\" },\n  {\n    pos: getCoord(\"20\", \"10\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"19\", \"11\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n    curveCheckPoints: [\n      getCoord(\"18\", \"10.5\"),\n      getCoord(\"17\", \"10\"),\n      getCoord(\"16\", \"10.5\"),\n      getCoord(\"15.5\", \"11\"),\n    ],\n  },\n  { pos: getCoord(\"15\", \"12\"), type: \"straight\" },\n  {\n    pos: getCoord(\"15\", \"14\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"14\", \"15\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  { pos: getCoord(\"13\", \"14\"), type: \"straight\" },\n  {\n    pos: getCoord(\"13\", \"12\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n    curveCheckPoints: [\n      getCoord(\"12.5\", \"11\"),\n      getCoord(\"12\", \"10.5\"),\n      getCoord(\"10\", \"10.5\"),\n    ],\n  },\n  {\n    pos: getCoord(\"9\", \"11\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"8\", \"10\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"7\", \"9\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"6\", \"10\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n    curveCheckPoints: [getCoord(\"5.5\", \"11\")],\n  },\n  {\n    pos: getCoord(\"5\", \"12\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"6\", \"13\"), type: \"straight\" },\n  {\n    pos: getCoord(\"12\", \"13\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"13\", \"12\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"13.5\", \"11\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  { pos: getCoord(\"14\", \"10.5\"), type: \"straight\" },\n];\n\nconst ghost4HomePathPoints: MazePathPoint[] = [\n  { pos: getCoord(\"16\", \"7\"), type: \"straight\" },\n  {\n    pos: getCoord(\"16\", \"10\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"15\", \"11\"), type: \"straight\" },\n  {\n    pos: getCoord(\"14\", \"11\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"13\", \"12\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"12\", \"13\"), type: \"straight\" },\n  {\n    pos: getCoord(\"8\", \"13\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"7\", \"14\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"6\", \"15\"), type: \"straight\" },\n  {\n    pos: getCoord(\"2\", \"15\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"1\", \"14\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n    curveCheckPoints: [\n      getCoord(\"1.5\", \"13\"),\n      getCoord(\"2\", \"12\"),\n      getCoord(\"1.5\", \"11\"),\n    ],\n  },\n  { pos: getCoord(\"1\", \"10\"), type: \"straight\" },\n  {\n    pos: getCoord(\"1\", \"6\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"2\", \"5\"), type: \"straight\" },\n  {\n    pos: getCoord(\"5\", \"5\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"6\", \"6\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"7\", \"7\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"8\", \"6\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"9\", \"5\"), type: \"straight\" },\n  {\n    pos: getCoord(\"13\", \"5\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  { pos: getCoord(\"14\", \"4\"), type: \"straight\" },\n  {\n    pos: getCoord(\"14\", \"2\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"15\", \"1\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"16\", \"2\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"17\", \"3\"), type: \"straight\" },\n  {\n    pos: getCoord(\"19\", \"3\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"20\", \"2\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"19\", \"1\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"18\", \"2\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"19\", \"3\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  { pos: getCoord(\"20\", \"4\"), type: \"straight\" },\n  {\n    pos: getCoord(\"20\", \"10\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"19\", \"11\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n    curveCheckPoints: [getCoord(\"18\", \"10.5\")],\n  },\n  {\n    pos: getCoord(\"17\", \"10\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  { pos: getCoord(\"16\", \"9\"), type: \"straight\" },\n  { pos: getCoord(\"16\", \"7\"), type: \"straight\" },\n];\n\nconst ghost5HomePathPoints: MazePathPoint[] = [\n  {\n    pos: getCoord(\"10\", \"3.5\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"9\", \"3\"), type: \"straight\" },\n  {\n    pos: getCoord(\"5\", \"3\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"4\", \"2\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"3\", \"1\"), type: \"straight\" },\n  {\n    pos: getCoord(\"2\", \"1\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"1\", \"2\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"1.5\", \"3\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"2\", \"4\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"3\", \"5\"), type: \"straight\" },\n  {\n    pos: getCoord(\"5\", \"5\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"6\", \"6\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"5\", \"7\"), type: \"straight\" },\n  {\n    pos: getCoord(\"4\", \"7\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"3\", \"8\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"4\", \"9\"), type: \"straight\" },\n  {\n    pos: getCoord(\"7\", \"9\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"8\", \"10\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"8.5\", \"11\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"9\", \"12\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"10\", \"13\"), type: \"straight\" },\n  {\n    pos: getCoord(\"12\", \"13\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"13\", \"12\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"14\", \"11\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"15\", \"12\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"15\", \"14\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"16\", \"15\"), type: \"straight\" },\n  {\n    pos: getCoord(\"19\", \"15\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  { pos: getCoord(\"20\", \"14\"), type: \"straight\" },\n  {\n    pos: getCoord(\"20\", \"2\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"19\", \"1\"), type: \"straight\" },\n  {\n    pos: getCoord(\"17\", \"1\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  { pos: getCoord(\"16\", \"2\"), type: \"straight\" },\n  {\n    pos: getCoord(\"16\", \"4\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"15\", \"5\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  { pos: getCoord(\"14\", \"4\"), type: \"straight\" },\n  {\n    pos: getCoord(\"14\", \"2\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"13\", \"1\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"12\", \"1.5\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"11\", \"2\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"10\", \"3.5\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n];\n\nconst cameraHomeScrollPathPoints: CameraPathPoint[] = [\n  { pos: startPosition, lookAt: lookAtPosition },\n  { pos: secondPosition, lookAt: cameraLookAtSecondPosition },\n  { pos: thirdPosition, lookAt: cameraHomeScrollEndLookAt },\n  { pos: cameraHomeScrollEndPathPoint, lookAt: cameraHomeScrollEndLookAt },\n];\n\nconst cameraPOVPathPoints: MazePathPoint[] = [\n  {\n    pos: new THREE.Vector3(X[\"11\"], 0.40625, Z[\"7.5\"]),\n    type: \"straight\",\n    lookAtSequence: [\n      new THREE.Vector3(X[\"11\"], 0.2, Z[\"8\"]),\n      new THREE.Vector3(X[\"11\"], 1.2, Z[\"16\"]),\n      new THREE.Vector3(X[\"11\"], 0.55, Z[\"16\"]),\n    ],\n  },\n  {\n    pos: getCoord(\"11\", \"7.5\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"11\", \"9\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n    curveCheckPoints: [\n      new THREE.Vector3(X[\"11\"], Y, 0.6525),\n      getCoord(\"11.5\", \"10\"),\n      getCoord(\"12\", \"10.5\"),\n      getCoord(\"12.5\", \"11\"),\n    ],\n  },\n  {\n    pos: getCoord(\"13\", \"11\"),\n    type: \"straight\",\n  },\n  {\n    pos: getCoord(\"14.5\", \"11\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"15\", \"11.5\"),\n    type: \"straight\",\n  },\n  {\n    pos: getCoord(\"15\", \"14.5\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"14.5\", \"15\"),\n    type: \"straight\",\n  },\n  {\n    pos: getCoord(\"13.5\", \"15\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"13\", \"14.5\"),\n    type: \"straight\",\n  },\n  {\n    pos: getCoord(\"13\", \"13.5\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"12.5\", \"13\"),\n    type: \"straight\",\n  },\n  {\n    pos: getCoord(\"7.5\", \"13\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"7\", \"13.5\"),\n    type: \"straight\",\n  },\n  {\n    pos: getCoord(\"7\", \"14.5\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  {\n    pos: getCoord(\"7.5\", \"15\"),\n    type: \"straight\",\n  },\n  {\n    pos: getCoord(\"10.5\", \"15\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  {\n    pos: getCoord(\"11\", \"16\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n];\n\nconst ghost1POVPathPoints: MazePathPoint[] = [\n  { pos: getCoord(\"16\", \"10\"), type: \"straight\" },\n  {\n    pos: getCoord(\"16\", \"10.5\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"15.5\", \"11\"), type: \"straight\" },\n  { pos: getCoord(\"14.5\", \"11\"), type: \"straight\" },\n];\n\nconst ghost2POVPathPoints: MazePathPoint[] = [\n  { pos: getCoord(\"16\", \"15\"), type: \"straight\" },\n  {\n    pos: getCoord(\"15.5\", \"15\"),\n    type: \"curve\",\n    arc: \"lowerArc\",\n  },\n  { pos: getCoord(\"15\", \"14.5\"), type: \"straight\" },\n  { pos: getCoord(\"15\", \"13.5\"), type: \"straight\" },\n];\n\nconst ghost3POVPathPoints: MazePathPoint[] = [\n  { pos: getCoord(\"9\", \"12\"), type: \"straight\" },\n  {\n    pos: getCoord(\"9\", \"12.5\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"9.5\", \"13\"), type: \"straight\" },\n  { pos: getCoord(\"10.5\", \"13\"), type: \"straight\" },\n];\n\nconst ghost4POVPathPoints: MazePathPoint[] = [\n  { pos: getCoord(\"7\", \"14\"), type: \"straight\" },\n  {\n    pos: getCoord(\"7\", \"13.5\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"7.5\", \"13\"), type: \"straight\" },\n  { pos: getCoord(\"8.5\", \"13\"), type: \"straight\" },\n];\n\nconst ghost5POVPathPoints: MazePathPoint[] = [\n  { pos: getCoord(\"11\", \"16\"), type: \"straight\" },\n  {\n    pos: getCoord(\"11\", \"15.5\"),\n    type: \"curve\",\n    arc: \"upperArc\",\n  },\n  { pos: getCoord(\"10.5\", \"15\"), type: \"straight\" },\n  { pos: getCoord(\"9.5\", \"15\"), type: \"straight\" },\n];\n\nexport const povTriggerPositions = {\n  ghost1: {\n    triggerPos: new THREE.Vector3(0.65725, 0.55, 0.75325),\n    ghostStartFadeIn: new THREE.Vector3(0.7075, 0.55, 0.8035),\n    ghostEndFadeIn: new THREE.Vector3(0.725, 0.55, 0.8035),\n    ghostStartFadeOut: new THREE.Vector3(0.75, 0.55, 0.8035),\n    camStartFadeIn: new THREE.Vector3(0.75775, 0.55, 0.8035),\n    camEndFadeIn: new THREE.Vector3(0.775, 0.55, 0.8035),\n    camStartFadeOut: new THREE.Vector3(0.84, 0.55, 0.8035),\n    endPosition: new THREE.Vector3(0.85825, 0.55, 0.8035),\n    forceEndProgress: {\n      start: 0.1,\n      end: 0.16,\n    },\n  },\n  ghost2: {\n    triggerPos: new THREE.Vector3(0.9085, 0.55, 0.8035),\n    ghostStartFadeIn: new THREE.Vector3(0.95875, 0.55, 0.85375),\n    ghostEndFadeIn: new THREE.Vector3(0.95875, 0.55, 0.875),\n    ghostStartFadeOut: new THREE.Vector3(0.95875, 0.55, 0.89),\n    camStartFadeIn: new THREE.Vector3(0.95875, 0.55, 0.904),\n    camEndFadeIn: new THREE.Vector3(0.95875, 0.55, 0.93),\n    camStartFadeOut: new THREE.Vector3(0.95875, 0.55, 0.9975),\n    endPosition: new THREE.Vector3(0.95875, 0.55, 1.0045),\n    forceEndProgress: {\n      start: 0.17,\n      end: 0.22,\n    },\n  },\n  ghost3: {\n    triggerPos: new THREE.Vector3(0.75775, 0.55, 1.05475),\n    ghostStartFadeIn: new THREE.Vector3(0.7075, 0.55, 1.0045),\n    ghostEndFadeIn: new THREE.Vector3(0.7075, 0.55, 1.0045),\n    ghostStartFadeOut: new THREE.Vector3(0.6825, 0.55, 1.0045),\n    camStartFadeIn: new THREE.Vector3(0.65725, 0.55, 1.0045),\n    camEndFadeIn: new THREE.Vector3(0.65725, 0.55, 1.0045),\n    camStartFadeOut: new THREE.Vector3(0.6065, 0.55, 1.0045),\n    endPosition: new THREE.Vector3(0.55675, 0.55, 1.0045),\n    forceEndProgress: {\n      start: 0.23,\n      end: 0.33,\n    },\n  },\n  ghost4: {\n    triggerPos: new THREE.Vector3(0.65725, 0.55, 1.0045),\n    ghostStartFadeIn: new THREE.Vector3(0.5565, 0.55, 1.0045),\n    ghostEndFadeIn: new THREE.Vector3(0.5065, 0.55, 1.0045),\n    ghostStartFadeOut: new THREE.Vector3(0.4815, 0.55, 1.0045),\n    camStartFadeIn: new THREE.Vector3(0.45625, 0.55, 1.0045),\n    camEndFadeIn: new THREE.Vector3(0.45625, 0.55, 1.0045),\n    camStartFadeOut: new THREE.Vector3(0.4065, 0.55, 1.0045),\n    endPosition: new THREE.Vector3(0.35575, 0.55, 1.0045),\n    forceEndProgress: {\n      start: 0.38,\n      end: 0.47,\n    },\n  },\n  ghost5: {\n    triggerPos: new THREE.Vector3(0.15475, 0.55, 1.15525),\n    ghostStartFadeIn: new THREE.Vector3(0.1795, 0.55, 1.18),\n    ghostEndFadeIn: new THREE.Vector3(0.205, 0.55, 1.2055),\n    ghostStartFadeOut: new THREE.Vector3(0.23025, 0.55, 1.2055),\n    camStartFadeIn: new THREE.Vector3(0.25525, 0.55, 1.2055),\n    camEndFadeIn: new THREE.Vector3(0.25525, 0.55, 1.2055),\n    camStartFadeOut: new THREE.Vector3(0.3055, 0.55, 1.2055),\n    endPosition: new THREE.Vector3(0.35575, 0.55, 1.2055),\n    forceEndProgress: {\n      start: 0.52,\n      end: 0.59,\n    },\n  },\n};\n\nexport function getStartPosition() {\n  return startPosition;\n}\n\nexport function getLookAtPosition() {\n  return lookAtPosition;\n}\n\nexport const homePaths = {\n  pacman: pacmanHomePathPoints,\n  ghost1: ghost1HomePathPoints,\n  ghost2: ghost2HomePathPoints,\n  ghost3: ghost3HomePathPoints,\n  ghost4: ghost4HomePathPoints,\n  ghost5: ghost5HomePathPoints,\n} as const;\n\nexport const povPaths = {\n  camera: cameraPOVPathPoints,\n  ghost1: ghost1POVPathPoints,\n  ghost2: ghost2POVPathPoints,\n  ghost3: ghost3POVPathPoints,\n  ghost4: ghost4POVPathPoints,\n  ghost5: ghost5POVPathPoints,\n} as const;\n\nexport function createHomeScrollPathPoints(\n  pausedPositions: Record<string, THREE.Vector3>\n): Record<string, PathPoint[]> {\n  const scrollPaths: Record<string, PathPoint[]> = {};\n\n  Object.entries(pausedPositions).forEach(([key, pausedPos]) => {\n    const arcPoint = new THREE.Vector3(\n      pausedPos.x * (1 / 4) + objectHomeScrollEndPathPoint.x * (3 / 4),\n      1.5,\n      pausedPos.z * (1 / 4) + objectHomeScrollEndPathPoint.z * (3 / 4)\n    );\n\n    scrollPaths[key] = [\n      { pos: pausedPos.clone() },\n      { pos: arcPoint },\n      { pos: objectHomeScrollEndPathPoint },\n    ];\n  });\n\n  return scrollPaths;\n}\n\nexport function getCameraHomeScrollPathPoints(): CameraPathPoint[] {\n  return cameraHomeScrollPathPoints;\n}\n","import * as THREE from \"three\";\nimport { getLookAtPosition, getStartPosition } from \"../paths/pathpoints\";\n\nconst CAMERA_NEAR = 0.001;\nconst CAMERA_FAR = 100;\n\nexport const camera = new THREE.PerspectiveCamera(\n  50,\n  window.innerWidth / window.innerHeight,\n  CAMERA_NEAR,\n  CAMERA_FAR\n);\n\nexport function setupCamera(): void {\n  const startPosition = getStartPosition();\n  const lookAtPosition = getLookAtPosition();\n  camera.position.set(startPosition.x, startPosition.y, startPosition.z);\n  camera.lookAt(lookAtPosition.x, lookAtPosition.y, lookAtPosition.z);\n}\n","import * as THREE from \"three\";\nimport { isMobile } from \"../config/config\";\nimport { DOM_ELEMENTS } from \"../config/dom-elements\";\nimport { camera } from \"./camera\";\n\nexport const scene = new THREE.Scene();\n\nconst renderer = new THREE.WebGLRenderer({\n  antialias: true,\n  alpha: true,\n  powerPreference: \"high-performance\",\n  precision: \"highp\",\n});\n\nconst clock = new THREE.Clock();\nconst frameCallbacks: (() => void)[] = [];\n\nexport function initRenderer(): void {\n  enhanceAntiAliasing();\n\n  if (DOM_ELEMENTS.mazeContainer) {\n    renderer.setSize(\n      DOM_ELEMENTS.mazeContainer.clientWidth,\n      DOM_ELEMENTS.mazeContainer.clientHeight\n    );\n    DOM_ELEMENTS.mazeContainer.appendChild(renderer.domElement);\n  } else {\n    renderer.setSize(window.innerWidth, window.innerHeight);\n    document.body.appendChild(renderer.domElement);\n  }\n\n  setPixelRatio();\n  window.addEventListener(\"resize\", setPixelRatio);\n\n  renderer.render(scene, camera);\n}\n\nfunction enhanceAntiAliasing(): void {\n  if (isMobile) {\n    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));\n  } else {\n    renderer.setPixelRatio(window.devicePixelRatio);\n  }\n  renderer.shadowMap.enabled = true;\n  renderer.shadowMap.type = THREE.PCFSoftShadowMap;\n}\n\nfunction setPixelRatio(): void {\n  const pixelRatio = Math.min(window.devicePixelRatio, isMobile ? 2 : 3);\n  renderer.setPixelRatio(pixelRatio);\n\n  if (DOM_ELEMENTS.mazeContainer) {\n    renderer.setSize(\n      DOM_ELEMENTS.mazeContainer.clientWidth,\n      DOM_ELEMENTS.mazeContainer.clientHeight\n    );\n    camera.aspect =\n      DOM_ELEMENTS.mazeContainer.clientWidth /\n      DOM_ELEMENTS.mazeContainer.clientHeight;\n  } else {\n    renderer.setSize(window.innerWidth, window.innerHeight);\n    camera.aspect = window.innerWidth / window.innerHeight;\n  }\n\n  camera.updateProjectionMatrix();\n}\n\nexport function setupLighting(): void {\n  const ambientLight = new THREE.AmbientLight(0xffffff);\n  scene.add(ambientLight);\n\n  const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);\n  scene.add(directionalLight);\n  directionalLight.position.set(-5, 15, 10);\n  directionalLight.shadow.mapSize.width = 4096;\n  directionalLight.shadow.mapSize.height = 4096;\n  directionalLight.shadow.camera.left = -20;\n  directionalLight.shadow.camera.right = 20;\n  directionalLight.shadow.camera.top = 20;\n  directionalLight.shadow.camera.bottom = -20;\n  directionalLight.shadow.camera.near = 0.1;\n  directionalLight.shadow.camera.far = 50;\n  directionalLight.shadow.bias = -0.001;\n  directionalLight.shadow.radius = 3;\n  directionalLight.castShadow = true;\n}\n\nexport function startRenderLoop(): void {\n  const render = () => {\n    frameCallbacks.forEach((callback) => callback());\n\n    renderer.render(scene, camera);\n\n    requestAnimationFrame(render);\n  };\n  render();\n}\n\nexport function onFrame(callback: () => void): void {\n  frameCallbacks.push(callback);\n}\n\nexport { renderer, clock };\n","const __WEBPACK_NAMESPACE_OBJECT__ = ScrollTrigger;","import * as THREE from \"three\";\nimport { ASSETS } from \"../config/config\";\n\nconst textureLoader = new THREE.TextureLoader();\n\nconst mazeTexture = textureLoader.load(ASSETS.mazeTexture);\n\nexport const mazeMaterial = new THREE.MeshMatcapMaterial({\n  matcap: mazeTexture,\n});\n\nexport const topMaterial = new THREE.MeshStandardMaterial({\n  color: 0xf2f9f9,\n  metalness: 0.4,\n  roughness: 0,\n  envMapIntensity: 10,\n});\n\nexport const ghostMaterial = new THREE.MeshPhysicalMaterial({\n  color: 0xffffff,\n  opacity: 0.9999,\n  transparent: true,\n  depthWrite: false,\n  depthTest: true,\n  blending: THREE.NormalBlending,\n  side: THREE.DoubleSide,\n  roughness: 0.75,\n  metalness: 0.2,\n  transmission: 0.5,\n});\n\nexport const floorMaterial = new THREE.MeshStandardMaterial({\n  color: 0xffffff,\n  opacity: 0.8,\n  transparent: true,\n  roughness: 0.5,\n  metalness: 0.1,\n});\n\nconst pacmanMaterials = {\n  blue: new THREE.MeshBasicMaterial({\n    color: 0x1469d3,\n    transparent: true,\n    opacity: 1,\n  }),\n  white: new THREE.MeshBasicMaterial({\n    color: 0xffffff,\n    transparent: true,\n    opacity: 1,\n  }),\n  default: new THREE.MeshBasicMaterial({\n    color: 0x1469d3,\n    transparent: true,\n    opacity: 1,\n  }),\n};\n\nconst pillMaterials = {\n  shell: new THREE.MeshBasicMaterial({\n    color: 0x00ff00, // Green\n  }),\n  default: new THREE.MeshBasicMaterial({\n    color: 0x00ff00, // Green\n  }),\n};\n\nexport const materialMap = {\n  CAM_Pacman_Backframe: pacmanMaterials.blue,\n  \"CAM-Pacman_Bitcoin_1\": pacmanMaterials.white,\n  \"CAM-Pacman_Bitcoin_2\": pacmanMaterials.white,\n  \"CAM-Pacman_Bottom\": pacmanMaterials.blue,\n  \"CAM-Pacman_Top\": pacmanMaterials.blue,\n  \"CAM-Pacman_Eye\": pacmanMaterials.white,\n  CAM_Pacman_Logo_1: pacmanMaterials.white,\n  CAM_Pacman_Logo_2: pacmanMaterials.white,\n  \"CAM-Pacman_Shell_Boolean\": pacmanMaterials.blue,\n  \"CAM-Pacman_Shell\": pacmanMaterials.blue,\n  \"CAM-Pacman_Bottom_electronic\": pacmanMaterials.white,\n  \"CAM-Pacman_Top_electronic\": pacmanMaterials.white,\n  \"CAM-Pacman_Bottom_Text\": pacmanMaterials.white,\n  \"CAM-Pacman_Top_Text\": pacmanMaterials.white,\n  default: pacmanMaterials.blue,\n};\n\nexport const pillMaterialMap = {\n  shell: pillMaterials.shell,\n  default: pillMaterials.default,\n};\n","import * as THREE from \"three\";\nimport { ASSETS } from \"../config/config\";\nimport { GhostContainer } from \"../types/types\";\nimport { clock } from \"./scene\";\nimport {\n  mazeMaterial,\n  topMaterial,\n  ghostMaterial,\n  floorMaterial,\n  materialMap,\n  pillMaterialMap,\n} from \"./materials\";\n\nexport { clock };\n\nconst loader = new THREE.GLTFLoader();\n\nexport let pacmanMixer: THREE.AnimationMixer;\n\nexport const pacman = new THREE.Group();\n\nexport const ghosts: GhostContainer = {\n  pacman: pacman,\n  ghost1: new THREE.Mesh(new THREE.BufferGeometry(), ghostMaterial),\n  ghost2: new THREE.Mesh(new THREE.BufferGeometry(), ghostMaterial),\n  ghost3: new THREE.Mesh(new THREE.BufferGeometry(), ghostMaterial),\n  ghost4: new THREE.Mesh(new THREE.BufferGeometry(), ghostMaterial),\n  ghost5: new THREE.Mesh(new THREE.BufferGeometry(), ghostMaterial),\n};\n\nexport const pill = new THREE.Group();\npill.visible = true;\n\nconst ghostContainers = {\n  Ghost_EUR: ghosts.ghost1,\n  Ghost_CHF: ghosts.ghost2,\n  Ghost_YEN: ghosts.ghost3,\n  Ghost_USD: ghosts.ghost4,\n  Ghost_GBP: ghosts.ghost5,\n};\n\nexport async function loadModel(scene: THREE.Scene): Promise<void> {\n  Object.values(ghosts).forEach((ghost) => scene.add(ghost));\n  scene.add(pacman);\n  scene.add(pill);\n  return new Promise((resolve, reject) => {\n    loader.load(\n      ASSETS.mazeModel,\n      function (gltf) {\n        const model = gltf.scene;\n\n        const allObjectNames: string[] = [];\n        model.traverse((node: THREE.Object3D) => {\n          if (node.name) {\n            allObjectNames.push(node.name);\n          }\n        });\n        console.log(\"All objects in 3D file:\", allObjectNames);\n\n        model.traverse((child: THREE.Object3D) => {\n          if (child.name === \"CAM-Pacman\") {\n            const children: THREE.Object3D[] = [];\n            child.traverse((subChild: THREE.Object3D) => {\n              if (\n                (subChild as any).isMesh &&\n                subChild.name !== \"CAM-Pacman_Shell\" &&\n                subChild.name !== \"CAM-Pacman_Shell_Boolean\" &&\n                subChild.name !== \"CAM-Pacman_Bitcoin_1\" &&\n                subChild.name !== \"CAM-Pacman_Bitcoin_2\"\n              ) {\n                const material =\n                  materialMap[subChild.name as keyof typeof materialMap] ||\n                  materialMap.default;\n                (subChild as THREE.Mesh).material = material;\n                children.push(subChild);\n              } else if (\n                subChild.name === \"CAM-Pacman_Shell\" ||\n                subChild.name === \"CAM-Pacman_Shell_Boolean\" ||\n                subChild.name === \"CAM-Pacman_Bitcoin_1\" ||\n                subChild.name === \"CAM-Pacman_Bitcoin_2\"\n              ) {\n                subChild.visible = false;\n              }\n            });\n\n            children.forEach((item) => ghosts.pacman.add(item));\n            ghosts.pacman.scale.set(0.05, 0.05, 0.05);\n            ghosts.pacman.rotation.set(Math.PI / 2, Math.PI / 2, Math.PI / 4);\n\n            pacmanMixer = new THREE.AnimationMixer(ghosts.pacman);\n            const pacmanActions: { [key: string]: THREE.AnimationAction } = {};\n\n            gltf.animations.forEach((clip: THREE.AnimationClip) => {\n              const action = pacmanMixer.clipAction(clip);\n\n              action.getMixer().addEventListener(\"loop\", function (e) {\n                e.action.getRoot().traverse(function (obj) {\n                  if (obj.userData && obj.userData.skipAnimation) {\n                    (obj as any).updateMorphTargets = function () {};\n                  }\n                });\n              });\n\n              pacmanActions[clip.name] = action;\n              action.setEffectiveWeight(0);\n              action.play();\n            });\n            Object.values(pacmanActions).forEach((action) => {\n              action.setEffectiveWeight(1);\n            });\n          } else if (\n            child.name &&\n            ghostContainers[child.name as keyof typeof ghostContainers]\n          ) {\n            const ghostContainer =\n              ghostContainers[child.name as keyof typeof ghostContainers];\n            const ghostGroup = new THREE.Group();\n\n            child.rotation.z = Math.PI;\n            child.rotation.x = Math.PI / 2;\n            child.scale.set(0.75, 0.75, 0.75);\n\n            const children: THREE.Object3D[] = [];\n            child.traverse((subChild: THREE.Object3D) => {\n              if ((subChild as any).isMesh) {\n                if (subChild.name && subChild.name.startsWith(\"Ghost_Mesh\")) {\n                  (subChild as THREE.Mesh).material = ghostMaterial;\n                } else if (\n                  subChild.name &&\n                  [\"EUR\", \"CHF\", \"YEN\", \"USD\", \"GBP\"].includes(subChild.name)\n                ) {\n                  subChild.visible = false;\n                }\n                children.push(subChild);\n              }\n            });\n\n            children.forEach((item) => {\n              if (\n                item.name &&\n                (item.name.includes(\"EUR\") ||\n                  item.name.startsWith(\"Ghost_Mesh\"))\n              ) {\n                item.rotation.z = Math.PI;\n                item.rotation.x = Math.PI / 2;\n              } else {\n                item.rotation.set(0, 0, 0);\n              }\n              ghostGroup.add(item);\n            });\n\n            if (ghostContainer) {\n              ghostContainer.add(ghostGroup);\n            }\n          } else if (\n            child.name &&\n            !child.name.toLowerCase().includes(\"pacman\") &&\n            (child.name === \"CAM-Pill-Orange\" ||\n              (child.name.toLowerCase().includes(\"pill\") &&\n                child.name.toLowerCase().includes(\"orange\")))\n          ) {\n            console.log(\"Found pill object:\", child.name);\n            const pillGroup = new THREE.Group();\n            child.traverse((subChild: THREE.Object3D) => {\n              if ((subChild as any).isMesh) {\n                const mesh = subChild as THREE.Mesh;\n                const clonedMesh = mesh.clone();\n                const subChildName = subChild.name || \"\";\n                console.log(\"Pill subChild name:\", subChildName);\n                const isShell = subChildName.toLowerCase().includes(\"shell\");\n                const material = isShell\n                  ? pillMaterialMap.shell\n                  : pillMaterialMap.default;\n                clonedMesh.material = material;\n                clonedMesh.visible = true;\n                clonedMesh.castShadow = true;\n                clonedMesh.receiveShadow = true;\n                pillGroup.add(clonedMesh);\n              }\n            });\n            if (pillGroup.children.length > 0) {\n              pill.add(pillGroup);\n            }\n          }\n\n          if ((child as any).isMesh) {\n            if (child.name === \"CAM-Arena_LowRes_Top\") {\n              (child as THREE.Mesh).material = topMaterial;\n              child.castShadow = true;\n            } else if (child.name === \"CAM-Arena_LowRes_Bottom\") {\n              (child as THREE.Mesh).material = mazeMaterial;\n              child.castShadow = true;\n            } else if (child.name === \"CAM-Floor\") {\n              const clonedChild = child.clone();\n              child.position.y = -0.1;\n              child.position.x = 0;\n              child.position.z = 0;\n              (child as THREE.Mesh).material = new THREE.MeshBasicMaterial({\n                color: 0xffffff,\n                opacity: 1,\n                transparent: false,\n                depthWrite: true,\n                depthTest: true,\n                side: THREE.FrontSide,\n              });\n              child.receiveShadow = false;\n              child.castShadow = true;\n              child.scale.set(0.5, 0.5, 0.5);\n\n              (clonedChild as THREE.Mesh).material = floorMaterial;\n              clonedChild.position.y = -0.5;\n              clonedChild.receiveShadow = true;\n              scene.add(clonedChild);\n            } else {\n              (child as THREE.Mesh).visible = false;\n            }\n          }\n        });\n\n        model.traverse(function (node: THREE.Object3D) {\n          if ((node as any).isMesh) {\n            node.castShadow = true;\n            node.receiveShadow = true;\n          }\n        });\n\n        scene.add(model);\n        model.position.set(0.5, 0.5, 0.5);\n\n        if (pill.children.length > 0) {\n          pill.scale.set(0.05, 0.05, 0.05);\n          pill.visible = true;\n          pill.traverse((child) => {\n            if ((child as any).isMesh) {\n              (child as THREE.Mesh).visible = true;\n            }\n          });\n        }\n\n        resolve();\n      },\n      undefined,\n      function (error: any) {\n        reject(error);\n      }\n    );\n  });\n}\n","import * as THREE from \"three\";\nimport { MazePathPoint, PathPoint, CameraPathPoint } from \"../types/types\";\nimport {\n  homePaths,\n  povPaths,\n  createHomeScrollPathPoints,\n  getCameraHomeScrollPathPoints,\n} from \"./pathpoints\";\n\nconst pathCache = new Map<string, THREE.CurvePath<THREE.Vector3>>();\n\nexport class TangentSmoother {\n  private currentTangent: THREE.Vector3;\n  private smoothing: number;\n\n  constructor(initialTangent: THREE.Vector3, smoothing: number = 0.06) {\n    this.currentTangent = initialTangent.clone();\n    this.smoothing = smoothing;\n  }\n\n  update(targetTangent: THREE.Vector3): THREE.Vector3 {\n    this.currentTangent.lerp(targetTangent, this.smoothing);\n    return this.currentTangent.normalize();\n  }\n\n  reset(newTangent: THREE.Vector3): void {\n    this.currentTangent.copy(newTangent);\n  }\n\n  getCurrentTangent(): THREE.Vector3 {\n    return this.currentTangent.clone();\n  }\n\n  setSmoothingFactor(smoothing: number): void {\n    this.smoothing = Math.max(0.001, Math.min(1, smoothing));\n  }\n}\n\nfunction createMazePath(\n  pathPoints: MazePathPoint[]\n): THREE.CurvePath<THREE.Vector3> {\n  const cacheKey = pathPoints\n    .map((p) => `${p.pos.x},${p.pos.y},${p.pos.z},${p.type},${p.arc || \"\"}`)\n    .join(\"|\");\n\n  if (pathCache.has(cacheKey)) {\n    return pathCache.get(cacheKey)!;\n  }\n\n  const path = new THREE.CurvePath<THREE.Vector3>();\n\n  let i = 0;\n  while (i < pathPoints.length - 1) {\n    const current = pathPoints[i];\n    const next = pathPoints[i + 1];\n\n    if (current.curveCheckPoints?.length) {\n      const catmullPoints = [\n        current.pos,\n        ...current.curveCheckPoints,\n        next.pos,\n      ];\n      path.add(\n        new THREE.CatmullRomCurve3(catmullPoints, false, \"centripetal\", 0)\n      );\n    } else if (current.type === \"straight\") {\n      path.add(new THREE.LineCurve3(current.pos, next.pos));\n    } else {\n      const midPoint = createNormalCurveMidPoint(current, next);\n      path.add(\n        new THREE.QuadraticBezierCurve3(current.pos, midPoint, next.pos)\n      );\n    }\n\n    i++;\n  }\n\n  pathCache.set(cacheKey, path);\n  return path;\n}\n\nfunction createNormalCurveMidPoint(\n  current: MazePathPoint,\n  next: MazePathPoint\n): THREE.Vector3 {\n  if (current.arc) {\n    const curveType = current.arc;\n\n    if (curveType === \"upperArc\") {\n      return new THREE.Vector3(current.pos.x, current.pos.y, next.pos.z);\n    } else if (curveType === \"lowerArc\") {\n      return new THREE.Vector3(next.pos.x, current.pos.y, current.pos.z);\n    } else if (curveType === \"forwardDownArc\") {\n      return new THREE.Vector3(current.pos.x, next.pos.y, current.pos.z);\n    }\n  }\n\n  return new THREE.Vector3(current.pos.x, current.pos.y, next.pos.z);\n}\n\nfunction createHomeScrollPath(\n  pathPoints: PathPoint[]\n): THREE.CurvePath<THREE.Vector3> {\n  const path = new THREE.CurvePath<THREE.Vector3>();\n\n  if (pathPoints.length === 3) {\n    const curve = new THREE.QuadraticBezierCurve3(\n      pathPoints[0].pos,\n      pathPoints[1].pos,\n      pathPoints[2].pos\n    );\n    path.add(curve);\n  }\n\n  return path;\n}\n\nfunction createCameraHomeScrollPath(\n  pathPoints: CameraPathPoint[]\n): THREE.CurvePath<THREE.Vector3> {\n  const path = new THREE.CurvePath<THREE.Vector3>();\n\n  if (pathPoints.length === 4) {\n    const curve = new THREE.CubicBezierCurve3(\n      pathPoints[0].pos,\n      pathPoints[1].pos,\n      pathPoints[2].pos,\n      pathPoints[3].pos\n    );\n    path.add(curve);\n  }\n\n  return path;\n}\n\nexport function getHomePaths(): Record<string, THREE.CurvePath<THREE.Vector3>> {\n  const paths: Record<string, THREE.CurvePath<THREE.Vector3>> = {};\n\n  Object.entries(homePaths).forEach(([key, pathPoints]) => {\n    paths[key] = createMazePath(pathPoints);\n  });\n\n  return paths;\n}\n\nexport function getHomeScrollPaths(\n  pausedPositions: Record<string, THREE.Vector3>\n): Record<string, THREE.CurvePath<THREE.Vector3>> {\n  const scrollPathPoints = createHomeScrollPathPoints(pausedPositions);\n  const cameraPathPoints = getCameraHomeScrollPathPoints();\n\n  const paths: Record<string, THREE.CurvePath<THREE.Vector3>> = {\n    camera: createCameraHomeScrollPath(cameraPathPoints),\n  };\n\n  Object.entries(scrollPathPoints).forEach(([key, pathPoints]) => {\n    paths[key] = createHomeScrollPath(pathPoints);\n  });\n\n  return paths;\n}\n\nexport function getPovPaths(): Record<string, THREE.CurvePath<THREE.Vector3>> {\n  const paths: Record<string, THREE.CurvePath<THREE.Vector3>> = {};\n\n  Object.entries(povPaths).forEach(([key, pathPoints]) => {\n    paths[key] = createMazePath(pathPoints as MazePathPoint[]);\n  });\n\n  return paths;\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = gsap;","import * as THREE from \"three\";\n\nexport const OBJECT_KEYS = [\n  \"pacman\",\n  \"ghost1\",\n  \"ghost2\",\n  \"ghost3\",\n  \"ghost4\",\n  \"ghost5\",\n] as const;\n\nconst CURRENCY_SYMBOLS = [\"EUR\", \"CHF\", \"YEN\", \"USD\", \"GBP\"] as const;\n\nexport function isCurrencySymbol(name: string): boolean {\n  return CURRENCY_SYMBOLS.some(\n    (symbol) => name === symbol || name.includes(symbol)\n  );\n}\n\nexport function isPacmanPart(name: string): boolean {\n  return (\n    name.includes(\"Shell\") ||\n    name.includes(\"Bitcoin_1\") ||\n    name.includes(\"Bitcoin_2\")\n  );\n}\n\nexport function calculateObjectOrientation(\n  object: THREE.Object3D,\n  tangent: THREE.Vector3,\n  objectType: \"pacman\" | \"ghost\" | \"camera\" = \"ghost\"\n): void {\n  if (!tangent?.length()) return;\n\n  const targetRotation = Math.atan2(tangent.x, tangent.z);\n\n  if (objectType === \"pacman\") {\n    object.rotation.set(\n      -(Math.PI / 2),\n      Math.PI,\n      -(targetRotation + Math.PI / 2)\n    );\n  } else if (objectType === \"ghost\") {\n    object.rotation.set(0, targetRotation, 0);\n  } else if (objectType === \"camera\") {\n    const lookAtPoint = object.position.clone().add(tangent);\n    object.lookAt(lookAtPoint);\n  }\n}\n\nconst baseLayDownQuat = new THREE.Quaternion().setFromEuler(\n  new THREE.Euler(Math.PI / 2, 0, 0)\n);\nconst yAxis180 = new THREE.Quaternion().setFromAxisAngle(\n  new THREE.Vector3(0, 1, 0),\n  Math.PI\n);\nexport const LAY_DOWN_QUAT_1 = yAxis180.clone().multiply(baseLayDownQuat);\n\nexport const LAY_DOWN_QUAT_2 = new THREE.Quaternion().setFromEuler(\n  new THREE.Euler(-Math.PI / 2, 0, 0)\n);\n\nexport function slerpToLayDown(\n  object: THREE.Object3D,\n  startQuat: THREE.Quaternion,\n  progress: number\n) {\n  const d1 = startQuat.angleTo(LAY_DOWN_QUAT_1);\n  const d2 = startQuat.angleTo(LAY_DOWN_QUAT_2);\n  const targetQuat = d1 < d2 ? LAY_DOWN_QUAT_1 : LAY_DOWN_QUAT_2;\n\n  object.quaternion.copy(startQuat.clone().slerp(targetQuat, progress));\n}\n\nexport function rotateQuaternionAroundAxis(\n  quat: THREE.Quaternion,\n  axis: \"x\" | \"y\" | \"z\",\n  angle: number\n): THREE.Quaternion {\n  const axisVector =\n    axis === \"x\"\n      ? new THREE.Vector3(1, 0, 0)\n      : axis === \"y\"\n      ? new THREE.Vector3(0, 1, 0)\n      : new THREE.Vector3(0, 0, 1);\n\n  const rotation = new THREE.Quaternion().setFromAxisAngle(axisVector, angle);\n\n  return quat.clone().multiply(rotation);\n}\n\nexport function applyRotations(\n  quat: THREE.Quaternion,\n  rotations: Array<{ axis: \"x\" | \"y\" | \"z\"; angle: number }>\n): THREE.Quaternion {\n  let result = quat.clone();\n  rotations.forEach(({ axis, angle }) => {\n    result = rotateQuaternionAroundAxis(result, axis, angle);\n  });\n  return result;\n}\n","import * as THREE from \"three\";\nimport { isCurrencySymbol, isPacmanPart } from \"../animation/util\";\n\nexport function setObjectOpacity(\n  object: THREE.Object3D,\n  opacity: number,\n  options?: {\n    preserveTransmission?: boolean;\n    skipCurrencySymbols?: boolean;\n  }\n): void {\n  const preserveTransmission = options?.preserveTransmission !== false;\n\n  forEachMaterial(\n    object,\n    (mat: any) => {\n      setMaterialOpacity(mat, opacity, preserveTransmission);\n    },\n    {\n      skipCurrencySymbols: options?.skipCurrencySymbols === true,\n    }\n  );\n}\n\nexport function setMaterialOpacity(\n  material: THREE.Material,\n  opacity: number,\n  preserveTransmission: boolean = true\n): void {\n  const mat = material as any;\n  const currentOpacity = mat.opacity ?? 1;\n  const currentTransparent = mat.transparent ?? false;\n\n  if (Math.abs(currentOpacity - opacity) < 0.0001) {\n    return;\n  }\n\n  mat.opacity = opacity;\n\n  const shouldBeTransparent = preserveTransmission && mat.transmission !== undefined && mat.transmission > 0\n    ? true\n    : opacity < 1.0;\n\n  if (currentTransparent !== shouldBeTransparent) {\n    mat.transparent = shouldBeTransparent;\n    if (mat.needsUpdate !== undefined) {\n      mat.needsUpdate = true;\n    }\n  }\n}\n\nexport function setMaterialTransparent(\n  material: THREE.Material,\n  transparent: boolean,\n  preserveTransmission: boolean = true\n): void {\n  const mat = material as any;\n  const currentTransparent = mat.transparent ?? false;\n\n  const shouldBeTransparent = preserveTransmission && mat.transmission !== undefined && mat.transmission > 0\n    ? true\n    : transparent;\n\n  if (currentTransparent === shouldBeTransparent) {\n    return;\n  }\n\n  mat.transparent = shouldBeTransparent;\n\n  if (mat.needsUpdate !== undefined) {\n    mat.needsUpdate = true;\n  }\n}\n\nexport function getObjectOpacity(object: THREE.Object3D): number {\n  let opacity = 1.0;\n  let found = false;\n\n  forEachMaterial(\n    object,\n    (mat: any) => {\n      if (!found) {\n        opacity = mat.opacity ?? 1.0;\n        found = true;\n      }\n    },\n    { skipCurrencySymbols: false }\n  );\n\n  return opacity;\n}\n\nexport function resetGhostMaterialsToFullOpacity(object: THREE.Object3D): void {\n  setObjectOpacity(object, 1.0, {\n    preserveTransmission: true,\n    skipCurrencySymbols: true,\n  });\n}\n\n\nexport function forEachMaterial(\n  object: THREE.Object3D,\n  callback: (material: THREE.Material, mesh: THREE.Mesh, childName: string) => void,\n  options?: {\n    skipCurrencySymbols?: boolean;\n    skipPacmanParts?: boolean;\n    objectKey?: string;\n  }\n): void {\n  const skipCurrencySymbols = options?.skipCurrencySymbols === true;\n  const skipPacmanParts = options?.skipPacmanParts === true;\n  const objectKey = options?.objectKey;\n\n  object.traverse((child) => {\n    if ((child as any).isMesh && (child as any).material) {\n      const mesh = child as THREE.Mesh;\n      const childName = child.name || \"\";\n\n      if (skipCurrencySymbols && isCurrencySymbol(childName)) {\n        return;\n      }\n\n      if (skipPacmanParts && objectKey === \"pacman\" && isPacmanPart(childName)) {\n        return;\n      }\n\n      if (Array.isArray(mesh.material)) {\n        mesh.material.forEach((mat: any) => {\n          callback(mat, mesh, childName);\n        });\n      } else {\n        callback(mesh.material as any, mesh, childName);\n      }\n    }\n  });\n}\n","import gsap from \"gsap\";\nimport * as THREE from \"three\";\nimport { scene } from \"../core/scene\";\nimport { SCALE, OPACITY } from \"./constants\";\nimport { forEachMaterial } from \"../core/material-utils\";\n\nexport function setFloorPlane(\n  visible: boolean,\n  opacity: number = OPACITY.FULL,\n  transparent: boolean = false\n): void {\n  scene.traverse((child) => {\n    if (child.name === \"CAM-Floor\") {\n      child.visible = visible;\n      if (child instanceof THREE.Mesh && child.material) {\n        const material = child.material as THREE.MeshBasicMaterial;\n        material.color.setHex(0xffffff);\n        material.opacity = opacity;\n        material.transparent = transparent;\n      }\n    }\n  });\n}\n\nexport function setObjectScale(\n  object: THREE.Object3D,\n  key: string,\n  sceneType: \"home\" | \"intro\" | \"pov\" | \"outro\"\n): void {\n  let scale: number;\n\n  if (key === \"pacman\") {\n    scale = sceneType === \"intro\" ? SCALE.PACMAN_INTRO : SCALE.PACMAN_HOME;\n  } else {\n    if (sceneType === \"intro\") {\n      scale = SCALE.GHOST_INTRO;\n    } else if (sceneType === \"pov\") {\n      scale = SCALE.GHOST_POV;\n    } else {\n      scale = SCALE.GHOST_NORMAL;\n    }\n  }\n\n  object.scale.set(scale, scale, scale);\n  object.updateMatrixWorld(true);\n  gsap.set(object.scale, { x: scale, y: scale, z: scale });\n}\n\nexport function killObjectAnimations(object: THREE.Object3D): void {\n  gsap.killTweensOf(object);\n  gsap.killTweensOf(object.scale);\n  gsap.killTweensOf(object.position);\n  gsap.killTweensOf(object.rotation);\n  gsap.killTweensOf(object.quaternion);\n\n  forEachMaterial(\n    object,\n    (mat: any) => {\n      gsap.killTweensOf(mat);\n      gsap.killTweensOf(mat.opacity);\n    },\n    { skipCurrencySymbols: false }\n  );\n}\n","import gsap from \"gsap\";\nimport * as THREE from \"three\";\nimport { camera } from \"../core/camera\";\nimport { ghosts } from \"../core/objects\";\nimport {\n  slerpToLayDown,\n  applyRotations,\n  OBJECT_KEYS,\n  isCurrencySymbol,\n  isPacmanPart,\n} from \"./util\";\nimport {\n  setMaterialOpacity,\n  setMaterialTransparent,\n  resetGhostMaterialsToFullOpacity,\n  forEachMaterial,\n} from \"../core/material-utils\";\nimport {\n  setFloorPlane,\n  setObjectScale,\n  killObjectAnimations,\n} from \"./scene-utils\";\nimport { SCALE, OPACITY, INTRO_POSITION_OFFSET } from \"./constants\";\n\nexport function applyHomeLoopPreset(\n  isEntering: boolean,\n  scrollDirection?: \"up\" | \"down\"\n) {\n  if (!isEntering) return;\n\n  Object.entries(ghosts).forEach(([key, object]) => {\n    gsap.set(object, { visible: true });\n    setObjectScale(object, key, \"home\");\n\n    forEachMaterial(\n      object,\n      (mat: any, mesh: THREE.Mesh, childName: string) => {\n        if (isCurrencySymbol(childName)) {\n          mesh.visible = false;\n          return;\n        }\n        mesh.visible = true;\n      },\n      { skipCurrencySymbols: false }\n    );\n\n    resetGhostMaterialsToFullOpacity(object);\n  });\n\n  setFloorPlane(true, OPACITY.FULL, false);\n}\n\nexport function applyHomeScrollPreset(\n  isEntering: boolean,\n  scrollDirection?: \"up\" | \"down\",\n  pausedPositions?: Record<string, THREE.Vector3>,\n  pausedRotations?: Record<string, THREE.Quaternion>\n) {\n  if (!isEntering) return;\n\n  if (pausedPositions && pausedRotations) {\n    Object.entries(ghosts).forEach(([key, object]) => {\n      if (pausedPositions[key]) {\n        object.position.set(\n          pausedPositions[key].x,\n          pausedPositions[key].y,\n          pausedPositions[key].z\n        );\n        gsap.set(object.position, {\n          x: pausedPositions[key].x,\n          y: pausedPositions[key].y,\n          z: pausedPositions[key].z,\n        });\n      }\n\n      gsap.set(object, { visible: true });\n\n      setObjectScale(object, key, \"home\");\n\n      forEachMaterial(\n        object,\n        (mat: any, mesh: THREE.Mesh, childName: string) => {\n          if (isCurrencySymbol(childName)) {\n            mesh.visible = false;\n            return;\n          }\n\n          mesh.visible = true;\n\n          setMaterialTransparent(mat, true, true);\n        },\n        { skipCurrencySymbols: false }\n      );\n    });\n  }\n\n  setFloorPlane(true, OPACITY.FULL, false);\n}\n\nexport { INTRO_POSITION_OFFSET };\n\nlet pacmanTargetQuaternion: THREE.Quaternion | null = null;\nlet ghostTargetQuaternion: THREE.Quaternion | null = null;\nlet introInitialRotations: Record<string, THREE.Quaternion> = {};\n\nexport function applyIntroScrollPreset(\n  isEntering: boolean,\n  scrollDirection?: \"up\" | \"down\"\n) {\n  if (!isEntering) return;\n\n  if (!pacmanTargetQuaternion || !ghostTargetQuaternion) {\n    const pacmanObj = ghosts.pacman;\n    if (pacmanObj) {\n      if (!introInitialRotations[\"pacman\"]) {\n        introInitialRotations[\"pacman\"] = pacmanObj.quaternion.clone();\n      }\n\n      let quat = introInitialRotations[\"pacman\"].clone();\n      slerpToLayDown(pacmanObj, quat, OPACITY.FULL);\n      quat = pacmanObj.quaternion.clone();\n\n      quat = applyRotations(quat, [\n        { axis: \"x\", angle: Math.PI / 2 },\n        { axis: \"y\", angle: Math.PI },\n        { axis: \"y\", angle: Math.PI },\n        { axis: \"x\", angle: Math.PI },\n        { axis: \"x\", angle: Math.PI },\n        { axis: \"y\", angle: Math.PI },\n      ]);\n\n      pacmanTargetQuaternion = quat;\n      pacmanObj.quaternion.copy(introInitialRotations[\"pacman\"]);\n    }\n\n    const ghostObj = ghosts.ghost1;\n    if (ghostObj) {\n      if (!introInitialRotations[\"ghost1\"]) {\n        introInitialRotations[\"ghost1\"] = ghostObj.quaternion.clone();\n      }\n\n      let quat = introInitialRotations[\"ghost1\"].clone();\n      slerpToLayDown(ghostObj, quat, OPACITY.FULL);\n      quat = ghostObj.quaternion.clone();\n\n      quat = applyRotations(quat, [\n        { axis: \"x\", angle: Math.PI },\n        { axis: \"x\", angle: Math.PI },\n        { axis: \"y\", angle: Math.PI },\n        { axis: \"y\", angle: Math.PI },\n        { axis: \"x\", angle: Math.PI },\n        { axis: \"x\", angle: Math.PI },\n      ]);\n\n      ghostTargetQuaternion = quat;\n      ghostObj.quaternion.copy(introInitialRotations[\"ghost1\"]);\n    }\n\n    OBJECT_KEYS.forEach((key) => {\n      const obj = ghosts[key];\n      if (obj && !introInitialRotations[key]) {\n        introInitialRotations[key] = obj.quaternion.clone();\n      }\n    });\n  }\n}\n\nexport function applyPovScrollPreset(\n  isEntering: boolean,\n  scrollDirection?: \"up\" | \"down\"\n) {\n  if (!isEntering) return;\n\n  if (ghosts.pacman) {\n    gsap.set(ghosts.pacman, { visible: false });\n  }\n\n  Object.entries(ghosts).forEach(([key, object]) => {\n    if (key !== \"pacman\") {\n      gsap.set(object, { visible: false });\n      setObjectScale(object, key, \"pov\");\n\n      forEachMaterial(\n        object,\n        (mat: any) => {\n          setMaterialOpacity(mat, 1, true);\n        },\n        { skipCurrencySymbols: false }\n      );\n    }\n  });\n\n  setFloorPlane(true, OPACITY.FULL, false);\n}\n\nexport function applyOutroScrollPreset(\n  isEntering: boolean,\n  scrollDirection?: \"up\" | \"down\"\n) {\n  if (!isEntering) return;\n\n  setFloorPlane(true, OPACITY.FULL, false);\n}\n\nlet lastScrollY = window.scrollY;\nexport function getScrollDirection(): \"up\" | \"down\" {\n  const currentScrollY = window.scrollY;\n  const direction = currentScrollY > lastScrollY ? \"down\" : \"up\";\n  lastScrollY = currentScrollY;\n  return direction;\n}\n","import * as THREE from \"three\";\nimport { ghosts } from \"../core/objects\";\nimport {\n  setObjectOpacity,\n  forEachMaterial,\n  getObjectOpacity,\n} from \"../core/material-utils\";\n\nexport interface ObjectState {\n  position: THREE.Vector3;\n  rotation: THREE.Quaternion;\n  scale: THREE.Vector3;\n  visible: boolean;\n  opacity: number;\n}\n\nexport interface HomeLoopState {\n  t: number;\n  animationTime: number;\n}\n\nexport const homeLoopState: HomeLoopState = {\n  t: 0,\n  animationTime: 0,\n};\n\nexport const currentObjectStates: Record<string, ObjectState> = {};\n\nexport let homeLoopStartPositions: Record<string, THREE.Vector3> = {};\nexport let homeLoopStartRotations: Record<string, THREE.Quaternion> = {};\nexport let homeLoopStartT: number | null = null;\n\nlet isHomeLoopActive = false;\n\nexport function setHomeLoopActive(active: boolean) {\n  isHomeLoopActive = active;\n}\n\nexport function getIsHomeLoopActive(): boolean {\n  return isHomeLoopActive;\n}\n\nexport function updateHomeLoopT(t: number, animationTime: number) {\n  homeLoopState.t = t;\n  homeLoopState.animationTime = animationTime;\n}\n\nexport function initializeObjectStates() {\n  Object.entries(ghosts).forEach(([key, object]) => {\n    const initialOpacity = getObjectOpacity(object);\n\n    currentObjectStates[key] = {\n      position: object.position.clone(),\n      rotation: object.quaternion.clone(),\n      scale: object.scale.clone(),\n      visible: object.visible,\n      opacity: initialOpacity,\n    };\n  });\n}\n\nexport function getCurrentPositions(): Record<string, THREE.Vector3> {\n  const positions: Record<string, THREE.Vector3> = {};\n  Object.entries(currentObjectStates).forEach(([key, state]) => {\n    positions[key] = state.position.clone();\n  });\n  return positions;\n}\n\nexport function getCurrentRotations(): Record<string, THREE.Quaternion> {\n  const rotations: Record<string, THREE.Quaternion> = {};\n  Object.entries(currentObjectStates).forEach(([key, state]) => {\n    rotations[key] = state.rotation.clone();\n  });\n  return rotations;\n}\n\nexport function updateObjectPosition(\n  key: string,\n  position: THREE.Vector3,\n  force: boolean = false,\n  preserveHomeLoopStart: boolean = false\n) {\n  if (!isHomeLoopActive && !force) {\n    return;\n  }\n\n  if (currentObjectStates[key]) {\n    currentObjectStates[key].position.copy(position);\n  }\n\n  if (preserveHomeLoopStart) {\n    homeLoopStartPositions[key] = position.clone();\n  }\n}\n\nexport function getHomeLoopStartPositions(): Record<string, THREE.Vector3> {\n  return { ...homeLoopStartPositions };\n}\n\nexport function updateObjectRotation(\n  key: string,\n  rotation: THREE.Quaternion,\n  preserveHomeLoopStart: boolean = false\n) {\n  if (currentObjectStates[key]) {\n    currentObjectStates[key].rotation.copy(rotation);\n  }\n\n  if (preserveHomeLoopStart) {\n    homeLoopStartRotations[key] = rotation.clone();\n  }\n}\n\nexport function getHomeLoopStartRotations(): Record<string, THREE.Quaternion> {\n  return Object.entries(homeLoopStartRotations).reduce((acc, [key, rot]) => {\n    acc[key] = rot.clone();\n    return acc;\n  }, {} as Record<string, THREE.Quaternion>);\n}\n\nexport function setHomeLoopStartT(t: number): void {\n  homeLoopStartT = t;\n}\n\nexport function getHomeLoopStartT(): number | null {\n  return homeLoopStartT;\n}\n","import gsap from \"gsap\";\nimport ScrollTrigger from \"gsap/ScrollTrigger\";\nimport * as THREE from \"three\";\nimport { camera } from \"../core/camera\";\nimport { ghosts } from \"../core/objects\";\nimport { getCameraHomeScrollPathPoints } from \"../paths/pathpoints\";\nimport { getHomeScrollPaths } from \"../paths/paths\";\nimport { LAY_DOWN_QUAT_1 } from \"./util\";\nimport { applyHomeScrollPreset, getScrollDirection } from \"./scene-presets\";\nimport {\n  getCurrentRotations,\n  getCurrentPositions,\n  getHomeLoopStartPositions,\n  getHomeLoopStartRotations,\n} from \"./object-state\";\nimport {\n  setObjectOpacity,\n  getObjectOpacity,\n  forEachMaterial,\n  setMaterialOpacity,\n} from \"../core/material-utils\";\nimport { killObjectAnimations } from \"./scene-utils\";\nimport {\n  SCROLL_SELECTORS,\n  SCRUB_DURATION,\n  STAGGER_AMOUNT,\n  OPACITY,\n} from \"./constants\";\n\nlet homeScrollTimeline: gsap.core.Timeline | null = null;\nconst originalFOV = 50;\n\nlet startPositions: Record<string, THREE.Vector3> = {};\n\nexport function initHomeScrollAnimation() {\n  if (homeScrollTimeline) {\n    homeScrollTimeline.kill();\n    homeScrollTimeline = null;\n  }\n\n  const cameraPathPoints = getCameraHomeScrollPathPoints();\n\n  const cameraPath = new THREE.CurvePath<THREE.Vector3>();\n  if (cameraPathPoints.length === 4) {\n    const cameraCurve = new THREE.CubicBezierCurve3(\n      cameraPathPoints[0].pos,\n      cameraPathPoints[1].pos,\n      cameraPathPoints[2].pos,\n      cameraPathPoints[3].pos\n    );\n    cameraPath.add(cameraCurve);\n  }\n\n  const handleScrollEnter = () => {\n    requestAnimationFrame(() => {\n      const introScrollTrigger = ScrollTrigger.getById(\"introScroll\");\n      if (introScrollTrigger?.isActive) {\n        return;\n      }\n\n      const homeLoopStartPos = getHomeLoopStartPositions();\n      const homeLoopStartRot = getHomeLoopStartRotations();\n      const scrollDir = getScrollDirection();\n\n      Object.entries(ghosts).forEach(([key, object]) => {\n        if (homeLoopStartPos[key]) {\n          object.position.copy(homeLoopStartPos[key]);\n          startPositions[key] = homeLoopStartPos[key].clone();\n        } else {\n          const currentPositions = getCurrentPositions();\n          const position = currentPositions[key] || object.position;\n          object.position.copy(position);\n          startPositions[key] = position.clone();\n        }\n\n        if (homeLoopStartRot[key]) {\n          object.quaternion.copy(homeLoopStartRot[key]);\n        }\n      });\n\n      const rotationsToUse =\n        Object.keys(homeLoopStartRot).length > 0\n          ? homeLoopStartRot\n          : getCurrentRotations();\n\n      applyHomeScrollPreset(true, scrollDir, startPositions, rotationsToUse);\n\n      createObjectAnimations();\n    });\n  };\n\n  homeScrollTimeline = gsap.timeline({\n    scrollTrigger: {\n      id: \"homeScroll\",\n      trigger: SCROLL_SELECTORS.HOME,\n      start: \"top top\",\n      end: \"bottom top\",\n      scrub: SCRUB_DURATION,\n      markers: false,\n      refreshPriority: 0,\n      invalidateOnRefresh: false,\n      onEnter: handleScrollEnter,\n      onEnterBack: handleScrollEnter,\n      onUpdate: (self) => {\n        if (cameraPath && cameraPath.curves.length) {\n          const progress = self.progress;\n          const clampedProgress = Math.min(1, Math.max(0, progress));\n          const cameraPoint = cameraPath.getPointAt(clampedProgress);\n          camera.position.copy(cameraPoint);\n\n          const lookAtPoints: THREE.Vector3[] = [];\n          cameraPathPoints.forEach((point) => {\n            if (\"lookAt\" in point && point.lookAt) {\n              lookAtPoints.push(point.lookAt);\n            }\n          });\n\n          if (lookAtPoints.length >= 4) {\n            const lookAtCurve = new THREE.CubicBezierCurve3(\n              lookAtPoints[0],\n              lookAtPoints[1],\n              lookAtPoints[2],\n              lookAtPoints[3]\n            );\n            const lookAtPoint = lookAtCurve.getPoint(clampedProgress);\n            camera.lookAt(lookAtPoint);\n          }\n          camera.fov = originalFOV;\n          camera.updateProjectionMatrix();\n        }\n      },\n      onLeave: () => {\n        const introScrollTrigger = ScrollTrigger.getById(\"introScroll\");\n        if (!introScrollTrigger?.isActive) {\n          homeScrollTimeline?.resume();\n        }\n      },\n      onLeaveBack: () => {\n        const introScrollTrigger = ScrollTrigger.getById(\"introScroll\");\n        if (!introScrollTrigger?.isActive) {\n          homeScrollTimeline?.resume();\n        }\n      },\n    },\n  });\n\n  const allObjects = Object.entries(ghosts);\n  allObjects.forEach(([key, object]) => {\n    startPositions[key] = object.position.clone();\n  });\n\n  const createObjectAnimations = () => {\n    if (homeScrollTimeline) {\n      homeScrollTimeline.clear();\n    }\n\n    allObjects.forEach(([key, object]) => {\n      killObjectAnimations(object);\n    });\n\n    const homeScrollPaths = getHomeScrollPaths(startPositions);\n\n    const animPropsArray: any[] = [];\n    const animationData: Array<{\n      key: string;\n      object: THREE.Object3D;\n      path: THREE.CurvePath<THREE.Vector3>;\n      startEuler: THREE.Euler;\n      endEuler: THREE.Euler;\n    }> = [];\n\n    allObjects.forEach(([key, object]) => {\n      const currentMaterialOpacity = getObjectOpacity(object);\n\n      forEachMaterial(\n        object,\n        (mat: any, mesh: THREE.Mesh) => {\n          const clonedMat = mat.clone();\n          setMaterialOpacity(clonedMat, currentMaterialOpacity, true);\n\n          if (Array.isArray(mesh.material)) {\n            const index = mesh.material.indexOf(mat);\n            if (index !== -1) {\n              const clonedMaterials = [...mesh.material];\n              clonedMaterials[index] = clonedMat;\n              mesh.material = clonedMaterials;\n            }\n          } else {\n            mesh.material = clonedMat;\n          }\n        },\n        { skipCurrencySymbols: false }\n      );\n\n      const homeLoopStartRot = getHomeLoopStartRotations();\n      const startRot =\n        homeLoopStartRot[key] ||\n        getCurrentRotations()[key] ||\n        object.quaternion.clone();\n      const startEuler = new THREE.Euler().setFromQuaternion(startRot);\n      const endEuler = new THREE.Euler().setFromQuaternion(LAY_DOWN_QUAT_1);\n\n      const path = homeScrollPaths[key];\n      if (!path) {\n        return;\n      }\n\n      const animProps = {\n        progress: 0,\n        rotX: startEuler.x,\n        rotY: startEuler.y,\n        rotZ: startEuler.z,\n        opacity: currentMaterialOpacity,\n      };\n\n      animPropsArray.push(animProps);\n      animationData.push({\n        key,\n        object,\n        path,\n        startEuler,\n        endEuler,\n      });\n    });\n\n    const baseEndTime = 1;\n\n    animationData.forEach((data, index) => {\n      const animProps = animPropsArray[index];\n      const endTime = baseEndTime + index * STAGGER_AMOUNT;\n      const duration = endTime;\n\n      const startPathPoint = data.path.getPointAt(0);\n      data.object.position.copy(startPathPoint);\n\n      homeScrollTimeline!.fromTo(\n        animProps,\n        {\n          progress: 0,\n          rotX: data.startEuler.x,\n          rotY: data.startEuler.y,\n          rotZ: data.startEuler.z,\n          opacity: animProps.opacity,\n        },\n        {\n          progress: 1,\n          rotX: data.endEuler.x,\n          rotY: data.endEuler.y,\n          rotZ: data.endEuler.z,\n          opacity: OPACITY.HIDDEN,\n          ease: \"power2.out\",\n          immediateRender: false,\n          duration: duration,\n          onUpdate: function () {\n            const introScrollTrigger = ScrollTrigger.getById(\"introScroll\");\n            if (introScrollTrigger?.isActive) {\n              return;\n            }\n\n            const pathPoint = data.path.getPointAt(animProps.progress);\n            data.object.position.copy(pathPoint);\n\n            data.object.rotation.set(\n              animProps.rotX,\n              animProps.rotY,\n              animProps.rotZ\n            );\n            data.object.quaternion.setFromEuler(data.object.rotation);\n\n            setObjectOpacity(data.object, animProps.opacity, {\n              preserveTransmission: true,\n              skipCurrencySymbols: true,\n            });\n          },\n        },\n        0\n      );\n    });\n  };\n\n  createObjectAnimations();\n}\n","import * as THREE from \"three\";\nimport ScrollTrigger from \"gsap/ScrollTrigger\";\nimport { ghosts, pacmanMixer, pill } from \"../core/objects\";\nimport { clock, onFrame, scene } from \"../core/scene\";\nimport { getHomePaths, TangentSmoother } from \"../paths/paths\";\nimport { initHomeScrollAnimation } from \"./home-scroll\";\nimport { calculateObjectOrientation, OBJECT_KEYS } from \"./util\";\nimport { applyHomeLoopPreset } from \"./scene-presets\";\nimport {\n  SCALE,\n  TANGENT_SMOOTHING,\n  ROTATION_TRANSITION_DURATION,\n} from \"./constants\";\nimport { setObjectScale } from \"./scene-utils\";\nimport {\n  updateObjectPosition,\n  updateObjectRotation,\n  setHomeLoopActive,\n  updateHomeLoopT,\n  getHomeLoopStartRotations,\n  setHomeLoopStartT,\n  getHomeLoopStartT,\n} from \"./object-state\";\nimport { isCurrencySymbol } from \"./util\";\n\nconst LOOP_DURATION = 50;\nlet isHomeLoopActive = true;\nlet animationTime = 0;\nlet homeLoopFrameRegistered = false;\nlet rotationTransitionTime = 0;\nlet startRotations: Record<string, THREE.Quaternion> = {};\nlet hasBeenPausedBefore = false;\n\nconst homeLoopTangentSmoothers: Record<string, TangentSmoother> = {};\nlet pillGuides: THREE.Group | null = null;\n\nfunction createPillPositionGuides(pillPos: THREE.Vector3) {\n  // Remove existing guides if they exist\n  if (pillGuides) {\n    scene.remove(pillGuides);\n    pillGuides = null;\n  }\n\n  pillGuides = new THREE.Group();\n  pillGuides.name = \"pillPositionGuides\";\n\n  const guideSize = 1.0; // Much larger for visibility\n\n  // Create axes helper (larger)\n  const axesHelper = new THREE.AxesHelper(guideSize);\n  axesHelper.position.copy(pillPos);\n  pillGuides.add(axesHelper);\n\n  // Create a large visible sphere at pill position\n  const sphereGeometry = new THREE.SphereGeometry(0.2, 16, 16);\n  const sphereMaterial = new THREE.MeshBasicMaterial({\n    color: 0xff0000,\n    transparent: true,\n    opacity: 0.7,\n    wireframe: true,\n  });\n  const sphere = new THREE.Mesh(sphereGeometry, sphereMaterial);\n  sphere.position.copy(pillPos);\n  pillGuides.add(sphere);\n\n  // Create a wireframe box to show the area (larger)\n  const boxGeometry = new THREE.BoxGeometry(guideSize, guideSize, guideSize);\n  const boxMaterial = new THREE.LineBasicMaterial({\n    color: 0x00ff00,\n    linewidth: 2,\n  });\n  const boxEdges = new THREE.EdgesGeometry(boxGeometry);\n  const boxWireframe = new THREE.LineSegments(boxEdges, boxMaterial);\n  boxWireframe.position.copy(pillPos);\n  pillGuides.add(boxWireframe);\n\n  // Create bright lines from origin to pill position\n  const lineMaterial = new THREE.LineBasicMaterial({\n    color: 0xffff00,\n    linewidth: 3,\n  });\n\n  // X-axis line (red)\n  const xLineGeometry = new THREE.BufferGeometry().setFromPoints([\n    new THREE.Vector3(0, pillPos.y, pillPos.z),\n    pillPos,\n  ]);\n  const xLine = new THREE.Line(\n    xLineGeometry,\n    new THREE.LineBasicMaterial({ color: 0xff0000, linewidth: 2 })\n  );\n  pillGuides.add(xLine);\n\n  // Y-axis line (green)\n  const yLineGeometry = new THREE.BufferGeometry().setFromPoints([\n    new THREE.Vector3(pillPos.x, 0, pillPos.z),\n    pillPos,\n  ]);\n  const yLine = new THREE.Line(\n    yLineGeometry,\n    new THREE.LineBasicMaterial({ color: 0x00ff00, linewidth: 2 })\n  );\n  pillGuides.add(yLine);\n\n  // Z-axis line (blue)\n  const zLineGeometry = new THREE.BufferGeometry().setFromPoints([\n    new THREE.Vector3(pillPos.x, pillPos.y, 0),\n    pillPos,\n  ]);\n  const zLine = new THREE.Line(\n    zLineGeometry,\n    new THREE.LineBasicMaterial({ color: 0x0000ff, linewidth: 2 })\n  );\n  pillGuides.add(zLine);\n\n  console.log(\"Pill guides created at position:\", pillPos);\n  scene.add(pillGuides);\n  console.log(\"Pill guides added to scene\");\n}\n\nfunction removePillPositionGuides() {\n  if (pillGuides) {\n    scene.remove(pillGuides);\n    pillGuides = null;\n  }\n}\n\nfunction initializeHomeLoopTangentSmoothers() {\n  const smoothingFactor = TANGENT_SMOOTHING.HOME_LOOP;\n  const initialVector = new THREE.Vector3(1, 0, 0);\n\n  OBJECT_KEYS.forEach((key) => {\n    homeLoopTangentSmoothers[key] = new TangentSmoother(\n      initialVector.clone(),\n      smoothingFactor\n    );\n  });\n}\n\nfunction stopHomeLoop() {\n  if (!isHomeLoopActive) return;\n  isHomeLoopActive = false;\n  setHomeLoopActive(false);\n  hasBeenPausedBefore = true;\n\n  const exactT = (animationTime % LOOP_DURATION) / LOOP_DURATION;\n  setHomeLoopStartT(exactT);\n\n  Object.entries(ghosts).forEach(([key, ghost]) => {\n    updateObjectPosition(key, ghost.position.clone(), true, true);\n    updateObjectRotation(key, ghost.quaternion.clone(), true);\n  });\n\n  removePillPositionGuides();\n  initHomeScrollAnimation();\n}\n\nexport function startHomeLoop() {\n  isHomeLoopActive = true;\n  setHomeLoopActive(true);\n\n  const homePaths = getHomePaths();\n  const homeLoopStartRot = getHomeLoopStartRotations();\n  const savedT = getHomeLoopStartT();\n\n  if (hasBeenPausedBefore && savedT !== null) {\n    animationTime = savedT * LOOP_DURATION;\n  }\n\n  rotationTransitionTime = 0;\n  startRotations = {};\n\n  applyHomeLoopPreset(true);\n\n  initializeHomeLoopTangentSmoothers();\n\n  Object.entries(ghosts).forEach(([key, ghost]) => {\n    const path = homePaths[key];\n    if (path) {\n      if (hasBeenPausedBefore && savedT !== null) {\n        const position = path.getPointAt(savedT);\n        if (position) {\n          ghost.position.copy(position);\n          updateObjectPosition(key, position);\n        }\n      }\n\n      const savedRotation = homeLoopStartRot[key];\n\n      if (savedRotation) {\n        ghost.quaternion.copy(savedRotation);\n        updateObjectRotation(key, savedRotation);\n        if (hasBeenPausedBefore) {\n          startRotations[key] = savedRotation.clone();\n        }\n      } else {\n        updateObjectRotation(key, ghost.quaternion);\n        if (hasBeenPausedBefore) {\n          startRotations[key] = ghost.quaternion.clone();\n        }\n      }\n\n      if (key !== \"pacman\") {\n        ghost.visible = true;\n      }\n      setObjectScale(ghost, key, \"home\");\n\n      if (homeLoopTangentSmoothers[key] && savedT !== null) {\n        const initialTangent = path.getTangentAt(savedT);\n        if (initialTangent) {\n          homeLoopTangentSmoothers[key].reset(initialTangent);\n        }\n      }\n    }\n  });\n\n  // Position and show pill at maze center\n  const pillPos = new THREE.Vector3(0.5, 0.5, 0.5);\n  pill.position.copy(pillPos);\n  pill.scale.set(10, 10, 10); // Very large scale for visibility\n  pill.visible = true;\n\n  console.log(\"Pill children count:\", pill.children.length);\n  pill.traverse((child) => {\n    if ((child as any).isMesh) {\n      (child as THREE.Mesh).visible = true;\n      console.log(\n        \"Pill mesh found:\",\n        child.name,\n        \"visible:\",\n        (child as THREE.Mesh).visible\n      );\n    }\n  });\n\n  // Add visual guides to show pill position\n  createPillPositionGuides(pillPos);\n\n  if (!homeLoopFrameRegistered) {\n    let lastTime = clock.getElapsedTime();\n    onFrame(() => {\n      if (document.hidden) {\n        lastTime = clock.getElapsedTime();\n        return;\n      }\n\n      const currentTime = clock.getElapsedTime();\n      const delta = currentTime - lastTime;\n      lastTime = currentTime;\n\n      updateHomeLoop(delta);\n    });\n    homeLoopFrameRegistered = true;\n  }\n}\n\nfunction updateHomeLoop(delta: number) {\n  if (!isHomeLoopActive) return;\n\n  const introScrollTrigger = ScrollTrigger.getById(\"introScroll\");\n  if (introScrollTrigger?.isActive) return;\n\n  const maxDelta = 0.1;\n  const clampedDelta = Math.min(delta, maxDelta);\n\n  animationTime += clampedDelta;\n  rotationTransitionTime += clampedDelta;\n\n  const t = (animationTime % LOOP_DURATION) / LOOP_DURATION;\n\n  updateHomeLoopT(t, animationTime);\n\n  const homePaths = getHomePaths();\n  if (pacmanMixer) {\n    pacmanMixer.update(delta);\n  }\n\n  const transitionProgress = Math.min(\n    rotationTransitionTime / ROTATION_TRANSITION_DURATION,\n    1\n  );\n  const isTransitioning = hasBeenPausedBefore && transitionProgress < 1;\n\n  Object.entries(ghosts).forEach(([key, ghost]) => {\n    const path = homePaths[key];\n    if (path) {\n      const objectT = t;\n\n      const position = path.getPointAt(objectT);\n      if (position) {\n        ghost.position.copy(position);\n        updateObjectPosition(key, position);\n      }\n\n      setObjectScale(ghost, key, \"home\");\n\n      const targetQuat = new THREE.Quaternion();\n      if (homeLoopTangentSmoothers[key] && objectT > 0) {\n        const rawTangent = path.getTangentAt(objectT);\n        if (rawTangent && rawTangent.length() > 0) {\n          const smoothTangent =\n            homeLoopTangentSmoothers[key].update(rawTangent);\n          const objectType = key === \"pacman\" ? \"pacman\" : \"ghost\";\n\n          const tempObject = new THREE.Object3D();\n          calculateObjectOrientation(tempObject, smoothTangent, objectType);\n          targetQuat.copy(tempObject.quaternion);\n        }\n      }\n\n      if (isTransitioning && startRotations[key]) {\n        const easedProgress =\n          transitionProgress *\n          transitionProgress *\n          (3 - 2 * transitionProgress);\n        ghost.quaternion.copy(\n          startRotations[key].clone().slerp(targetQuat, easedProgress)\n        );\n      } else {\n        ghost.quaternion.copy(targetQuat);\n      }\n\n      updateObjectRotation(key, ghost.quaternion);\n    }\n  });\n}\n\nexport function homeLoopHandler() {\n  if (window.scrollY === 0) {\n    startHomeLoop();\n  }\n}\n\nexport function setupHomeLoopScrollHandler() {\n  window.addEventListener(\"scroll\", () => {\n    if (window.scrollY === 0) {\n      if (!isHomeLoopActive) {\n        startHomeLoop();\n      }\n    } else {\n      if (isHomeLoopActive) {\n        stopHomeLoop();\n      }\n    }\n  });\n}\n","import gsap from \"gsap\";\nimport ScrollTrigger from \"gsap/ScrollTrigger\";\nimport * as THREE from \"three\";\nimport { camera } from \"../core/camera\";\nimport { ghosts } from \"../core/objects\";\nimport { getPovPaths, TangentSmoother } from \"../paths/paths\";\nimport {\n  povTriggerPositions,\n  povPaths as pathPointsData,\n} from \"../paths/pathpoints\";\nimport { DOM_ELEMENTS } from \"../config/dom-elements\";\nimport { calculateObjectOrientation } from \"./util\";\nimport { applyPovScrollPreset, getScrollDirection } from \"./scene-presets\";\nimport {\n  SCALE,\n  TANGENT_SMOOTHING,\n  PARAMETER_SMOOTHING_FACTOR,\n  GHOST_FADE_THRESHOLD,\n  GHOST_FADE_OUT_DURATION,\n  FIND_CLOSEST_SAMPLES,\n  SCRUB_DURATION,\n  POV_SEQUENCE_PHASE_END,\n  POV_TRANSITION_PHASE_END,\n  POV_Y_CONSTRAINT_THRESHOLD,\n  OPACITY_VISIBILITY_THRESHOLD,\n  clamp,\n} from \"./constants\";\nimport { setObjectScale } from \"./scene-utils\";\nimport { setObjectOpacity } from \"../core/material-utils\";\n\nconst domElementCache: Record<\n  number,\n  {\n    parent: HTMLElement | null;\n    povElements: NodeListOf<Element>;\n    camElements: NodeListOf<Element>;\n  }\n> = {};\n\ngsap.registerPlugin(ScrollTrigger);\n\nlet povScrollTimeline: gsap.core.Timeline | null = null;\n\nlet previousCameraPosition: THREE.Vector3 | null = null;\nlet rotationStarted = false;\nlet startedInitEndScreen = false;\n\nconst startRotationPoint = new THREE.Vector3(0.55675, 0.55, 1.306);\nconst endRotationPoint = new THREE.Vector3(-0.14675, 1, 1.8085);\n\nconst wideFOV = 80;\n\nlet cachedStartYAngle: number | null = null;\n\nconst ghostStates: Record<string, any> = {};\n\nconst povTangentSmoothers: Record<string, TangentSmoother> = {};\n\nfunction getCustomLookAtForProgress(\n  progress: number,\n  povPaths: Record<string, THREE.CurvePath<THREE.Vector3>>\n): THREE.Vector3 | null {\n  const cameraPathPoints = pathPointsData.camera;\n\n  if (progress <= POV_SEQUENCE_PHASE_END) {\n    const firstPoint = cameraPathPoints[0];\n\n    if (\"lookAtSequence\" in firstPoint && firstPoint.lookAtSequence?.length) {\n      const sequenceProgress = progress / POV_SEQUENCE_PHASE_END;\n      const sequenceLength = firstPoint.lookAtSequence.length;\n\n      const segmentSize = 1 / sequenceLength;\n      const currentSegment = Math.floor(sequenceProgress / segmentSize);\n      const segmentProgress = (sequenceProgress % segmentSize) / segmentSize;\n\n      const fromIndex = Math.min(currentSegment, sequenceLength - 1);\n      const toIndex = Math.min(currentSegment + 1, sequenceLength - 1);\n\n      if (fromIndex === toIndex) {\n        return firstPoint.lookAtSequence[fromIndex];\n      } else {\n        const fromTarget = firstPoint.lookAtSequence[fromIndex];\n        const toTarget = firstPoint.lookAtSequence[toIndex];\n        return fromTarget.clone().lerp(toTarget, segmentProgress);\n      }\n    }\n  } else if (progress <= POV_TRANSITION_PHASE_END) {\n    const firstPoint = cameraPathPoints[0];\n\n    if (\"lookAtSequence\" in firstPoint && firstPoint.lookAtSequence?.length) {\n      const finalSequenceLookAt =\n        firstPoint.lookAtSequence[firstPoint.lookAtSequence.length - 1];\n\n      const position = povPaths.camera.getPointAt(progress);\n      const tangent = povPaths.camera.getTangentAt(progress).normalize();\n\n      const constrainedTangent = new THREE.Vector3(\n        tangent.x,\n        0,\n        tangent.z\n      ).normalize();\n      const defaultLookAt = position.clone().add(constrainedTangent);\n\n      const transitionProgress =\n        (progress - POV_SEQUENCE_PHASE_END) /\n        (POV_TRANSITION_PHASE_END - POV_SEQUENCE_PHASE_END);\n\n      return finalSequenceLookAt\n        .clone()\n        .lerp(defaultLookAt, transitionProgress);\n    }\n  }\n\n  return null;\n}\n\nfunction initializePovTangentSmoothers() {\n  const smoothingFactor = TANGENT_SMOOTHING.POV;\n\n  povTangentSmoothers.camera = new TangentSmoother(\n    new THREE.Vector3(0, 0, -1),\n    smoothingFactor\n  );\n\n  for (let i = 1; i <= 5; i++) {\n    povTangentSmoothers[`ghost${i}`] = new TangentSmoother(\n      new THREE.Vector3(1, 0, 0),\n      smoothingFactor\n    );\n  }\n}\n\nexport function initPovScrollAnimation() {\n  if (povScrollTimeline) {\n    povScrollTimeline.kill();\n    povScrollTimeline = null;\n  }\n\n  initializePovTangentSmoothers();\n\n  Object.keys(povTriggerPositions).forEach((key) => {\n    ghostStates[key] = {\n      hasBeenTriggered: false,\n      triggerCameraProgress: null,\n      ghostStartFadeInProgress: null,\n      ghostEndFadeInProgress: null,\n      ghostStartFadeOutProgress: null,\n      camStartFadeInProgress: null,\n      camEndFadeInProgress: null,\n      camStartFadeOutProgress: null,\n      endCameraProgress: null,\n      currentPathT: 0,\n    };\n  });\n\n  povScrollTimeline = gsap\n    .timeline({\n      scrollTrigger: {\n        id: \"povScroll\",\n        trigger: DOM_ELEMENTS.povSection,\n        start: \"top bottom\",\n        end: \"bottom top\",\n        markers: false,\n        scrub: SCRUB_DURATION,\n        toggleActions: \"play none none reverse\",\n        onEnter: () => {\n          const scrollDir = getScrollDirection();\n          applyPovScrollPreset(true, scrollDir);\n        },\n        onEnterBack: () => {\n          const scrollDir = getScrollDirection();\n          applyPovScrollPreset(true, scrollDir);\n        },\n      },\n    })\n    .addLabel(\"pov-animation-start\", 0)\n    .to(\n      { progress: 0 },\n      {\n        progress: 1,\n        immediateRender: false,\n        onStart: handleAnimationStart,\n        onUpdate: function (this: gsap.core.Tween) {\n          handleAnimationUpdate.call(this);\n        },\n        onReverseComplete: () => {\n          handleLeavePOV();\n          resetState();\n        },\n        onComplete: () => {\n          handleLeavePOV();\n          resetState();\n        },\n      }\n    )\n    .addLabel(\"pov-animation-sequence-phase\", POV_SEQUENCE_PHASE_END)\n    .addLabel(\"pov-animation-transition-phase\", POV_TRANSITION_PHASE_END)\n    .addLabel(\"pov-animation-end\", 1);\n}\n\nfunction handleAnimationStart() {\n  const povPaths = getPovPaths();\n\n  if (povTangentSmoothers.camera && povPaths.camera) {\n    const initialCameraTangent = povPaths.camera.getTangentAt(0);\n    if (initialCameraTangent) {\n      povTangentSmoothers.camera.reset(initialCameraTangent);\n    }\n  }\n\n  Object.entries(ghosts).forEach(([key, ghost]) => {\n    if (povPaths[key] && key !== \"pacman\") {\n      const position = povPaths[key].getPointAt(0);\n      ghost.position.copy(position);\n      const tangent = povPaths[key].getTangentAt(0).normalize();\n      ghost.lookAt(position.clone().add(tangent));\n      ghost.visible = false;\n      setObjectScale(ghost, key, \"pov\");\n    }\n  });\n\n  if (ghosts.pacman) {\n    ghosts.pacman.visible = false;\n  }\n}\n\nfunction handleAnimationUpdate(this: gsap.core.Tween) {\n  const overallProgress = (this.targets()[0] as any).progress;\n\n  const povPaths = getPovPaths();\n\n  if (!povPaths.camera) return;\n\n  const cameraPosition = povPaths.camera.getPointAt(overallProgress);\n\n  if (previousCameraPosition) {\n    updateCamera(overallProgress, povPaths, cameraPosition);\n    updateGhosts(cameraPosition, overallProgress, povPaths);\n    previousCameraPosition.copy(cameraPosition);\n  } else {\n    previousCameraPosition = cameraPosition.clone();\n  }\n}\n\nfunction updateCamera(\n  progress: number,\n  povPaths: Record<string, THREE.CurvePath<THREE.Vector3>>,\n  position: THREE.Vector3\n) {\n  const introScrollTrigger = ScrollTrigger.getById(\"introScroll\");\n  const isIntroScrollActive = introScrollTrigger && introScrollTrigger.isActive;\n\n  if (isIntroScrollActive) {\n    return;\n  }\n\n  camera.position.copy(position);\n  camera.fov = wideFOV;\n\n  const customLookAt = getCustomLookAtForProgress(progress, povPaths);\n  if (customLookAt) {\n    camera.lookAt(customLookAt);\n    camera.updateProjectionMatrix();\n    return;\n  }\n\n  const rawTangent = povPaths.camera.getTangentAt(progress).normalize();\n  let smoothTangent = rawTangent;\n\n  if (povTangentSmoothers.camera && progress > 0) {\n    smoothTangent = povTangentSmoothers.camera.update(rawTangent);\n  }\n\n  if (progress <= POV_Y_CONSTRAINT_THRESHOLD) {\n    smoothTangent = new THREE.Vector3(\n      smoothTangent.x,\n      0,\n      smoothTangent.z\n    ).normalize();\n  }\n\n  const defaultLookAt = position.clone().add(smoothTangent);\n  handleDefaultOrientation(progress, defaultLookAt);\n\n  camera.updateProjectionMatrix();\n}\n\nfunction handleDefaultOrientation(\n  progress: number,\n  defaultLookAt: THREE.Vector3\n) {\n  const povPaths = getPovPaths();\n  const startRotationProgress = findClosestProgressOnPath(\n    povPaths.camera,\n    startRotationPoint\n  );\n  const endRotationProgress = findClosestProgressOnPath(\n    povPaths.camera,\n    endRotationPoint\n  );\n\n  if (\n    (progress < startRotationProgress || progress > endRotationProgress) &&\n    !startedInitEndScreen\n  ) {\n    cachedStartYAngle = null;\n    rotationStarted = false;\n    startedInitEndScreen = false;\n  }\n\n  if (!rotationStarted && !startedInitEndScreen) {\n    camera.lookAt(defaultLookAt);\n  }\n}\n\nfunction updateGhosts(\n  cameraPosition: THREE.Vector3,\n  overallProgress: number,\n  povPaths: Record<string, THREE.CurvePath<THREE.Vector3>>\n) {\n  Object.entries(povTriggerPositions).forEach(([key, triggerData]) => {\n    const ghost = ghosts[key];\n    const path = povPaths[key];\n\n    if (!ghost || !path || key === \"pacman\") return;\n    const forceEndProgress =\n      overallProgress > triggerData.forceEndProgress.start &&\n      overallProgress < triggerData.forceEndProgress.end;\n\n    updateGhost(\n      key,\n      ghost,\n      path,\n      cameraPosition,\n      triggerData,\n      forceEndProgress\n    );\n  });\n}\n\nfunction updateGhost(\n  key: string,\n  ghost: THREE.Object3D,\n  path: THREE.CurvePath<THREE.Vector3>,\n  cameraPosition: THREE.Vector3,\n  triggerData: any,\n  forceEndProgress: boolean\n) {\n  const {\n    triggerPos,\n    ghostStartFadeIn,\n    ghostEndFadeIn,\n    ghostStartFadeOut,\n    camStartFadeIn,\n    camEndFadeIn,\n    camStartFadeOut,\n    endPosition,\n  } = triggerData;\n  const state = ghostStates[key];\n\n  const ghostIndex = parseInt(key.replace(\"ghost\", \"\")) - 1;\n  let cached = domElementCache[ghostIndex];\n\n  if (!cached) {\n    const parentElements = document.querySelectorAll(\".cmp--pov.cmp\");\n    const parent = parentElements[ghostIndex] as HTMLElement;\n    cached = {\n      parent: parent || null,\n      povElements: parent\n        ? parent.querySelectorAll(\".pov\")\n        : (document.querySelectorAll(\".nonexistent\") as NodeListOf<Element>),\n      camElements: parent\n        ? parent.querySelectorAll(\".cam\")\n        : (document.querySelectorAll(\".nonexistent\") as NodeListOf<Element>),\n    };\n    domElementCache[ghostIndex] = cached;\n  }\n\n  const { parent, povElements, camElements } = cached;\n  if (!parent || !povElements.length || !camElements.length) return;\n\n  const povPaths = getPovPaths();\n  if (state.triggerCameraProgress === null) {\n    state.triggerCameraProgress = findClosestProgressOnPath(\n      povPaths.camera,\n      triggerPos,\n      FIND_CLOSEST_SAMPLES\n    );\n    state.ghostStartFadeInProgress = findClosestProgressOnPath(\n      povPaths.camera,\n      ghostStartFadeIn,\n      FIND_CLOSEST_SAMPLES\n    );\n    state.ghostEndFadeInProgress = findClosestProgressOnPath(\n      povPaths.camera,\n      ghostEndFadeIn,\n      FIND_CLOSEST_SAMPLES\n    );\n    state.ghostStartFadeOutProgress = findClosestProgressOnPath(\n      povPaths.camera,\n      ghostStartFadeOut,\n      FIND_CLOSEST_SAMPLES\n    );\n    state.camStartFadeInProgress = findClosestProgressOnPath(\n      povPaths.camera,\n      camStartFadeIn,\n      FIND_CLOSEST_SAMPLES\n    );\n    state.camEndFadeInProgress = findClosestProgressOnPath(\n      povPaths.camera,\n      camEndFadeIn,\n      FIND_CLOSEST_SAMPLES\n    );\n    state.camStartFadeOutProgress = findClosestProgressOnPath(\n      povPaths.camera,\n      camStartFadeOut,\n      FIND_CLOSEST_SAMPLES\n    );\n    state.endCameraProgress = findClosestProgressOnPath(\n      povPaths.camera,\n      endPosition,\n      FIND_CLOSEST_SAMPLES\n    );\n  }\n\n  const currentCameraProgress = findClosestProgressOnPath(\n    povPaths.camera,\n    cameraPosition,\n    FIND_CLOSEST_SAMPLES\n  );\n\n  if (\n    currentCameraProgress >= state.triggerCameraProgress &&\n    currentCameraProgress <= state.endCameraProgress\n  ) {\n    if (!ghost.visible) {\n      ghost.visible = true;\n      state.hasBeenTriggered = true;\n\n      if (povTangentSmoothers[key]) {\n        const initialTangent = path.getTangentAt(0);\n        if (initialTangent) {\n          povTangentSmoothers[key].reset(initialTangent);\n        }\n      }\n    }\n\n    const normalizedProgress =\n      (currentCameraProgress - state.triggerCameraProgress) /\n      (state.endCameraProgress - state.triggerCameraProgress);\n    let ghostProgress = clamp(normalizedProgress);\n\n    if (state.currentPathT === undefined) {\n      state.currentPathT = ghostProgress;\n    } else {\n      state.currentPathT +=\n        (ghostProgress - state.currentPathT) * PARAMETER_SMOOTHING_FACTOR;\n    }\n\n    ghostProgress = state.currentPathT;\n\n    const pathPoint = path.getPointAt(ghostProgress);\n    ghost.position.copy(pathPoint);\n\n    if (povTangentSmoothers[key] && ghostProgress > 0) {\n      const rawTangent = path.getTangentAt(ghostProgress);\n      if (rawTangent && rawTangent.length() > 0) {\n        const smoothTangent = povTangentSmoothers[key].update(rawTangent);\n        calculateObjectOrientation(ghost, smoothTangent, \"ghost\");\n      }\n    }\n\n    const targetOpacity =\n      ghostProgress > GHOST_FADE_THRESHOLD\n        ? 1 - (ghostProgress - GHOST_FADE_THRESHOLD) / GHOST_FADE_OUT_DURATION\n        : 1.0;\n    setObjectOpacity(ghost, targetOpacity, {\n      preserveTransmission: true,\n      skipCurrencySymbols: true,\n    });\n  } else {\n    ghost.visible = false;\n    state.hasBeenTriggered = false;\n  }\n\n  updateTextVisibility(\n    key,\n    currentCameraProgress,\n    state,\n    parent,\n    povElements,\n    camElements,\n    forceEndProgress\n  );\n}\n\nfunction calculateTextOpacities(\n  currentCameraProgress: number,\n  state: any\n): { targetGhostOpacity: number; targetCamOpacity: number } {\n  let targetGhostOpacity = 0;\n  let targetCamOpacity = 0;\n\n  if (\n    currentCameraProgress >= state.ghostStartFadeInProgress &&\n    currentCameraProgress <= state.ghostEndFadeInProgress\n  ) {\n    const fadeProgress =\n      (currentCameraProgress - state.ghostStartFadeInProgress) /\n      (state.ghostEndFadeInProgress - state.ghostStartFadeInProgress);\n    targetGhostOpacity = Math.min(1, fadeProgress);\n  } else if (\n    currentCameraProgress > state.ghostEndFadeInProgress &&\n    currentCameraProgress < state.ghostStartFadeOutProgress\n  ) {\n    targetGhostOpacity = 1;\n  } else if (\n    currentCameraProgress >= state.ghostStartFadeOutProgress &&\n    currentCameraProgress <= state.camStartFadeInProgress\n  ) {\n    const fadeOutProgress =\n      (currentCameraProgress - state.ghostStartFadeOutProgress) /\n      (state.camStartFadeInProgress - state.ghostStartFadeOutProgress);\n    targetGhostOpacity = Math.max(0, 1 - fadeOutProgress);\n  }\n\n  if (\n    currentCameraProgress >= state.camStartFadeInProgress &&\n    currentCameraProgress <= state.camEndFadeInProgress\n  ) {\n    const fadeProgress =\n      (currentCameraProgress - state.camStartFadeInProgress) /\n      (state.camEndFadeInProgress - state.camStartFadeInProgress);\n    targetCamOpacity = Math.min(1, fadeProgress);\n  } else if (\n    currentCameraProgress > state.camEndFadeInProgress &&\n    currentCameraProgress < state.camStartFadeOutProgress\n  ) {\n    targetCamOpacity = 1;\n  } else if (\n    currentCameraProgress >= state.camStartFadeOutProgress &&\n    currentCameraProgress <= state.endCameraProgress\n  ) {\n    const fadeOutProgress =\n      (currentCameraProgress - state.camStartFadeOutProgress) /\n      (state.endCameraProgress - state.camStartFadeOutProgress);\n    targetCamOpacity = Math.max(0, 1 - fadeOutProgress);\n  }\n\n  return { targetGhostOpacity, targetCamOpacity };\n}\n\nfunction updateTextElementVisibility(\n  elements: NodeListOf<Element>,\n  targetOpacity: number\n): void {\n  elements.forEach((element) => {\n    const el = element as HTMLElement;\n    if (targetOpacity > OPACITY_VISIBILITY_THRESHOLD) {\n      el.classList.remove(\"no-visibility\");\n      el.style.opacity = targetOpacity.toString();\n    } else if (\n      targetOpacity <= OPACITY_VISIBILITY_THRESHOLD &&\n      !el.classList.contains(\"no-visibility\")\n    ) {\n      el.classList.add(\"no-visibility\");\n      el.style.opacity = \"0\";\n    }\n  });\n}\n\nfunction updateTextVisibility(\n  key: string,\n  currentCameraProgress: number,\n  state: any,\n  parent: HTMLElement,\n  povElements: NodeListOf<Element>,\n  camElements: NodeListOf<Element>,\n  forceEndProgress: boolean = false\n) {\n  if (forceEndProgress) {\n    parent.style.opacity = \"0\";\n    parent.classList.add(\"no-visibility\");\n    hideTextElements(povElements);\n    hideTextElements(camElements);\n    return;\n  }\n\n  const { targetGhostOpacity, targetCamOpacity } = calculateTextOpacities(\n    currentCameraProgress,\n    state\n  );\n\n  if (currentCameraProgress >= state.camStartFadeOutProgress) {\n    parent.style.opacity = targetCamOpacity.toString();\n  } else if (\n    currentCameraProgress >= state.ghostStartFadeInProgress &&\n    currentCameraProgress <= state.ghostEndFadeInProgress\n  ) {\n    parent.style.opacity = targetGhostOpacity.toString();\n  }\n\n  const isPassed =\n    targetCamOpacity > OPACITY_VISIBILITY_THRESHOLD &&\n    targetGhostOpacity > OPACITY_VISIBILITY_THRESHOLD;\n  const hasNoVisibility = parent.classList.contains(\"no-visibility\");\n\n  if (isPassed && !hasNoVisibility) {\n    parent.classList.add(\"no-visibility\");\n  } else if (!isPassed && hasNoVisibility) {\n    parent.classList.remove(\"no-visibility\");\n  }\n\n  if (targetGhostOpacity > OPACITY_VISIBILITY_THRESHOLD) {\n    updateTextElementVisibility(povElements, targetGhostOpacity);\n  } else {\n    hideTextElements(povElements);\n  }\n\n  if (targetCamOpacity > OPACITY_VISIBILITY_THRESHOLD) {\n    updateTextElementVisibility(camElements, targetCamOpacity);\n  } else {\n    hideTextElements(camElements);\n  }\n}\n\nfunction resetTangentSmoothers() {\n  Object.keys(povTangentSmoothers).forEach((key) => {\n    if (povTangentSmoothers[key]) {\n      const resetVector =\n        key === \"camera\"\n          ? new THREE.Vector3(0, 0, -1)\n          : new THREE.Vector3(1, 0, 0);\n      povTangentSmoothers[key].reset(resetVector);\n    }\n  });\n}\n\nfunction hideTextElements(elements: NodeListOf<Element>) {\n  elements.forEach((element) => {\n    const el = element as HTMLElement;\n    el.classList.add(\"no-visibility\");\n    el.style.opacity = \"0\";\n  });\n}\n\nfunction handleLeavePOV() {\n  Object.entries(ghosts).forEach(([key, ghost]) => {\n    if (key !== \"pacman\") {\n      ghost.visible = false;\n\n      const ghostIndex = parseInt(key.replace(\"ghost\", \"\")) - 1;\n      const cached = domElementCache[ghostIndex];\n\n      if (cached?.parent) {\n        hideTextElements(cached.povElements);\n        hideTextElements(cached.camElements);\n        cached.parent.classList.add(\"no-visibility\");\n      }\n\n      setObjectOpacity(ghost, 1.0, {\n        preserveTransmission: true,\n        skipCurrencySymbols: true,\n      });\n    }\n  });\n\n  if (ghosts.pacman) {\n    ghosts.pacman.visible = true;\n  }\n\n  resetTangentSmoothers();\n}\n\nfunction resetState() {\n  if (ghosts.pacman) {\n    ghosts.pacman.visible = true;\n  }\n\n  rotationStarted = false;\n  cachedStartYAngle = null;\n  startedInitEndScreen = false;\n\n  Object.keys(ghostStates).forEach((key) => {\n    ghostStates[key] = {\n      hasBeenTriggered: false,\n      triggerCameraProgress: null,\n      ghostStartFadeInProgress: null,\n      ghostEndFadeInProgress: null,\n      ghostStartFadeOutProgress: null,\n      camStartFadeInProgress: null,\n      camEndFadeInProgress: null,\n      camStartFadeOutProgress: null,\n      endCameraProgress: null,\n      currentPathT: 0,\n    };\n  });\n\n  resetTangentSmoothers();\n}\n\nfunction findClosestProgressOnPath(\n  path: THREE.CurvePath<THREE.Vector3>,\n  targetPoint: THREE.Vector3,\n  samples: number = FIND_CLOSEST_SAMPLES\n): number {\n  if (!path || !targetPoint) return 0;\n\n  let closestProgress = 0;\n  let closestDistance = Infinity;\n\n  for (let i = 0; i < samples; i++) {\n    try {\n      const t = i / (samples - 1);\n      const pointOnPath = path.getPointAt(t);\n      if (!pointOnPath) continue;\n\n      const distance = pointOnPath.distanceTo(targetPoint);\n      if (distance < closestDistance) {\n        closestDistance = distance;\n        closestProgress = t;\n      }\n    } catch (error) {}\n  }\n\n  return closestProgress;\n}\n","import gsap from \"gsap\";\nimport ScrollTrigger from \"gsap/ScrollTrigger\";\nimport * as THREE from \"three\";\nimport { camera } from \"../core/camera\";\nimport { ghosts, pacmanMixer, pill } from \"../core/objects\";\nimport { clock, scene } from \"../core/scene\";\nimport { slerpToLayDown, applyRotations } from \"./util\";\nimport { isCurrencySymbol, isPacmanPart } from \"./util\";\nimport {\n  SCROLL_SELECTORS,\n  OPACITY,\n  INTRO_WALK_DISTANCE,\n  INTRO_FADE_IN_DURATION,\n  INTRO_POSITION_OFFSET,\n  SCRUB_DURATION,\n  KEYFRAME_SCALE,\n  KEYFRAME_DURATION,\n  INTRO_GHOST_OFFSETS,\n  clamp,\n} from \"./constants\";\nimport { setFloorPlane, setObjectScale } from \"./scene-utils\";\n\nlet introScrollTimeline: gsap.core.Timeline | null = null;\nlet isIntroScrollActive = false;\nlet lastUpdateProgress: number | null = null;\nlet pacmanTargetQuaternion: THREE.Quaternion | null = null;\nlet ghostTargetQuaternion: THREE.Quaternion | null = null;\nlet introInitialRotations: Record<string, THREE.Quaternion> = {};\nlet cachedCameraPosition: THREE.Vector3 | null = null;\nlet lastCameraUpdateFrame = -1;\nlet introGridGuides: THREE.Group | null = null;\n\nfunction resetIntroScrollCache() {\n  cachedCameraPosition = null;\n  lastCameraUpdateFrame = -1;\n  lastUpdateProgress = null;\n}\n\nfunction setIntroScrollLocked(locked: boolean) {\n  Object.values(ghosts).forEach((obj) => {\n    obj.userData.introScrollLocked = locked;\n  });\n}\n\nfunction restoreFloor() {\n  const floorState = {\n    visible: true,\n    opacity: OPACITY.FULL,\n    transparent: false,\n  };\n  if (\n    !lastFloorState ||\n    lastFloorState.visible !== floorState.visible ||\n    lastFloorState.opacity !== floorState.opacity ||\n    lastFloorState.transparent !== floorState.transparent\n  ) {\n    setFloorPlane(\n      floorState.visible,\n      floorState.opacity,\n      floorState.transparent\n    );\n    lastFloorState = floorState;\n  }\n}\n\nfunction createIntroGridGuides() {\n  // Remove existing guides if they exist\n  if (introGridGuides) {\n    scene.remove(introGridGuides);\n    introGridGuides = null;\n  }\n\n  const gridGroup = new THREE.Group();\n  gridGroup.name = \"introGridGuides\";\n  introGridGuides = gridGroup;\n\n  const gridSize = 20;\n  const gridDivisions = 40;\n  // Make grid more visible with brighter colors\n  const gridHelper = new THREE.GridHelper(\n    gridSize,\n    gridDivisions,\n    0xffffff,\n    0x888888\n  );\n  gridHelper.position.y = 0;\n  gridGroup.add(gridHelper);\n\n  // Create axes helper at origin - make it larger\n  const axesHelper = new THREE.AxesHelper(5);\n  gridGroup.add(axesHelper);\n\n  // Create a semi-transparent plane to show XZ plane at Y=0\n  const planeGeometry = new THREE.PlaneGeometry(gridSize, gridSize);\n  const planeMaterial = new THREE.MeshBasicMaterial({\n    color: 0xffffff,\n    transparent: true,\n    opacity: 0.1,\n    side: THREE.DoubleSide,\n  });\n  const plane = new THREE.Mesh(planeGeometry, planeMaterial);\n  plane.rotation.x = -Math.PI / 2;\n  plane.position.y = 0;\n  gridGroup.add(plane);\n\n  // Create colored lines along axes - make them thicker and brighter\n  // X-axis line (red)\n  const xLineGeometry = new THREE.BufferGeometry().setFromPoints([\n    new THREE.Vector3(-gridSize / 2, 0, 0),\n    new THREE.Vector3(gridSize / 2, 0, 0),\n  ]);\n  const xLineMaterial = new THREE.LineBasicMaterial({ color: 0xff0000 });\n  const xLine = new THREE.Line(xLineGeometry, xLineMaterial);\n  xLine.renderOrder = 1000; // Render on top\n  gridGroup.add(xLine);\n\n  // Y-axis line (green)\n  const yLineGeometry = new THREE.BufferGeometry().setFromPoints([\n    new THREE.Vector3(0, -gridSize / 2, 0),\n    new THREE.Vector3(0, gridSize / 2, 0),\n  ]);\n  const yLineMaterial = new THREE.LineBasicMaterial({ color: 0x00ff00 });\n  const yLine = new THREE.Line(yLineGeometry, yLineMaterial);\n  yLine.renderOrder = 1000;\n  gridGroup.add(yLine);\n\n  // Z-axis line (blue)\n  const zLineGeometry = new THREE.BufferGeometry().setFromPoints([\n    new THREE.Vector3(0, 0, -gridSize / 2),\n    new THREE.Vector3(0, 0, gridSize / 2),\n  ]);\n  const zLineMaterial = new THREE.LineBasicMaterial({ color: 0x0000ff });\n  const zLine = new THREE.Line(zLineGeometry, zLineMaterial);\n  zLine.renderOrder = 1000;\n  gridGroup.add(zLine);\n\n  // Create marked reference positions\n  const markerPositions = [\n    {\n      pos: new THREE.Vector3(0, 0, 0),\n      color: 0xffff00,\n      label: \"Origin (0,0,0)\",\n    },\n    {\n      pos: new THREE.Vector3(4.3, -2.0, 0),\n      color: 0x00ffff,\n      label: \"Maze Center (4.3,-2.0,0)\",\n    },\n    {\n      pos: new THREE.Vector3(0.5, 0.5, 0.5),\n      color: 0xff00ff,\n      label: \"Pill Target (0.5,0.5,0.5)\",\n    },\n  ];\n\n  markerPositions.forEach(({ pos, color, label }) => {\n    // Create a larger sphere at the position for better visibility\n    const sphereGeometry = new THREE.SphereGeometry(0.3, 16, 16);\n    const sphereMaterial = new THREE.MeshBasicMaterial({\n      color,\n      transparent: true,\n      opacity: 0.9,\n    });\n    const sphere = new THREE.Mesh(sphereGeometry, sphereMaterial);\n    sphere.position.copy(pos);\n    sphere.renderOrder = 1001;\n    gridGroup.add(sphere);\n\n    // Create a wireframe box above the marker for visibility - make it larger\n    const boxGeometry = new THREE.BoxGeometry(0.6, 0.6, 0.6);\n    const boxMaterial = new THREE.MeshBasicMaterial({\n      color,\n      wireframe: true,\n      transparent: true,\n      opacity: 1.0,\n    });\n    const box = new THREE.Mesh(boxGeometry, boxMaterial);\n    box.position.copy(pos);\n    box.position.y += 0.6;\n    box.renderOrder = 1001;\n    box.userData.labelText = label;\n    gridGroup.add(box);\n  });\n\n  // Position grid at origin (0, 0, 0) - the grid will show the world coordinates\n  gridGroup.position.set(0, 0, 0);\n\n  scene.add(gridGroup);\n  console.log(\"Intro grid guides created at position:\", gridGroup.position);\n  console.log(\"Grid size:\", gridSize, \"Divisions:\", gridDivisions);\n  console.log(\n    \"Grid added to scene, scene children count:\",\n    scene.children.length\n  );\n  console.log(\"Grid group children count:\", gridGroup.children.length);\n}\n\nfunction removeIntroGridGuides() {\n  if (introGridGuides) {\n    scene.remove(introGridGuides);\n    introGridGuides = null;\n    console.log(\"Intro grid guides removed\");\n  }\n}\n\nexport function initIntroScrollAnimation() {\n  if (introScrollTimeline) {\n    introScrollTimeline.kill();\n    introScrollTimeline = null;\n  }\n\n  introScrollTimeline = gsap\n    .timeline({\n      scrollTrigger: {\n        trigger: SCROLL_SELECTORS.INTRO,\n        start: \"top top\",\n        end: \"bottom bottom\",\n        scrub: SCRUB_DURATION,\n        refreshPriority: 1,\n        markers: {\n          startColor: \"green\",\n          endColor: \"red\",\n          fontSize: \"12px\",\n          fontWeight: \"bold\",\n          indent: 60,\n        },\n        onEnter: () => {\n          console.log(\"Intro scroll onEnter triggered\");\n          isIntroScrollActive = true;\n          resetIntroScrollCache();\n          setIntroScrollLocked(true);\n          createIntroGridGuides();\n        },\n        onEnterBack: () => {\n          console.log(\"Intro scroll onEnterBack triggered\");\n          isIntroScrollActive = true;\n          resetIntroScrollCache();\n          setIntroScrollLocked(true);\n          createIntroGridGuides();\n        },\n        onLeave: () => {\n          isIntroScrollActive = false;\n          resetIntroScrollCache();\n          restoreFloor();\n          setIntroScrollLocked(false);\n          removeIntroGridGuides();\n        },\n        onLeaveBack: () => {\n          isIntroScrollActive = false;\n          resetIntroScrollCache();\n          restoreFloor();\n          setIntroScrollLocked(false);\n          removeIntroGridGuides();\n        },\n        onUpdate: (self) => {\n          if (typeof self.progress === \"number\") {\n            updateObjectsWalkBy(self.progress);\n          }\n        },\n        id: \"introScroll\",\n      },\n    })\n    .addLabel(\"intro-text-start\", 0)\n    .fromTo(\n      \".sc_h--intro\",\n      { scale: KEYFRAME_SCALE.START, opacity: OPACITY.HIDDEN },\n      {\n        keyframes: [\n          {\n            scale: KEYFRAME_SCALE.START,\n            opacity: OPACITY.HIDDEN,\n            duration: KEYFRAME_DURATION.NONE,\n          },\n          {\n            scale: KEYFRAME_SCALE.MID,\n            opacity: OPACITY.FULL,\n            duration: KEYFRAME_DURATION.FADE_IN,\n          },\n          {\n            scale: KEYFRAME_SCALE.LARGE,\n            opacity: OPACITY.FULL,\n            duration: KEYFRAME_DURATION.HOLD,\n          },\n          {\n            scale: KEYFRAME_SCALE.END,\n            opacity: OPACITY.HIDDEN,\n            duration: KEYFRAME_DURATION.FADE_OUT,\n          },\n        ],\n      }\n    )\n    .addLabel(\"intro-text-fade-in\", KEYFRAME_DURATION.NONE)\n    .addLabel(\n      \"intro-text-hold\",\n      KEYFRAME_DURATION.NONE + KEYFRAME_DURATION.FADE_IN\n    )\n    .addLabel(\n      \"intro-text-fade-out\",\n      KEYFRAME_DURATION.NONE +\n        KEYFRAME_DURATION.FADE_IN +\n        KEYFRAME_DURATION.HOLD\n    )\n    .fromTo(\n      \".sc_b--intro\",\n      { scale: KEYFRAME_SCALE.START, opacity: OPACITY.HIDDEN },\n      {\n        keyframes: [\n          {\n            scale: KEYFRAME_SCALE.START,\n            opacity: OPACITY.HIDDEN,\n            duration: KEYFRAME_DURATION.NONE,\n          },\n          {\n            scale: KEYFRAME_SCALE.MID,\n            opacity: OPACITY.FULL,\n            duration: KEYFRAME_DURATION.FADE_IN,\n          },\n          {\n            scale: KEYFRAME_SCALE.LARGE,\n            opacity: OPACITY.FULL,\n            duration: KEYFRAME_DURATION.HOLD,\n          },\n          {\n            scale: KEYFRAME_SCALE.END,\n            opacity: OPACITY.HIDDEN,\n            duration: KEYFRAME_DURATION.FADE_OUT,\n          },\n        ],\n      }\n    )\n    .addLabel(\n      \"intro-text-end\",\n      KEYFRAME_DURATION.NONE +\n        KEYFRAME_DURATION.FADE_IN +\n        KEYFRAME_DURATION.HOLD +\n        KEYFRAME_DURATION.FADE_OUT\n    );\n}\n\nfunction initializeQuaternions() {\n  if (pacmanTargetQuaternion && ghostTargetQuaternion) return;\n\n  const pacmanObj = ghosts.pacman;\n  if (pacmanObj) {\n    if (!introInitialRotations[\"pacman\"]) {\n      introInitialRotations[\"pacman\"] = pacmanObj.quaternion.clone();\n    }\n\n    let quat = introInitialRotations[\"pacman\"].clone();\n    const tempObj = new THREE.Object3D();\n    tempObj.quaternion.copy(quat);\n    slerpToLayDown(tempObj, quat, OPACITY.FULL);\n    quat = tempObj.quaternion.clone();\n\n    quat = applyRotations(quat, [\n      { axis: \"x\", angle: Math.PI / 2 },\n      { axis: \"y\", angle: Math.PI },\n      { axis: \"y\", angle: Math.PI },\n      { axis: \"x\", angle: Math.PI },\n      { axis: \"x\", angle: Math.PI },\n      { axis: \"y\", angle: Math.PI },\n    ]);\n\n    pacmanTargetQuaternion = quat;\n  }\n\n  const ghostObj = ghosts.ghost1;\n  if (ghostObj) {\n    if (!introInitialRotations[\"ghost1\"]) {\n      introInitialRotations[\"ghost1\"] = ghostObj.quaternion.clone();\n    }\n\n    let quat = introInitialRotations[\"ghost1\"].clone();\n    const tempObj = new THREE.Object3D();\n    tempObj.quaternion.copy(quat);\n    slerpToLayDown(tempObj, quat, OPACITY.FULL);\n    quat = tempObj.quaternion.clone();\n\n    quat = applyRotations(quat, [\n      { axis: \"x\", angle: Math.PI },\n      { axis: \"x\", angle: Math.PI },\n      { axis: \"y\", angle: Math.PI },\n      { axis: \"y\", angle: Math.PI },\n      { axis: \"x\", angle: Math.PI },\n      { axis: \"x\", angle: Math.PI },\n    ]);\n\n    ghostTargetQuaternion = quat;\n  }\n\n  Object.keys(ghosts).forEach((key) => {\n    const obj = ghosts[key as keyof typeof ghosts];\n    if (obj && !introInitialRotations[key]) {\n      introInitialRotations[key] = obj.quaternion.clone();\n    }\n  });\n}\n\nlet lastFloorState: {\n  visible: boolean;\n  opacity: number;\n  transparent: boolean;\n} | null = null;\n\nconst tempVector = new THREE.Vector3();\n\nfunction updateObjectsWalkBy(progress: number) {\n  if (!isIntroScrollActive) return;\n\n  if (lastUpdateProgress === progress) return;\n  lastUpdateProgress = progress;\n\n  const currentFrame = performance.now();\n  const shouldUpdateCache =\n    !cachedCameraPosition || currentFrame - lastCameraUpdateFrame > 16;\n\n  if (shouldUpdateCache) {\n    const camX = camera.position.x;\n    const camY = camera.position.y;\n    const camZ = camera.position.z;\n\n    if (!isFinite(camX) || !isFinite(camY) || !isFinite(camZ)) {\n      if (!cachedCameraPosition) {\n        return;\n      }\n      tempVector.copy(cachedCameraPosition);\n    } else {\n      if (!cachedCameraPosition) {\n        cachedCameraPosition = new THREE.Vector3();\n      }\n      cachedCameraPosition.set(camX, camY, camZ);\n      lastCameraUpdateFrame = currentFrame;\n      tempVector.copy(cachedCameraPosition);\n    }\n  } else {\n    tempVector.copy(cachedCameraPosition!);\n  }\n\n  initializeQuaternions();\n\n  if (pacmanMixer) {\n    pacmanMixer.update(clock.getDelta());\n  }\n\n  const floorState = {\n    visible: true,\n    opacity: OPACITY.HIDDEN,\n    transparent: true,\n  };\n  if (\n    !lastFloorState ||\n    lastFloorState.visible !== floorState.visible ||\n    lastFloorState.opacity !== floorState.opacity ||\n    lastFloorState.transparent !== floorState.transparent\n  ) {\n    setFloorPlane(\n      floorState.visible,\n      floorState.opacity,\n      floorState.transparent\n    );\n    lastFloorState = floorState;\n  }\n\n  const pacmanQuat = pacmanTargetQuaternion;\n  const ghostQuat = ghostTargetQuaternion;\n\n  const walkStart = tempVector.x - INTRO_WALK_DISTANCE;\n  const walkEnd = tempVector.x + INTRO_WALK_DISTANCE;\n\n  const objectsToAnimate = [\n    {\n      key: \"pacman\",\n      behindOffset: 1.5,\n      zOffset: 0.5,\n      xOffset: 0,\n      yOffset: 0,\n      zPhase: 0,\n    },\n    {\n      key: \"ghost1\",\n      behindOffset: INTRO_GHOST_OFFSETS.GHOST1,\n      zOffset: 0.5,\n      xOffset: 0.5,\n      yOffset: -0.5,\n      zPhase: Math.PI * 1.0,\n    },\n    {\n      key: \"ghost2\",\n      behindOffset: INTRO_GHOST_OFFSETS.GHOST2,\n      zOffset: 0.5,\n      xOffset: 0,\n      yOffset: -1,\n      zPhase: Math.PI * 1.5,\n    },\n    {\n      key: \"ghost3\",\n      behindOffset: INTRO_GHOST_OFFSETS.GHOST3,\n      zOffset: 0.5,\n      xOffset: 0.5,\n      yOffset: 0.5,\n      zPhase: Math.PI * 1.0,\n    },\n    {\n      key: \"ghost4\",\n      behindOffset: INTRO_GHOST_OFFSETS.GHOST4,\n      zOffset: 0.5,\n      xOffset: 0.75,\n      yOffset: 0.25,\n      zPhase: Math.PI * 1.0,\n    },\n    {\n      key: \"ghost5\",\n      behindOffset: INTRO_GHOST_OFFSETS.GHOST5,\n      zOffset: 0.5,\n      xOffset: 0,\n      yOffset: -0.5,\n      zPhase: Math.PI * 1.0,\n    },\n    {\n      key: \"pill\",\n      behindOffset: -0.03,\n      zOffset: 0.5,\n      xOffset: -0.75,\n      yOffset: 0.25,\n      zPhase: Math.PI * 0.5,\n    },\n  ];\n\n  const normalizedProgress = clamp(progress);\n  const baseX = walkStart + (walkEnd - walkStart) * normalizedProgress;\n  const pacmanX = baseX + INTRO_POSITION_OFFSET.x;\n  const pacmanY = tempVector.y + INTRO_POSITION_OFFSET.y;\n  const pacmanZ = tempVector.z + INTRO_POSITION_OFFSET.z;\n\n  if (\n    !isFinite(baseX) ||\n    !isFinite(pacmanX) ||\n    !isFinite(pacmanY) ||\n    !isFinite(pacmanZ)\n  ) {\n    return;\n  }\n\n  const baseGhostOpacity =\n    normalizedProgress < INTRO_FADE_IN_DURATION\n      ? normalizedProgress / INTRO_FADE_IN_DURATION\n      : 1.0;\n\n  objectsToAnimate.forEach(\n    ({\n      key,\n      behindOffset,\n      zOffset,\n      xOffset,\n      yOffset: staticYOffset,\n      zPhase,\n    }) => {\n      const object = key === \"pill\" ? pill : ghosts[key];\n      if (!object) return;\n\n      const zBounce =\n        key === \"pacman\" || key === \"pill\"\n          ? 0\n          : Math.sin(normalizedProgress * Math.PI * 2 * 20 + zPhase) * 0.01;\n      const animatedYOffset =\n        key === \"pacman\" || key === \"pill\" ? 0 : zBounce * 1.5;\n      const finalX = pacmanX + behindOffset + xOffset;\n      const finalY = pacmanY + staticYOffset - animatedYOffset;\n      const finalZ = pacmanZ + zOffset - zBounce;\n\n      if (\n        !isFinite(finalX) ||\n        !isFinite(finalY) ||\n        !isFinite(finalZ) ||\n        Math.abs(finalZ) < 0.01 ||\n        Math.abs(finalZ) > 100\n      ) {\n        return;\n      }\n\n      object.position.set(finalX, finalY, finalZ);\n\n      const targetQuat = key === \"pacman\" ? pacmanQuat : ghostQuat;\n      if (targetQuat) {\n        object.quaternion.copy(targetQuat);\n      }\n\n      if (key === \"pill\") {\n        object.scale.set(0.05, 0.05, 0.05);\n      } else {\n        setObjectScale(object, key, \"intro\");\n      }\n      object.visible = true;\n\n      const targetOpacity =\n        key === \"pacman\" || key === \"pill\" ? OPACITY.FULL : baseGhostOpacity;\n\n      object.traverse((child) => {\n        if ((child as any).isMesh) {\n          const mesh = child as THREE.Mesh;\n          const childName = child.name || \"\";\n\n          if (\n            isCurrencySymbol(childName) ||\n            (key === \"pacman\" && isPacmanPart(childName))\n          ) {\n            mesh.visible = false;\n            return;\n          }\n\n          mesh.visible = true;\n\n          const mat = mesh.material;\n          if (mat) {\n            const materials = Array.isArray(mat) ? mat : [mat];\n            materials.forEach((material: any) => {\n              material.opacity = targetOpacity;\n              if (\n                material.transmission !== undefined &&\n                material.transmission > 0\n              ) {\n                material.transparent = true;\n              } else {\n                material.transparent = targetOpacity < 1.0;\n              }\n            });\n          }\n        }\n      });\n    }\n  );\n}\n","import gsap from \"gsap\";\nimport { applyOutroScrollPreset, getScrollDirection } from \"./scene-presets\";\nimport {\n  SCROLL_SELECTORS,\n  SCRUB_DURATION,\n  KEYFRAME_SCALE,\n  KEYFRAME_DURATION,\n  OPACITY,\n} from \"./constants\";\n\nlet outroScrollTimeline: gsap.core.Timeline | null = null;\n\nexport function initOutroScrollAnimation() {\n  outroScrollTimeline = gsap\n    .timeline({\n    scrollTrigger: {\n        trigger: SCROLL_SELECTORS.OUTRO,\n      start: \"top center\",\n      end: \"bottom bottom\",\n        scrub: SCRUB_DURATION,\n        markers: false,\n      onEnter: () => {\n        const scrollDir = getScrollDirection();\n        applyOutroScrollPreset(true, scrollDir);\n      },\n      onEnterBack: () => {\n        const scrollDir = getScrollDirection();\n        applyOutroScrollPreset(true, scrollDir);\n      },\n      },\n    })\n    .addLabel(\"outro-text-start\", 0)\n    .fromTo(\n      \".sc_b--outro\",\n      { scale: KEYFRAME_SCALE.START, opacity: OPACITY.HIDDEN },\n    {\n      keyframes: [\n          {\n            scale: KEYFRAME_SCALE.START,\n            opacity: OPACITY.HIDDEN,\n            duration: KEYFRAME_DURATION.NONE,\n          },\n          {\n            scale: KEYFRAME_SCALE.MID,\n            opacity: OPACITY.FULL,\n            duration: KEYFRAME_DURATION.FADE_IN,\n          },\n          {\n            scale: KEYFRAME_SCALE.LARGE,\n            opacity: OPACITY.FULL,\n            duration: KEYFRAME_DURATION.HOLD,\n          },\n          {\n            scale: KEYFRAME_SCALE.END,\n            opacity: OPACITY.HIDDEN,\n            duration: KEYFRAME_DURATION.FADE_OUT,\n          },\n        ],\n      }\n    )\n    .addLabel(\"outro-text-fade-in\", KEYFRAME_DURATION.NONE)\n    .addLabel(\n      \"outro-text-hold\",\n      KEYFRAME_DURATION.NONE + KEYFRAME_DURATION.FADE_IN\n    )\n    .addLabel(\n      \"outro-text-fade-out\",\n      KEYFRAME_DURATION.NONE +\n        KEYFRAME_DURATION.FADE_IN +\n        KEYFRAME_DURATION.HOLD\n    )\n    .addLabel(\n      \"outro-text-end\",\n      KEYFRAME_DURATION.NONE +\n        KEYFRAME_DURATION.FADE_IN +\n        KEYFRAME_DURATION.HOLD +\n        KEYFRAME_DURATION.FADE_OUT\n  );\n}\n","import * as THREE from \"three\";\nimport { pill } from \"./objects\";\n\nexport interface PillDebugInfo {\n  totalChildren: number;\n  meshes: Array<{\n    name: string;\n    visible: boolean;\n    materialType: string;\n    materialColor?: number;\n  }>;\n}\n\nexport function getPillDebugInfo(): PillDebugInfo {\n  const meshes: PillDebugInfo[\"meshes\"] = [];\n\n  // Check pill group visibility\n  const pillVisible = pill.visible;\n\n  pill.traverse((child) => {\n    if ((child as any).isMesh) {\n      const mesh = child as THREE.Mesh;\n      const mat = mesh.material;\n      let materialType = \"unknown\";\n      let materialColor: number | undefined;\n\n      if (mat) {\n        if (Array.isArray(mat)) {\n          materialType = mat[0]?.type || \"multiple\";\n          if (mat[0] && (mat[0] as any).color) {\n            materialColor = (mat[0] as any).color.getHex();\n          }\n        } else {\n          materialType = mat.type;\n          if ((mat as any).color) {\n            materialColor = (mat as any).color.getHex();\n          }\n        }\n      }\n\n      // Check if parent groups are visible\n      let parentVisible = true;\n      let parent = child.parent;\n      while (parent && parent !== pill) {\n        if (!parent.visible) {\n          parentVisible = false;\n          break;\n        }\n        parent = parent.parent;\n      }\n\n      const effectiveVisible = pillVisible && parentVisible && mesh.visible;\n\n      meshes.push({\n        name: child.name || \"unnamed\",\n        visible: effectiveVisible,\n        materialType,\n        materialColor,\n      });\n    }\n  });\n\n  return {\n    totalChildren: pill.children.length,\n    meshes,\n  };\n}\n\nexport function setPillVisibility(visible: boolean): void {\n  pill.visible = visible;\n  pill.traverse((child) => {\n    if ((child as any).isMesh) {\n      (child as THREE.Mesh).visible = visible;\n    }\n  });\n}\n\nexport function setPillMeshVisibility(namePattern: string, visible: boolean): void {\n  pill.traverse((child) => {\n    if ((child as any).isMesh) {\n      const childName = child.name || \"\";\n      if (childName.toLowerCase().includes(namePattern.toLowerCase())) {\n        const mesh = child as THREE.Mesh;\n        mesh.visible = visible;\n        // Also ensure parent groups are visible\n        let parent = child.parent;\n        while (parent && parent !== pill) {\n          parent.visible = visible;\n          parent = parent.parent;\n        }\n      }\n    }\n  });\n}\n\nexport function setPillMaterialColor(color: number): void {\n  pill.traverse((child) => {\n    if ((child as any).isMesh) {\n      const mesh = child as THREE.Mesh;\n      const mat = mesh.material;\n      if (mat) {\n        if (Array.isArray(mat)) {\n          mat.forEach((m) => {\n            if ((m as any).color) {\n              (m as any).color.setHex(color);\n            }\n          });\n        } else {\n          if ((mat as any).color) {\n            (mat as any).color.setHex(color);\n          }\n        }\n      }\n    }\n  });\n}\n\nexport function setPillMeshMaterialColor(namePattern: string, color: number): void {\n  pill.traverse((child) => {\n    if ((child as any).isMesh) {\n      const childName = child.name || \"\";\n      if (childName.toLowerCase().includes(namePattern.toLowerCase())) {\n        const mesh = child as THREE.Mesh;\n        const mat = mesh.material;\n        if (mat) {\n          if (Array.isArray(mat)) {\n            mat.forEach((m) => {\n              if ((m as any).color) {\n                (m as any).color.setHex(color);\n              }\n            });\n          } else {\n            if ((mat as any).color) {\n              (mat as any).color.setHex(color);\n            }\n          }\n        }\n      }\n    }\n  });\n}\n\nexport function resetPillMaterials(): void {\n  // This will need to import pillMaterialMap, but for now just set all to green\n  const greenColor = 0x00ff00;\n  pill.traverse((child) => {\n    if ((child as any).isMesh) {\n      const mesh = child as THREE.Mesh;\n      const mat = mesh.material;\n      if (mat) {\n        if (Array.isArray(mat)) {\n          mat.forEach((m) => {\n            if ((m as any).color) {\n              (m as any).color.setHex(greenColor);\n            }\n          });\n        } else {\n          if ((mat as any).color) {\n            (mat as any).color.setHex(greenColor);\n          }\n        }\n      }\n    }\n  });\n}\n\n","import * as THREE from \"three\";\nimport {\n  getPillDebugInfo,\n  setPillVisibility,\n  setPillMeshVisibility,\n  setPillMaterialColor,\n  setPillMeshMaterialColor,\n  resetPillMaterials,\n} from \"./debug-pill\";\n\nlet hudContainer: HTMLDivElement | null = null;\nlet isVisible = false;\n\nexport function createPillDebugHUD(): void {\n  if (hudContainer) {\n    return; // Already created\n  }\n\n  // Create container\n  hudContainer = document.createElement(\"div\");\n  hudContainer.id = \"pill-debug-hud\";\n  hudContainer.style.cssText = `\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    width: 350px;\n    max-height: 80vh;\n    background: rgba(20, 20, 20, 0.95);\n    color: #e0e0e0;\n    padding: 20px;\n    border-radius: 8px;\n    font-family: 'Courier New', monospace;\n    font-size: 13px;\n    z-index: 10000;\n    overflow-y: auto;\n    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.5);\n    border: 2px solid #4CAF50;\n  `;\n\n  // Toggle button\n  const toggleBtn = document.createElement(\"button\");\n  toggleBtn.textContent = \"Show/Hide Pill Debug\";\n  toggleBtn.style.cssText = `\n    position: fixed;\n    top: 20px;\n    right: 390px;\n    padding: 10px 15px;\n    background: #4CAF50;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    z-index: 10001;\n    font-size: 14px;\n    font-weight: bold;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);\n  `;\n  toggleBtn.addEventListener(\"click\", (e) => {\n    e.stopPropagation();\n    e.preventDefault();\n    isVisible = !isVisible;\n    if (hudContainer) {\n      hudContainer.style.display = isVisible ? \"block\" : \"none\";\n      if (isVisible) {\n        updateHUD();\n      }\n    }\n  });\n\n  document.body.appendChild(toggleBtn);\n  document.body.appendChild(hudContainer);\n  hudContainer.style.display = \"none\";\n\n  updateHUD();\n}\n\nfunction updateHUD(): void {\n  if (!hudContainer) return;\n\n  // Preserve scroll positions\n  const containerScrollTop = hudContainer.scrollTop;\n  const meshListScrollable = hudContainer.querySelector('[style*=\"overflow-y\"]') as HTMLElement;\n  const meshListScrollTop = meshListScrollable ? meshListScrollable.scrollTop : 0;\n\n  const info = getPillDebugInfo();\n\n  hudContainer.innerHTML = `\n    <h3 style=\"margin-top: 0; color: #4CAF50; font-size: 16px; text-shadow: 0 0 5px rgba(76, 175, 80, 0.5);\">Pill Debug Panel</h3>\n    \n    <div style=\"margin-bottom: 15px; color: #e0e0e0;\">\n      <strong style=\"color: #ffffff;\">Pill Structure:</strong><br>\n      Total Groups: <span style=\"color: #4CAF50;\">${info.totalChildren}</span><br>\n      Total Meshes: <span style=\"color: #4CAF50;\">${info.meshes.length}</span>\n    </div>\n\n    <div style=\"margin-bottom: 15px; color: #e0e0e0;\">\n      <strong style=\"color: #ffffff;\">Quick Controls:</strong><br>\n      <button id=\"pill-vis-all\" style=\"margin: 5px 5px 5px 0; padding: 6px 12px; cursor: pointer; background: #4CAF50; color: white; border: none; border-radius: 4px; font-weight: bold;\">Show All</button>\n      <button id=\"pill-hide-all\" style=\"margin: 5px 5px 5px 0; padding: 6px 12px; cursor: pointer; background: #f44336; color: white; border: none; border-radius: 4px; font-weight: bold;\">Hide All</button>\n      <button id=\"pill-reset-colors\" style=\"margin: 5px 5px 5px 0; padding: 6px 12px; cursor: pointer; background: #2196F3; color: white; border: none; border-radius: 4px; font-weight: bold;\">Reset Colors</button>\n    </div>\n\n    <div style=\"margin-bottom: 15px; color: #e0e0e0;\">\n      <strong style=\"color: #ffffff;\">Shell Controls:</strong><br>\n      <button id=\"pill-shell-show\" style=\"margin: 5px 5px 5px 0; padding: 6px 12px; cursor: pointer; background: #4CAF50; color: white; border: none; border-radius: 4px; font-weight: bold;\">Show Shell</button>\n      <button id=\"pill-shell-hide\" style=\"margin: 5px 5px 5px 0; padding: 6px 12px; cursor: pointer; background: #f44336; color: white; border: none; border-radius: 4px; font-weight: bold;\">Hide Shell</button>\n      <button id=\"pill-shell-red\" style=\"margin: 5px 5px 5px 0; padding: 6px 12px; cursor: pointer; background: #f44336; color: white; border: none; border-radius: 4px; font-weight: bold;\">Shell Red</button>\n      <button id=\"pill-shell-green\" style=\"margin: 5px 5px 5px 0; padding: 6px 12px; cursor: pointer; background: #4CAF50; color: white; border: none; border-radius: 4px; font-weight: bold;\">Shell Green</button>\n    </div>\n\n    <div style=\"margin-bottom: 15px; color: #e0e0e0;\">\n      <strong style=\"color: #ffffff;\">Inlay Controls:</strong><br>\n      <button id=\"pill-inlay-show\" style=\"margin: 5px 5px 5px 0; padding: 6px 12px; cursor: pointer; background: #4CAF50; color: white; border: none; border-radius: 4px; font-weight: bold;\">Show Inlay</button>\n      <button id=\"pill-inlay-hide\" style=\"margin: 5px 5px 5px 0; padding: 6px 12px; cursor: pointer; background: #f44336; color: white; border: none; border-radius: 4px; font-weight: bold;\">Hide Inlay</button>\n      <button id=\"pill-inlay-orange\" style=\"margin: 5px 5px 5px 0; padding: 6px 12px; cursor: pointer; background: #ff9800; color: white; border: none; border-radius: 4px; font-weight: bold;\">Inlay Orange</button>\n    </div>\n\n    <div style=\"margin-bottom: 15px; color: #e0e0e0;\">\n      <strong style=\"color: #ffffff;\">Global Color:</strong><br>\n      <input type=\"color\" id=\"pill-color-picker\" value=\"#00ff00\" style=\"width: 100px; height: 35px; margin-top: 5px; border: 2px solid #4CAF50; border-radius: 4px; cursor: pointer;\">\n      <button id=\"pill-apply-color\" style=\"margin-left: 10px; padding: 6px 12px; cursor: pointer; background: #2196F3; color: white; border: none; border-radius: 4px; font-weight: bold;\">Apply to All</button>\n    </div>\n\n    <div style=\"margin-bottom: 15px; color: #e0e0e0;\">\n      <strong style=\"color: #ffffff;\">Mesh List (${info.meshes.length}):</strong><br>\n      <div style=\"max-height: 300px; overflow-y: auto; background: rgba(255,255,255,0.08); padding: 10px; margin-top: 5px; border-radius: 4px; border: 1px solid rgba(255,255,255,0.2);\">\n        ${info.meshes\n          .map(\n            (mesh, idx) => `\n          <div style=\"margin-bottom: 8px; padding: 8px; background: rgba(255,255,255,0.1); border-radius: 3px; border: 1px solid rgba(255,255,255,0.15);\">\n            <div style=\"color: #ffffff; font-weight: bold; margin-bottom: 5px;\">${idx + 1}. ${mesh.name || \"unnamed\"}</div>\n            <div style=\"font-size: 12px; color: #d0d0d0; line-height: 1.6;\">\n              Visible: <span style=\"color: ${mesh.visible ? \"#4CAF50\" : \"#f44336\"}; font-weight: bold;\">${mesh.visible}</span> | \n              Material: <span style=\"color: #FFD700;\">${mesh.materialType}</span> | \n              Color: <span style=\"color: ${mesh.materialColor ? \"#\" + mesh.materialColor.toString(16).padStart(6, \"0\") : \"#999\"}; font-weight: bold;\">${mesh.materialColor ? \"#\" + mesh.materialColor.toString(16).padStart(6, \"0\").toUpperCase() : \"N/A\"}</span>\n            </div>\n            <div style=\"margin-top: 8px;\">\n              <button class=\"mesh-toggle\" data-name=\"${mesh.name}\" style=\"padding: 4px 10px; margin-right: 5px; cursor: pointer; font-size: 11px; background: ${mesh.visible ? \"#f44336\" : \"#4CAF50\"}; color: white; border: none; border-radius: 3px; font-weight: bold;\">\n                ${mesh.visible ? \"Hide\" : \"Show\"}\n              </button>\n              <button class=\"mesh-color\" data-name=\"${mesh.name}\" style=\"padding: 4px 10px; margin-right: 5px; cursor: pointer; font-size: 11px; background: #f44336; color: white; border: none; border-radius: 3px; font-weight: bold;\">\n                Set Red\n              </button>\n              <button class=\"mesh-color-green\" data-name=\"${mesh.name}\" style=\"padding: 4px 10px; cursor: pointer; font-size: 11px; background: #4CAF50; color: white; border: none; border-radius: 3px; font-weight: bold;\">\n                Set Green\n              </button>\n            </div>\n          </div>\n        `\n          )\n          .join(\"\")}\n      </div>\n    </div>\n  `;\n\n  // Restore scroll positions after DOM update\n  if (containerScrollTop > 0) {\n    hudContainer.scrollTop = containerScrollTop;\n  }\n\n  // Restore mesh list scroll position\n  const newMeshListScrollable = hudContainer.querySelector('[style*=\"overflow-y\"]') as HTMLElement;\n  if (newMeshListScrollable && meshListScrollTop > 0) {\n    newMeshListScrollable.scrollTop = meshListScrollTop;\n  }\n\n  // Attach event listeners\n  attachEventListeners();\n}\n\nfunction attachEventListeners(): void {\n  if (!hudContainer) return;\n\n  // Quick controls\n  const showAllBtn = hudContainer.querySelector(\"#pill-vis-all\");\n  const hideAllBtn = hudContainer.querySelector(\"#pill-hide-all\");\n  const resetColorsBtn = hudContainer.querySelector(\"#pill-reset-colors\");\n\n  showAllBtn?.addEventListener(\"click\", (e) => {\n    e.stopPropagation();\n    setUserInteracting(true);\n    setPillVisibility(true);\n    setTimeout(() => {\n      updateHUD();\n      setUserInteracting(false);\n    }, 100);\n  });\n\n  hideAllBtn?.addEventListener(\"click\", (e) => {\n    e.stopPropagation();\n    setUserInteracting(true);\n    setPillVisibility(false);\n    setTimeout(() => {\n      updateHUD();\n      setUserInteracting(false);\n    }, 100);\n  });\n\n  resetColorsBtn?.addEventListener(\"click\", (e) => {\n    e.stopPropagation();\n    setUserInteracting(true);\n    resetPillMaterials();\n    setTimeout(() => {\n      updateHUD();\n      setUserInteracting(false);\n    }, 100);\n  });\n\n  // Shell controls\n  const shellShowBtn = hudContainer.querySelector(\"#pill-shell-show\");\n  const shellHideBtn = hudContainer.querySelector(\"#pill-shell-hide\");\n  const shellRedBtn = hudContainer.querySelector(\"#pill-shell-red\");\n  const shellGreenBtn = hudContainer.querySelector(\"#pill-shell-green\");\n\n  shellShowBtn?.addEventListener(\"click\", (e) => {\n    e.stopPropagation();\n    setUserInteracting(true);\n    setPillMeshVisibility(\"shell\", true);\n    setTimeout(() => {\n      updateHUD();\n      setUserInteracting(false);\n    }, 100);\n  });\n\n  shellHideBtn?.addEventListener(\"click\", (e) => {\n    e.stopPropagation();\n    setUserInteracting(true);\n    setPillMeshVisibility(\"shell\", false);\n    setTimeout(() => {\n      updateHUD();\n      setUserInteracting(false);\n    }, 100);\n  });\n\n  shellRedBtn?.addEventListener(\"click\", (e) => {\n    e.stopPropagation();\n    setUserInteracting(true);\n    setPillMeshMaterialColor(\"shell\", 0xff0000);\n    setTimeout(() => {\n      updateHUD();\n      setUserInteracting(false);\n    }, 100);\n  });\n\n  shellGreenBtn?.addEventListener(\"click\", (e) => {\n    e.stopPropagation();\n    setUserInteracting(true);\n    setPillMeshMaterialColor(\"shell\", 0x00ff00);\n    setTimeout(() => {\n      updateHUD();\n      setUserInteracting(false);\n    }, 100);\n  });\n\n  // Inlay controls\n  const inlayShowBtn = hudContainer.querySelector(\"#pill-inlay-show\");\n  const inlayHideBtn = hudContainer.querySelector(\"#pill-inlay-hide\");\n  const inlayOrangeBtn = hudContainer.querySelector(\"#pill-inlay-orange\");\n\n  inlayShowBtn?.addEventListener(\"click\", (e) => {\n    e.stopPropagation();\n    setUserInteracting(true);\n    setPillMeshVisibility(\"inlay\", true);\n    setTimeout(() => {\n      updateHUD();\n      setUserInteracting(false);\n    }, 100);\n  });\n\n  inlayHideBtn?.addEventListener(\"click\", (e) => {\n    e.stopPropagation();\n    setUserInteracting(true);\n    setPillMeshVisibility(\"inlay\", false);\n    setTimeout(() => {\n      updateHUD();\n      setUserInteracting(false);\n    }, 100);\n  });\n\n  inlayOrangeBtn?.addEventListener(\"click\", (e) => {\n    e.stopPropagation();\n    setUserInteracting(true);\n    setPillMeshMaterialColor(\"inlay\", 0xff8800);\n    setTimeout(() => {\n      updateHUD();\n      setUserInteracting(false);\n    }, 100);\n  });\n\n  // Global color picker\n  const colorPicker = hudContainer.querySelector(\"#pill-color-picker\") as HTMLInputElement;\n  const applyColorBtn = hudContainer.querySelector(\"#pill-apply-color\");\n\n  applyColorBtn?.addEventListener(\"click\", (e) => {\n    e.stopPropagation();\n    if (colorPicker) {\n      setUserInteracting(true);\n      const color = parseInt(colorPicker.value.replace(\"#\", \"\"), 16);\n      setPillMaterialColor(color);\n      setTimeout(() => {\n        updateHUD();\n        setUserInteracting(false);\n      }, 100);\n    }\n  });\n\n  // Individual mesh controls\n  const meshToggleBtns = hudContainer.querySelectorAll(\".mesh-toggle\");\n  meshToggleBtns.forEach((btn) => {\n    btn.addEventListener(\"click\", (e) => {\n      e.stopPropagation();\n      const target = e.target as HTMLElement;\n      const name = target.getAttribute(\"data-name\");\n      if (name) {\n        setUserInteracting(true);\n        const info = getPillDebugInfo();\n        const mesh = info.meshes.find((m) => m.name === name);\n        if (mesh) {\n          setPillMeshVisibility(name, !mesh.visible);\n          setTimeout(() => {\n            updateHUD();\n            setUserInteracting(false);\n          }, 100);\n        }\n      }\n    });\n  });\n\n  const meshColorBtns = hudContainer.querySelectorAll(\".mesh-color\");\n  meshColorBtns.forEach((btn) => {\n    btn.addEventListener(\"click\", (e) => {\n      e.stopPropagation();\n      const target = e.target as HTMLElement;\n      const name = target.getAttribute(\"data-name\");\n      if (name) {\n        setUserInteracting(true);\n        setPillMeshMaterialColor(name, 0xff0000);\n        setTimeout(() => {\n          updateHUD();\n          setUserInteracting(false);\n        }, 100);\n      }\n    });\n  });\n\n  const meshColorGreenBtns = hudContainer.querySelectorAll(\".mesh-color-green\");\n  meshColorGreenBtns.forEach((btn) => {\n    btn.addEventListener(\"click\", (e) => {\n      e.stopPropagation();\n      const target = e.target as HTMLElement;\n      const name = target.getAttribute(\"data-name\");\n      if (name) {\n        setUserInteracting(true);\n        setPillMeshMaterialColor(name, 0x00ff00);\n        setTimeout(() => {\n          updateHUD();\n          setUserInteracting(false);\n        }, 100);\n      }\n    });\n  });\n\n  // Prevent scroll jumping when scrolling in mesh list area\n  const scrollableArea = hudContainer.querySelector('[style*=\"overflow-y\"]') as HTMLElement;\n  if (scrollableArea) {\n    let scrollTimeout: number | null = null;\n    scrollableArea.addEventListener(\"scroll\", () => {\n      setUserInteracting(true);\n      if (scrollTimeout) {\n        clearTimeout(scrollTimeout);\n      }\n      scrollTimeout = window.setTimeout(() => {\n        setUserInteracting(false);\n      }, 1000);\n    });\n\n    // Prevent clicks from causing scroll jumps\n    scrollableArea.addEventListener(\"click\", (e) => {\n      e.stopPropagation();\n    });\n  }\n}\n\n// Auto-refresh HUD periodically\nlet refreshInterval: number | null = null;\nlet isUserInteracting = false;\n\nexport function startHUDRefresh(intervalMs: number = 1000): void {\n  if (refreshInterval) {\n    clearInterval(refreshInterval);\n  }\n  refreshInterval = window.setInterval(() => {\n    if (isVisible && hudContainer && !isUserInteracting) {\n      updateHUD();\n    }\n  }, intervalMs);\n}\n\nexport function setUserInteracting(value: boolean): void {\n  isUserInteracting = value;\n}\n\nexport function stopHUDRefresh(): void {\n  if (refreshInterval) {\n    clearInterval(refreshInterval);\n    refreshInterval = null;\n  }\n}\n\n","import {\n  startRenderLoop,\n  initRenderer,\n  setupLighting,\n  scene,\n} from \"./core/scene\";\nimport {\n  setupHomeLoopScrollHandler,\n  startHomeLoop,\n} from \"./animation/home-loop\";\nimport { initPovScrollAnimation } from \"./animation/pov-scroll\";\nimport { loadModel } from \"./core/objects\";\nimport { setupCamera } from \"./core/camera\";\nimport { initIntroScrollAnimation } from \"./animation/intro-scroll\";\nimport { initOutroScrollAnimation } from \"./animation/outro-scroll\";\nimport { initializeObjectStates } from \"./animation/object-state\";\nimport { createPillDebugHUD, startHUDRefresh } from \"./core/debug-hud\";\n\nfunction initSkipButton() {\n  const skipButton = document.querySelector(\".wr_p--skip.wr_p\");\n  if (skipButton) {\n    const finalSection = document.querySelector(\".sc--testimonials\");\n    if (finalSection) {\n      skipButton.addEventListener(\"click\", () => {\n        finalSection.scrollIntoView({\n          behavior: \"smooth\",\n          block: \"start\",\n          inline: \"nearest\",\n        });\n      });\n    }\n  }\n}\n\nasync function main() {\n  initRenderer();\n  setupLighting();\n  setupCamera();\n  await loadModel(scene);\n\n  initializeObjectStates();\n\n  setupHomeLoopScrollHandler();\n  if (window.scrollY === 0) {\n    startHomeLoop();\n  }\n\n  initPovScrollAnimation();\n  initIntroScrollAnimation();\n  initOutroScrollAnimation();\n  initSkipButton();\n  \n  // Debug HUD for pill\n  createPillDebugHUD();\n  startHUDRefresh(500);\n  \n  startRenderLoop();\n}\n\nmain();\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","THREE","isMobile","window","innerWidth","SCROLL_SELECTORS","FIND_CLOSEST_SAMPLES","SCRUB_DURATION","POV_SEQUENCE_PHASE_END","OPACITY_VISIBILITY_THRESHOLD","KEYFRAME_SCALE","KEYFRAME_DURATION","clamp","value","min","max","Math","SELECTORS","DOM_ELEMENTS","mazeContainer","document","querySelector","canvas","homeSection","introSection","povSection","finalSection","finalContainer","parentElements","querySelectorAll","X","Z","getCoord","x","z","objectHomeScrollEndPathPoint","cameraPathPointsConfig","startMobile","startDesktop","secondMobile","secondDesktop","mobileLookAt","desktopLookAt","cameraLookAtSecondDesktop","cameraLookAtSecondMobile","cameraHomeScrollEndLookAt","thirdPosition","cameraHomeScrollEndPathPoint","startPosition","secondPosition","lookAtPosition","cameraLookAtSecondPosition","pacmanHomePathPoints","pos","type","arc","curveCheckPoints","ghost1HomePathPoints","ghost2HomePathPoints","ghost3HomePathPoints","ghost4HomePathPoints","ghost5HomePathPoints","cameraHomeScrollPathPoints","lookAt","cameraPOVPathPoints","lookAtSequence","ghost1POVPathPoints","ghost2POVPathPoints","ghost3POVPathPoints","ghost4POVPathPoints","ghost5POVPathPoints","povTriggerPositions","ghost1","triggerPos","ghostStartFadeIn","ghostEndFadeIn","ghostStartFadeOut","camStartFadeIn","camEndFadeIn","camStartFadeOut","endPosition","forceEndProgress","start","end","ghost2","ghost3","ghost4","ghost5","getStartPosition","getLookAtPosition","homePaths","pacman","camera","getCameraHomeScrollPathPoints","innerHeight","scene","renderer","antialias","alpha","powerPreference","precision","clock","frameCallbacks","setPixelRatio","pixelRatio","devicePixelRatio","setSize","clientWidth","clientHeight","aspect","updateProjectionMatrix","ScrollTrigger","mazeTexture","load","mazeMaterial","matcap","topMaterial","color","metalness","roughness","envMapIntensity","ghostMaterial","opacity","transparent","depthWrite","depthTest","blending","side","transmission","floorMaterial","pacmanMaterials","blue","white","default","pillMaterials","shell","materialMap","CAM_Pacman_Backframe","CAM_Pacman_Logo_1","CAM_Pacman_Logo_2","pillMaterialMap","loader","pacmanMixer","pill","visible","ghostContainers","Ghost_EUR","Ghost_CHF","Ghost_YEN","Ghost_USD","Ghost_GBP","pathCache","Map","TangentSmoother","constructor","initialTangent","smoothing","this","currentTangent","clone","update","targetTangent","lerp","normalize","reset","newTangent","copy","getCurrentTangent","setSmoothingFactor","createMazePath","pathPoints","cacheKey","map","p","y","join","has","path","i","length","current","next","catmullPoints","add","midPoint","createNormalCurveMidPoint","set","curveType","createCameraHomeScrollPath","curve","getHomePaths","paths","entries","forEach","getPovPaths","gsap","CURRENCY_SYMBOLS","isCurrencySymbol","name","some","symbol","includes","isPacmanPart","calculateObjectOrientation","object","tangent","objectType","targetRotation","atan2","rotation","PI","lookAtPoint","position","baseLayDownQuat","setFromEuler","LAY_DOWN_QUAT_1","setFromAxisAngle","multiply","LAY_DOWN_QUAT_2","startQuat","progress","targetQuat","angleTo","quaternion","slerp","quat","rotations","result","axis","angle","axisVector","rotateQuaternionAroundAxis","setObjectOpacity","options","preserveTransmission","forEachMaterial","mat","setMaterialOpacity","skipCurrencySymbols","material","currentOpacity","currentTransparent","abs","shouldBeTransparent","undefined","needsUpdate","getObjectOpacity","found","callback","skipPacmanParts","objectKey","traverse","child","isMesh","mesh","childName","Array","isArray","setFloorPlane","setHex","setObjectScale","sceneType","scale","updateMatrixWorld","applyPovScrollPreset","isEntering","scrollDirection","applyOutroScrollPreset","lastScrollY","scrollY","getScrollDirection","currentScrollY","direction","homeLoopState","t","animationTime","currentObjectStates","homeLoopStartPositions","homeLoopStartRotations","homeLoopStartT","isHomeLoopActive","setHomeLoopActive","active","getCurrentRotations","state","updateObjectPosition","force","preserveHomeLoopStart","updateObjectRotation","getHomeLoopStartRotations","reduce","acc","rot","homeScrollTimeline","startPositions","initHomeScrollAnimation","kill","cameraPathPoints","cameraPath","cameraCurve","handleScrollEnter","requestAnimationFrame","introScrollTrigger","isActive","homeLoopStartPos","homeLoopStartRot","currentPositions","positions","getCurrentPositions","rotationsToUse","keys","pausedPositions","setMaterialTransparent","createObjectAnimations","scrollTrigger","id","trigger","scrub","markers","refreshPriority","invalidateOnRefresh","onEnter","onEnterBack","onUpdate","self","curves","clampedProgress","cameraPoint","getPointAt","lookAtPoints","point","push","getPoint","fov","onLeave","resume","onLeaveBack","allObjects","clear","killObjectAnimations","homeScrollPaths","scrollPathPoints","scrollPaths","pausedPos","arcPoint","createHomeScrollPathPoints","createHomeScrollPath","getHomeScrollPaths","animPropsArray","animationData","currentMaterialOpacity","clonedMat","index","indexOf","clonedMaterials","startRot","startEuler","setFromQuaternion","endEuler","animProps","rotX","rotY","rotZ","data","duration","startPathPoint","fromTo","ease","immediateRender","pathPoint","homeLoopFrameRegistered","rotationTransitionTime","startRotations","hasBeenPausedBefore","homeLoopTangentSmoothers","pillGuides","startHomeLoop","savedT","resetGhostMaterialsToFullOpacity","initialVector","initializeHomeLoopTangentSmoothers","ghost","savedRotation","getTangentAt","pillPos","console","log","children","remove","axesHelper","sphereGeometry","sphereMaterial","wireframe","sphere","boxGeometry","boxMaterial","linewidth","boxEdges","boxWireframe","xLineGeometry","setFromPoints","xLine","yLineGeometry","yLine","zLineGeometry","zLine","createPillPositionGuides","lastTime","getElapsedTime","hidden","currentTime","delta","clampedDelta","updateHomeLoopT","transitionProgress","isTransitioning","objectT","rawTangent","smoothTangent","tempObject","easedProgress","updateHomeLoop","domElementCache","povScrollTimeline","previousCameraPosition","rotationStarted","startedInitEndScreen","startRotationPoint","endRotationPoint","cachedStartYAngle","ghostStates","povTangentSmoothers","initPovScrollAnimation","initializePovTangentSmoothers","hasBeenTriggered","triggerCameraProgress","ghostStartFadeInProgress","ghostEndFadeInProgress","ghostStartFadeOutProgress","camStartFadeInProgress","camEndFadeInProgress","camStartFadeOutProgress","endCameraProgress","currentPathT","toggleActions","addLabel","to","onStart","handleAnimationStart","handleAnimationUpdate","onReverseComplete","handleLeavePOV","resetState","onComplete","povPaths","initialCameraTangent","overallProgress","targets","cameraPosition","customLookAt","firstPoint","sequenceProgress","sequenceLength","segmentSize","currentSegment","floor","segmentProgress","fromIndex","toIndex","fromTarget","toTarget","finalSequenceLookAt","constrainedTangent","defaultLookAt","getCustomLookAtForProgress","startRotationProgress","findClosestProgressOnPath","endRotationProgress","handleDefaultOrientation","updateCamera","triggerData","ghostIndex","parseInt","replace","cached","parent","povElements","camElements","currentCameraProgress","ghostProgress","style","classList","hideTextElements","targetGhostOpacity","targetCamOpacity","fadeProgress","fadeOutProgress","calculateTextOpacities","toString","isPassed","hasNoVisibility","contains","updateTextElementVisibility","updateTextVisibility","updateGhost","updateGhosts","elements","targetOpacity","element","el","resetTangentSmoothers","resetVector","targetPoint","samples","closestProgress","closestDistance","Infinity","pointOnPath","distance","distanceTo","error","introScrollTimeline","isIntroScrollActive","lastUpdateProgress","cachedCameraPosition","lastCameraUpdateFrame","introGridGuides","resetIntroScrollCache","setIntroScrollLocked","locked","values","userData","introScrollLocked","restoreFloor","floorState","lastFloorState","createIntroGridGuides","gridGroup","gridHelper","planeGeometry","planeMaterial","plane","gridSize","xLineMaterial","renderOrder","yLineMaterial","zLineMaterial","label","box","labelText","removeIntroGridGuides","tempVector","outroScrollTimeline","getPillDebugInfo","meshes","pillVisible","materialColor","materialType","getHex","parentVisible","effectiveVisible","totalChildren","setPillVisibility","setPillMeshVisibility","namePattern","toLowerCase","setPillMeshMaterialColor","m","hudContainer","isVisible","updateHUD","containerScrollTop","scrollTop","meshListScrollable","meshListScrollTop","info","innerHTML","idx","padStart","toUpperCase","newMeshListScrollable","showAllBtn","hideAllBtn","resetColorsBtn","addEventListener","e","stopPropagation","setUserInteracting","setTimeout","shellShowBtn","shellHideBtn","shellRedBtn","shellGreenBtn","inlayShowBtn","inlayHideBtn","inlayOrangeBtn","colorPicker","applyColorBtn","btn","target","getAttribute","find","scrollableArea","scrollTimeout","clearTimeout","attachEventListeners","refreshInterval","isUserInteracting","async","shadowMap","enabled","appendChild","domElement","body","render","ambientLight","directionalLight","shadow","mapSize","width","height","left","right","top","bottom","near","far","bias","radius","castShadow","setupLighting","setupCamera","Promise","resolve","reject","gltf","model","allObjectNames","node","subChild","item","pacmanActions","animations","clip","action","clipAction","getMixer","getRoot","skipAnimation","updateMorphTargets","setEffectiveWeight","play","ghostContainer","ghostGroup","startsWith","pillGroup","clonedMesh","subChildName","receiveShadow","clonedChild","loadModel","initialOpacity","startColor","endColor","fontSize","fontWeight","indent","currentFrame","performance","now","camX","camY","camZ","isFinite","pacmanObj","tempObj","ghostObj","initializeQuaternions","getDelta","pacmanQuat","ghostQuat","walkStart","walkEnd","objectsToAnimate","behindOffset","zOffset","xOffset","yOffset","zPhase","normalizedProgress","baseX","pacmanX","pacmanY","pacmanZ","baseGhostOpacity","staticYOffset","zBounce","sin","finalX","finalY","finalZ","updateObjectsWalkBy","keyframes","skipButton","scrollIntoView","behavior","block","inline","initSkipButton","createElement","cssText","toggleBtn","textContent","preventDefault","display","createPillDebugHUD","intervalMs","clearInterval","setInterval","startHUDRefresh","startRenderLoop","main"],"sourceRoot":""}