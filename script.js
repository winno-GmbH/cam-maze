(()=>{"use strict";var e,t,r={352:e=>{e.exports=gsap},774:e=>{e.exports=ScrollTrigger}},o={};function c(e){var t=o[e];if(void 0!==t)return t.exports;var s=o[e]={exports:{}};return r[e](s,s.exports,c),s.exports}t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,c.t=function(r,o){if(1&o&&(r=this(r)),8&o)return r;if("object"==typeof r&&r){if(4&o&&r.__esModule)return r;if(16&o&&"function"==typeof r.then)return r}var s=Object.create(null);c.r(s);var n={};e=e||[null,t({}),t([]),t(t)];for(var p=2&o&&r;"object"==typeof p&&!~e.indexOf(p);p=t(p))Object.getOwnPropertyNames(p).forEach((e=>n[e]=()=>r[e]));return n.default=()=>r,c.d(s,n),s},c.d=(e,t)=>{for(var r in t)c.o(t,r)&&!c.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};const s=THREE,n=window.innerWidth<768,p=(new s.Vector3(.55675,.45,.45175),new s.Vector3(.65725,.55,.75325),new s.Vector3(.9085,.55,.8035),new s.Vector3(.75775,.55,1.05475),new s.Vector3(.65725,.55,1.0045),new s.Vector3(.15475,.55,1.15525),{startMobile:new s.Vector3(.5,2.5,2.5),startDesktop:new s.Vector3(-2,2.5,2),secondMobile:new s.Vector3(.5,2.5,2),secondDesktop:new s.Vector3(-1.5,3,2),mobileLookAt:new s.Vector3(.5,.5,-1.5),desktopLookAt:new s.Vector3(-1.25,.5,.25)}),i=n?p.startMobile:p.startDesktop,a=n?p.secondMobile:p.secondDesktop,u=n?p.mobileLookAt:p.desktopLookAt,y={mazeContainer:document.querySelector(".el--home-maze.el"),canvas:document.querySelector("canvas"),finalSection:document.querySelector(".sc--final.sc"),finalContainer:document.querySelector(".cr--final.cr"),parentElements:document.querySelectorAll(".cmp--pov.cmp")},l=new s.Scene,w=new s.WebGLRenderer({antialias:!0,alpha:!0,powerPreference:"high-performance",precision:"highp"});function h(){const e=Math.min(window.devicePixelRatio,n?2:3);w.setPixelRatio(e),y.mazeContainer?w.setSize(y.mazeContainer.clientWidth,y.mazeContainer.clientHeight):w.setSize(window.innerWidth,window.innerHeight)}new s.Clock;const v=new s.PerspectiveCamera(50,window.innerWidth/window.innerHeight,.001,1e3);v.quaternion.clone(),(new s.Quaternion).setFromEuler(new s.Euler(-1.5708,0,0));const m=(new s.TextureLoader).load("https://c-am.b-cdn.net/CAM/matcap24.png"),g=new s.MeshMatcapMaterial({matcap:m}),V=new s.MeshStandardMaterial({color:15923705,metalness:.4,roughness:0,envMapIntensity:10}),d=new s.MeshPhysicalMaterial({color:16777215,opacity:1,transparent:!0,depthWrite:!1,depthTest:!0,blending:s.NormalBlending,side:s.DoubleSide,roughness:.75,metalness:.2,transmission:.5}),A=new s.MeshStandardMaterial({color:16777215,opacity:.8,transparent:!0,roughness:.5,metalness:.1}),T={blue:new s.MeshBasicMaterial({color:1337811,transparent:!0,opacity:1}),white:new s.MeshBasicMaterial({color:16777215,transparent:!0,opacity:1}),default:new s.MeshBasicMaterial({color:1337811,transparent:!0,opacity:1})},P={CAM_Pacman_Backframe:T.blue,"CAM-Pacman_Bitcoin_1":T.white,"CAM-Pacman_Bitcoin_2":T.white,"CAM-Pacman_Bottom":T.blue,"CAM-Pacman_Top":T.blue,"CAM-Pacman_Eye":T.white,CAM_Pacman_Logo_1:T.white,CAM_Pacman_Logo_2:T.white,"CAM-Pacman_Shell_Boolean":T.blue,"CAM-Pacman_Shell":T.blue,"CAM-Pacman_Bottom_electronic":T.white,"CAM-Pacman_Top_electronic":T.white,"CAM-Pacman_Bottom_Text":T.white,"CAM-Pacman_Top_Text":T.white,default:T.blue},f=(Array(5).fill(d),new s.GLTFLoader);let M;const S=new s.Group;l.add(S);const O={pacman:S,ghost1:new s.Mesh(new s.BufferGeometry,d),ghost2:new s.Mesh(new s.BufferGeometry,d),ghost3:new s.Mesh(new s.BufferGeometry,d),ghost4:new s.Mesh(new s.BufferGeometry,d),ghost5:new s.Mesh(new s.BufferGeometry,d)},b={Ghost_EUR:O.ghost1,Ghost_CHF:O.ghost2,Ghost_YEN:O.ghost3,Ghost_USD:O.ghost4,Ghost_GBP:O.ghost5};Object.values(O).forEach((e=>l.add(e)));const C=[{pos:new s.Vector3(.25525,.55,.6025),type:"straight"},{pos:new s.Vector3(.25525,.55,.301),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.35575,.55,.2005),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.45625,.55,.1),type:"straight"},{pos:new s.Vector3(.45625,.55,-.101),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.35575,.55,-.2015),type:"straight"},{pos:new s.Vector3(.15475,.55,-.2015),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.05425,.55,-.101),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.04625,.55,-5e-4),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(-.14675,.55,-.101),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.24725,.55,-.2015),type:"straight"},{pos:new s.Vector3(-.34775,.55,-.2015),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(-.44825,.55,-.101),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.398,.55,-5e-4),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(-.34775,.55,.1),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.24725,.55,.2005),type:"straight"},{pos:new s.Vector3(-.04625,.55,.2005),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.05425,.55,.301),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.04625,.55,.4015),type:"straight"},{pos:new s.Vector3(-.14675,.55,.4015),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(-.24725,.55,.502),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.14675,.55,.6025),type:"straight"},{pos:new s.Vector3(-.04625,.55,.6025),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.05425,.55,.703),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.04625,.55,.8035),type:"straight"},{pos:new s.Vector3(-.24725,.55,.8035),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(-.34775,.55,.904),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.398,.55,1.0045),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(-.44825,.55,1.105),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.34775,.55,1.2055),type:"straight"},{pos:new s.Vector3(-.24725,.55,1.2055),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(-.14675,.55,1.105),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.04625,.55,1.0045),type:"straight"},{pos:new s.Vector3(.05425,.55,1.0045),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.15475,.55,1.105),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.05425,.55,1.2055),type:"straight"},{pos:new s.Vector3(-.04625,.55,1.2055),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(-.14675,.55,1.105),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.04625,.55,1.0045),type:"straight"},{pos:new s.Vector3(.65725,.55,1.0045),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.75775,.55,.904),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.7075,.55,.8035),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.65725,.55,.75325),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.55675,.55,.703),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.45625,.55,.75325),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.35575,.55,.8035),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.25525,.55,.703),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.25525,.55,.6025),type:"straight"}],E=[{pos:new s.Vector3(-.44825,.55,.502),type:"straight"},{pos:new s.Vector3(-.44825,.55,.301),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.34775,.55,.2005),type:"straight"},{pos:new s.Vector3(-.24725,.55,.2005),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(-.14675,.55,.1),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.04625,.55,-5e-4),type:"straight"},{pos:new s.Vector3(.35575,.55,-5e-4),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.45625,.55,.1),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.35575,.55,.2005),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.25525,.55,.301),type:"straight"},{pos:new s.Vector3(.25525,.55,.703),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.35575,.55,.8035),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.45625,.55,.75325),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.55675,.55,.703),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.65725,.55,.75325),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.75775,.55,.8035),type:"straight"},{pos:new s.Vector3(.95875,.55,.8035),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(1.05925,.55,.75325),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(1.15975,.55,.703),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(1.26025,.55,.75325),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(1.36075,.55,.8035),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(1.46125,.55,.703),type:"straight"},{pos:new s.Vector3(1.46125,.55,.301),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(1.36075,.55,.2005),type:"straight"},{pos:new s.Vector3(.35575,.55,.2005),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.25525,.55,.301),type:"straight"},{pos:new s.Vector3(.25525,.55,.502),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.15475,.55,.6025),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.05425,.55,.703),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.004,.55,.8035),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(-.04625,.55,.904),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.05425,.55,1.0045),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.15475,.55,1.105),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.05425,.55,1.2055),type:"straight"},{pos:new s.Vector3(-.04625,.55,1.2055),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(-.14675,.55,1.105),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.0965,.55,1.0045),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(-.04625,.55,.904),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.14675,.55,.8035),type:"straight"},{pos:new s.Vector3(-.34775,.55,.8035),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(-.44825,.55,.703),type:"straight"},{pos:new s.Vector3(-.44825,.55,.502),type:"straight"}],x=[{pos:new s.Vector3(-.04625,.55,.904),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.004,.55,.8035),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.05425,.55,.703),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.04625,.55,.6025),type:"straight"},{pos:new s.Vector3(-.14675,.55,.6025),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(-.24725,.55,.502),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.14675,.55,.4015),type:"straight"},{pos:new s.Vector3(.15475,.55,.4015),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.25525,.55,.502),type:"straight"},{pos:new s.Vector3(.25525,.55,.703),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.3055,.55,.8035),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.35575,.55,.904),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.45625,.55,1.0045),type:"straight"},{pos:new s.Vector3(.65725,.55,1.0045),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.75775,.55,1.105),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.85825,.55,1.2055),type:"straight"},{pos:new s.Vector3(1.36075,.55,1.2055),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(1.46125,.55,1.105),type:"straight"},{pos:new s.Vector3(1.46125,.55,.1),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(1.36075,.55,-5e-4),type:"straight"},{pos:new s.Vector3(1.15975,.55,-5e-4),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(1.05925,.55,.1),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.95875,.55,.2005),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.85825,.55,.1),type:"straight"},{pos:new s.Vector3(.85825,.55,-.101),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.75775,.55,-.2015),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.65725,.55,-.15125),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.55675,.55,-.101),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.45625,.55,-5e-4),type:"straight"},{pos:new s.Vector3(.45625,.55,.1),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.35575,.55,.2005),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.25525,.55,.301),type:"straight"},{pos:new s.Vector3(.25525,.55,.703),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.3055,.55,.8035),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.35575,.55,.904),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.25525,.55,1.0045),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.15475,.55,1.105),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.05425,.55,1.2055),type:"straight"},{pos:new s.Vector3(-.04625,.55,1.2055),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(-.14675,.55,1.105),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.0965,.55,1.0045),type:"curve",curveType:"lowerArc"}],_=[{pos:new s.Vector3(.808,.55,.8035),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.85825,.55,.703),type:"straight"},{pos:new s.Vector3(.85825,.55,-.101),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.75775,.55,-.2015),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.65725,.55,-.15125),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.55675,.55,-.101),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.45625,.55,-.15125),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.35575,.55,-.2015),type:"straight"},{pos:new s.Vector3(.15475,.55,-.2015),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.05425,.55,-.101),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.15475,.55,-5e-4),type:"straight"},{pos:new s.Vector3(.35575,.55,-5e-4),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.45625,.55,.1),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.55675,.55,.2005),type:"straight"},{pos:new s.Vector3(1.36075,.55,.2005),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(1.46125,.55,.301),type:"straight"},{pos:new s.Vector3(1.46125,.55,.703),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(1.36075,.55,.8035),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(1.26025,.55,.75325),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(1.15975,.55,.703),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(1.05925,.55,.75325),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(1.009,.55,.8035),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.95875,.55,.904),type:"straight"},{pos:new s.Vector3(.95875,.55,1.105),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.85825,.55,1.2055),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.75775,.55,1.105),type:"straight"},{pos:new s.Vector3(.75775,.55,.904),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.7075,.55,.8035),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.65725,.55,.75325),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.55675,.55,.703),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.45625,.55,.75325),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.35575,.55,.8035),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.25525,.55,.703),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.15475,.55,.6025),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.05425,.55,.703),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.004,.55,.8035),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(-.04625,.55,.904),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.05425,.55,1.0045),type:"straight"},{pos:new s.Vector3(.65725,.55,1.0045),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.75775,.55,.904),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.808,.55,.8035),type:"curve",curveType:"upperArc"}],z=[{pos:new s.Vector3(1.05925,.55,.4015),type:"straight"},{pos:new s.Vector3(1.05925,.55,.703),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.95875,.55,.8035),type:"straight"},{pos:new s.Vector3(.85825,.55,.8035),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.75775,.55,.904),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.65725,.55,1.0045),type:"straight"},{pos:new s.Vector3(.25525,.55,1.0045),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.15475,.55,1.105),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.05425,.55,1.2055),type:"straight"},{pos:new s.Vector3(-.34775,.55,1.2055),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(-.44825,.55,1.105),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.398,.55,1.0045),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(-.34775,.55,.904),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.398,.55,.8035),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(-.44825,.55,.703),type:"straight"},{pos:new s.Vector3(-.44825,.55,.301),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.34775,.55,.2005),type:"straight"},{pos:new s.Vector3(-.04625,.55,.2005),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.05425,.55,.301),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.15475,.55,.4015),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.25525,.55,.301),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.35575,.55,.2005),type:"straight"},{pos:new s.Vector3(.75775,.55,.2005),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.85825,.55,.1),type:"straight"},{pos:new s.Vector3(.85825,.55,-.101),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.95875,.55,-.2015),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(1.05925,.55,-.101),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(1.15975,.55,5e-4),type:"straight"},{pos:new s.Vector3(1.36075,.55,5e-4),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(1.46125,.55,-.101),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(1.36075,.55,-.2015),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(1.26025,.55,-.101),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(1.36075,.55,5e-4),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(1.46125,.55,.1),type:"straight"},{pos:new s.Vector3(1.46125,.55,.703),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(1.36075,.55,.8035),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(1.26025,.55,.75325),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(1.15975,.55,.703),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(1.05925,.55,.6025),type:"straight"},{pos:new s.Vector3(1.05925,.55,.4015),type:"straight"}],H=[{pos:new s.Vector3(.45625,.55,-.04975),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.35575,.55,5e-4),type:"straight"},{pos:new s.Vector3(-.04625,.55,5e-4),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(-.14675,.55,-.101),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.24725,.55,-.2015),type:"straight"},{pos:new s.Vector3(-.34775,.55,-.2015),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(-.44825,.55,-.101),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.398,.55,5e-4),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(-.34775,.55,.1),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.24725,.55,.2005),type:"straight"},{pos:new s.Vector3(-.04625,.55,.2005),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.05425,.55,.301),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.04625,.55,.4015),type:"straight"},{pos:new s.Vector3(-.14675,.55,.4015),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(-.24725,.55,.502),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.14675,.55,.6025),type:"straight"},{pos:new s.Vector3(.15475,.55,.6025),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.25525,.55,.703),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.3055,.55,.8035),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.35575,.55,.904),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.45625,.55,1.0045),type:"straight"},{pos:new s.Vector3(.65725,.55,1.0045),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.75775,.55,.904),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.85825,.55,.8035),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.95875,.55,.904),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.95875,.55,1.105),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(1.05925,.55,1.2055),type:"straight"},{pos:new s.Vector3(1.36075,.55,1.2055),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(1.46125,.55,1.105),type:"straight"},{pos:new s.Vector3(1.46125,.55,-.101),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(1.36075,.55,-.2015),type:"straight"},{pos:new s.Vector3(1.15975,.55,-.2015),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(1.05925,.55,-.101),type:"straight"},{pos:new s.Vector3(1.05925,.55,.1),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.95875,.55,.2005),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.85825,.55,.1),type:"straight"},{pos:new s.Vector3(.85825,.55,-.101),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.75775,.55,-.2015),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.65725,.55,-.15125),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.55675,.55,-.101),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.45625,.55,-.04975),type:"curve",curveType:"lowerArc"}],L=[{pos:new s.Vector3(.55675,-.5,.45175),type:"curve",curveType:"forwardDownArc"},{pos:new s.Vector3(.55675,.55,.6025),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.607,.55,.703),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.65725,.55,.75325),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.7075,.55,.8035),type:"straight"},{pos:new s.Vector3(.9085,.55,.8035),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.95875,.55,.85375),type:"straight"},{pos:new s.Vector3(.95875,.55,1.15525),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.9085,.55,1.2055),type:"straight"},{pos:new s.Vector3(.808,.55,1.2055),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.75775,.55,1.15525),type:"straight"},{pos:new s.Vector3(.75775,.55,1.05475),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.7075,.55,1.0045),type:"straight"},{pos:new s.Vector3(.205,.55,1.0045),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.15475,.55,1.05475),type:"straight"},{pos:new s.Vector3(.15475,.55,1.15525),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.205,.55,1.2055),type:"straight"},{pos:new s.Vector3(.5065,.55,1.2055),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.55675,.55,1.306),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(-.44825,1,2.0095),type:"straight"}],I=[{pos:new s.Vector3(1.05925,.55,.703),type:"straight"},{pos:new s.Vector3(1.05925,.55,.75325),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(1.009,.55,.8035),type:"straight"},{pos:new s.Vector3(.9085,.55,.8035),type:"straight"}],R=[{pos:new s.Vector3(1.05925,.55,1.2055),type:"straight"},{pos:new s.Vector3(1.009,.55,1.2055),type:"curve",curveType:"lowerArc"},{pos:new s.Vector3(.95875,.55,1.15525),type:"straight"},{pos:new s.Vector3(.95875,.55,1.05475),type:"straight"}],B=[{pos:new s.Vector3(.35575,.55,.904),type:"straight"},{pos:new s.Vector3(.35575,.55,.95425),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.406,.55,1.0045),type:"straight"},{pos:new s.Vector3(.5065,.55,1.0045),type:"straight"}],k=[{pos:new s.Vector3(.15475,.55,1.105),type:"straight"},{pos:new s.Vector3(.15475,.55,1.05475),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.205,.55,1.0045),type:"straight"},{pos:new s.Vector3(.3055,.55,1.0045),type:"straight"}],G=[{pos:new s.Vector3(.55675,.55,1.306),type:"straight"},{pos:new s.Vector3(.55675,.55,1.25575),type:"curve",curveType:"upperArc"},{pos:new s.Vector3(.5065,.55,1.2055),type:"straight"},{pos:new s.Vector3(.406,.55,1.2055),type:"straight"}],N=(new s.CubicBezierCurve3(i,a,new s.Vector3(.55675,3,.45175),new s.Vector3(.55675,.5,.45175)),{pacmanHome:j(C),ghost1Home:j(E),ghost2Home:j(x),ghost3Home:j(_),ghost4Home:j(z),ghost5Home:j(H),cameraPOV:j(L),ghost1POV:j(I),ghost2POV:j(R),ghost3POV:j(B),ghost4POV:j(k),ghost5POV:j(G)});function j(e){const t=new s.CurvePath;for(let r=0;r<e.length-1;r++){const o=e[r],c=e[r+1];if("straight"===o.type){const e=new s.LineCurve3(o.pos,c.pos);t.add(e)}else if("curve"===o.type){let e;e="upperArc"===o.curveType?new s.Vector3(o.pos.x,o.pos.y,c.pos.z):"lowerArc"===o.curveType?new s.Vector3(c.pos.x,o.pos.y,o.pos.z):"forwardDownArc"===o.curveType?new s.Vector3(o.pos.x,c.pos.y,o.pos.z):new s.Vector3(o.pos.x,o.pos.y,c.pos.z);const r=new s.QuadraticBezierCurve3(o.pos,e,c.pos);t.add(r)}}return t}function q(e){return"home"===e?{pacman:N.pacmanHome,ghost1:N.ghost1Home,ghost2:N.ghost2Home,ghost3:N.ghost3Home,ghost4:N.ghost4Home,ghost5:N.ghost5Home}:"pov"===e?{pacman:N.cameraPOV,ghost1:N.ghost1POV,ghost2:N.ghost2POV,ghost3:N.ghost3POV,ghost4:N.ghost4POV,ghost5:N.ghost5POV}:{}}const F={mazeContainer:document.querySelector(".el--home-maze.el"),canvas:document.querySelector("canvas"),homeSection:document.querySelector(".sc--home.sc"),introSection:document.querySelector(".sc--intro.sc"),introHeader:document.querySelector(".sc_h--intro"),introBody:document.querySelector(".sc_b--intro"),povSection:document.querySelector(".sc--pov.sc"),finalSection:document.querySelector(".sc--final.sc"),finalContainer:document.querySelector(".cr--final.cr"),parentElements:document.querySelectorAll(".cmp--pov.cmp")},U={ghost1:{triggerPos:new s.Vector3(.65725,.55,.75325),ghostTextPos:new s.Vector3(.7075,.55,.8035),camTextPos:new s.Vector3(.75775,.55,.8035),endPosition:new s.Vector3(.85825,.55,.8035),parent:F.parentElements[0]||null,active:!1},ghost2:{triggerPos:new s.Vector3(.9085,.55,.8035),ghostTextPos:new s.Vector3(.95875,.55,.85375),camTextPos:new s.Vector3(.95875,.55,.904),endPosition:new s.Vector3(.95875,.55,1.0045),parent:F.parentElements[1]||null,active:!1},ghost3:{triggerPos:new s.Vector3(.75775,.55,1.05475),ghostTextPos:new s.Vector3(.7075,.55,1.0045),camTextPos:new s.Vector3(.65725,.55,1.0045),endPosition:new s.Vector3(.55675,.55,1.0045),parent:F.parentElements[2]||null,active:!1},ghost4:{triggerPos:new s.Vector3(.65725,.55,1.0045),ghostTextPos:new s.Vector3(.5065,.55,1.0045),camTextPos:new s.Vector3(.45625,.55,1.0045),endPosition:new s.Vector3(.35575,.55,1.0045),parent:F.parentElements[3]||null,active:!1},ghost5:{triggerPos:new s.Vector3(.15475,.55,1.15525),ghostTextPos:new s.Vector3(.205,.55,1.2055),camTextPos:new s.Vector3(.25525,.55,1.2055),endPosition:new s.Vector3(.35575,.55,1.2055),parent:F.parentElements[4]||null,active:!1}};let Q=!1,D=null;const W=["ghost1","ghost2","ghost3","ghost4","ghost5"],$=q("pov"),Z={};function K(e,t=2e3){if(!$.pacman)return 0;let r=1/0,o=0;for(let c=0;c<=t;c++){const s=c/t,n=$.pacman.getPointAt(s).distanceTo(e);n<r&&(r=n,o=s)}return o}Object.keys(U).forEach((e=>{Z[e]={ghostTextOpacity:0,camTextOpacity:0,active:!1}}));const Y={},J={},X={};function ee(e){Q=!0,Object.keys(Y).length>0||W.forEach((e=>{const t=O[e];t&&(Y[e]=t.position.clone(),J[e]=t.rotation.clone(),X[e]=t.scale.clone())}));const t=e;!function(e){if(console.log(`updatePOVCamera called with progress: ${e}`),!$.pacman)return void console.error("POV camera path not found!");const t=$.pacman.getPointAt(e);console.log(`Camera position: ${t.x.toFixed(3)}, ${t.y.toFixed(3)}, ${t.z.toFixed(3)}`),v.position.copy(t);const r=$.pacman.getTangentAt(e).normalize();if(t.clone().add(r),console.log(`Tangent: ${r.x.toFixed(3)}, ${r.y.toFixed(3)}, ${r.z.toFixed(3)}`),0===e)v.lookAt(new s.Vector3(v.position.x,2,v.position.z)),console.log("Camera: Initial position");else if(e<.1){const t=e/.1,r=new s.Vector3(v.position.x,1,v.position.z),o=new s.Vector3(v.position.x,.5,v.position.z+1),c=new s.Vector3;c.lerpVectors(r,o,re(t)),v.lookAt(c),console.log("Camera: Entry transition")}else{const r=Math.min(e+.02,1),o=$.pacman.getPointAt(r),c=(new s.Vector3).subVectors(o,t).normalize(),n=new s.Vector3(0,.05,0),p=(new s.Vector3).addVectors(c,n).normalize();!function(e){const t=new s.Matrix4;t.lookAt(v.position,e,v.up);const r=(new s.Quaternion).setFromRotationMatrix(t);if(!D)return v.quaternion.copy(r),void(D=r.clone());v.quaternion.slerpQuaternions(D,r,.3),D.copy(v.quaternion)}(t.clone().add(p)),console.log("Camera: Normal path following")}v.fov=60,v.updateProjectionMatrix(),v.updateMatrixWorld(),console.log(`Camera FOV: ${v.fov}, Final position: ${v.position.x.toFixed(3)}, ${v.position.y.toFixed(3)}, ${v.position.z.toFixed(3)}`)}(t),W.forEach((e=>{const r=O[e],o=$[e];if(r&&o){const c=K($.pacman.getPointAt(t)),n=U[e];if(n){const e=n;void 0===e.triggerCameraProgress&&(e.triggerCameraProgress=K(n.triggerPos),e.endCameraProgress=K(n.endPosition));const t=e.triggerCameraProgress,p=e.endCameraProgress;if(c>=t&&c<=p){r.visible=!0;const e=(c-t)/(p-t),n=re(re(Math.max(0,Math.min(1,e)))),i=o.getPointAt(n);r.position.copy(i),r.scale.set(.5,.5,.5);const a=o.getTangentAt(n).normalize(),u=Math.min(n+.05,1),y=o.getTangentAt(u).normalize(),l=(new s.Vector3).addVectors(a.clone().multiplyScalar(.7),y.clone().multiplyScalar(.3)).normalize(),w=r.position.clone().add(l);if(r.lookAt(w),n>.95){const e=1-(n-.95)/.05;r instanceof s.Mesh&&r.material?(r.material.opacity=Math.max(0,Math.min(1,e)),r.material.transparent=e<1):r instanceof s.Group&&r.traverse((t=>{t instanceof s.Mesh&&t.material&&(t.material.opacity=Math.max(0,Math.min(1,e)),t.material.transparent=e<1,t.material.needsUpdate=!0)}))}else r instanceof s.Mesh&&r.material?(r.material.opacity=1,r.material.transparent=!1):r instanceof s.Group&&r.traverse((e=>{e instanceof s.Mesh&&e.material&&(e.material.opacity=1,e.material.transparent=!1,e.material.needsUpdate=!0)}))}else r.visible=!1}else{const e=t%1,c=o.getPointAt(e);r.position.copy(c),r.scale.set(.5,.5,.5);const s=o.getTangentAt(e).normalize(),n=c.clone().add(s);r.lookAt(n),r.visible=!0}}})),function(e){if(!$.pacman)return;const t=$.pacman.getPointAt(e);Object.entries(U).forEach((([e,r])=>{const o=Z[e],c=K(t);void 0===o.triggerCameraProgress&&(o.triggerCameraProgress=K(r.triggerPos),o.ghostTextCameraProgress=K(r.ghostTextPos),o.camTextCameraProgress=K(r.camTextPos),o.endCameraProgress=K(r.endPosition));let s=0,n=0;if(c>=o.triggerCameraProgress){const e=o.endCameraProgress-o.triggerCameraProgress,t=o.ghostTextCameraProgress,r=t+.07*e,p=o.endCameraProgress-.15*e,i=o.endCameraProgress;if(c>=t&&c<r?s=(c-t)/(r-t):c>=r&&c<p?s=1:c>=p&&c<=i&&(s=1-(c-p)/(i-p)),c>=o.camTextCameraProgress){const t=o.camTextCameraProgress,r=t+.07*e;c>=t&&c<r?n=(c-t)/(r-t):c>=r&&c<p?n=1:c>=p&&c<=i&&(n=1*(1-(c-p)/(i-p)))}}s>o.ghostTextOpacity?o.ghostTextOpacity+=.2*(s-o.ghostTextOpacity):o.ghostTextOpacity+=.1*(s-o.ghostTextOpacity),n>o.camTextOpacity?o.camTextOpacity+=.2*(n-o.camTextOpacity):o.camTextOpacity+=.1*(n-o.camTextOpacity),function(e,t){if(!e.parent)return;const r=e.parent.querySelectorAll(".pov"),o=e.parent.querySelectorAll(".cam"),c=e.parent,s=Math.max(0,Math.min(1,Math.round(1e3*t.ghostTextOpacity)/1e3));s>.01?(c.style.opacity=s.toString(),c.style.visibility="visible",c.style.pointerEvents="auto",c.style.transition="opacity 0.3s ease-in-out"):(c.style.opacity="0",c.style.visibility="hidden",c.style.pointerEvents="none",c.style.transition="opacity 0.3s ease-in-out");const n=Math.max(0,Math.min(1,Math.round(1e3*t.camTextOpacity)/1e3));r.forEach((e=>{const t=e;if(n>.01){const e=1-n;t.style.opacity=e.toString(),t.style.visibility="visible",t.style.transition="opacity 0.4s ease-in-out",n>=.99&&(t.style.opacity="0",t.style.visibility="hidden")}else t.style.opacity="1",t.style.visibility="visible",t.style.transition="opacity 0.4s ease-in-out"})),o.forEach((e=>{const t=e;n>.01?(t.style.display="block",t.style.opacity=n.toString(),t.style.visibility="visible",t.style.transition="opacity 0.4s ease-in-out",n>=.99&&(t.style.opacity="1",t.style.visibility="visible")):(t.style.opacity="0",t.style.visibility="hidden",t.style.display="none",t.style.transition="opacity 0.4s ease-in-out")}))}(r,o)}))}(t)}function te(){console.log("Stopping POV Animation..."),Q=!1,v.fov=75,v.updateProjectionMatrix(),oe.restoreGhostsToHome(),Object.entries(U).forEach((([e,t])=>{if(t.parent){const e=t.parent;e.style.opacity="0",e.style.visibility="hidden",e.style.pointerEvents="none";const r=e.querySelectorAll(".pov"),o=e.querySelectorAll(".cam");r.forEach((e=>{const t=e;t.style.opacity="0",t.style.visibility="hidden"})),o.forEach((e=>{const t=e;t.style.opacity="0",t.style.visibility="hidden",t.style.display="none"}))}})),Object.keys(Z).forEach((e=>{Z[e]={ghostTextOpacity:0,camTextOpacity:0,active:!1}})),console.log("POV Animation stopped - ghosts should be restored to home positions")}function re(e){return e*e*(3-2*e)}const oe=new class{constructor(){this.state="HOME",this.homeProgress=0,this.scrollProgress=0,this.transitionProgress=0,this.isTransitioning=!1,this.homePositions={},this.homeRotations={},this.homeScales={},this.homePositionsCaptured=!1,this.bezierCurves={},this.cameraScrollCurve=null,this.cameraScrollStartQuat=null,this.transitionStartPositions={},this.transitionStartRotations={},this.HOME_ANIMATION_SPEED=.3,this.TRANSITION_DURATION=.5,this.CAMERA_FOV=75,this.MAZE_CENTER=new s.Vector3(.55675,.45,.45175),this.GHOST_SPEED_MULTIPLIERS={ghost1:1.2,ghost2:1,ghost3:.8,ghost4:.6,ghost5:.4,pacman:.3},this.homePaths={},this.homePathKeys=[],this.setupHomePaths()}setupHomePaths(){const e=q("home");this.homePaths=e,this.homePathKeys=["pacman","ghost1","ghost2","ghost3","ghost4","ghost5"]}getState(){return this.state}update(e){if(Q)this.handlePOVState();else{switch(this.state){case"HOME":this.animateHome(e);break;case"SCROLL_ANIMATION":this.animateScrollToCenter();break;case"TRANSITIONING":this.animateTransition(e)}this.render()}}handlePOVState(){this.state="POV_ANIMATION",this.homePositionsCaptured||this.captureHomePositions(),Object.values(O).forEach((e=>{e.visible=!0})),this.render()}setScrollProgress(e){const t=Math.max(0,Math.min(1,e));Math.abs(t-this.scrollProgress)<.001||(this.scrollProgress=t,t>.01?"HOME"===this.state&&this.startScrollAnimation():"SCROLL_ANIMATION"===this.state&&this.startTransitionToHome())}startScrollAnimation(){this.state="SCROLL_ANIMATION",this.homePositionsCaptured||(this.captureHomePositions(),this.createScrollCurves())}startTransitionToHome(){this.state="TRANSITIONING",this.isTransitioning=!0,this.transitionProgress=0,this.transitionStartPositions={},this.transitionStartRotations={},Object.entries(O).forEach((([e,t])=>{this.transitionStartPositions[e]=t.position.clone(),this.transitionStartRotations[e]=t.rotation.clone()}))}captureHomePositions(){this.homePositionsCaptured||(Object.entries(O).forEach((([e,t])=>{this.homePositions[e]=t.position.clone(),this.homeRotations[e]=t.rotation.clone(),this.homeScales[e]=t.scale.clone()})),this.homePositionsCaptured=!0)}createScrollCurves(){this.bezierCurves={},Object.entries(this.homePositions).forEach((([e,t])=>{const r=this.MAZE_CENTER.clone(),o=new s.Vector3((t.x+r.x)/2,(t.y+r.y)/2,(t.z+r.z)/2),c=new s.Vector3(o.x+.3*(o.x-(t.x+r.x)/2),o.y+1.5,o.z+.3*(o.z-(t.z+r.z)/2));this.bezierCurves[e]=new s.QuadraticBezierCurve3(t,c,r)})),this.cameraScrollCurve=new s.CubicBezierCurve3(v.position.clone(),new s.Vector3((v.position.x+this.MAZE_CENTER.x)/2,2,(v.position.z+this.MAZE_CENTER.z)/2),new s.Vector3(.55675,3,.45175),this.MAZE_CENTER.clone()),this.cameraScrollStartQuat=v.quaternion.clone()}animateHome(e){this.homeProgress=(this.homeProgress+e*this.HOME_ANIMATION_SPEED)%1,Object.entries(O).forEach((([e,t])=>{if(this.homePathKeys.includes(e)){const r=this.homePaths[e];if(r){const o=this.homeProgress,c=r.getPointAt(o);t.position.copy(c);const s=r.getTangentAt(o).normalize();if(t.lookAt(c.clone().add(s)),"pacman"===e){const e=Math.atan2(s.x,s.z);t.rotation.set(Math.PI/2,Math.PI,e+Math.PI/2)}this.setGhostOpacity(t,1)}}}))}animateScrollToCenter(){Object.entries(O).forEach((([e,t])=>{const r=this.GHOST_SPEED_MULTIPLIERS[e]||1;let o=Math.min(this.scrollProgress*r,1);const c=this.bezierCurves[e];if(!c)return;const n=c.getPointAt(o);t.position.copy(n);const p=this.homeRotations[e],i=new s.Euler(-Math.PI/2,0,0),a=(new s.Quaternion).setFromEuler(p),u=(new s.Quaternion).setFromEuler(i),y=new s.Quaternion,l=this.easeInOutCubic(o);y.slerpQuaternions(a,u,l),t.quaternion.copy(y);let w=1;this.scrollProgress>=.9&&(w=1-(this.scrollProgress-.9)/.1,w=Math.max(0,w)),this.setGhostOpacity(t,w)})),this.animateCameraScroll()}animateCameraScroll(){if(!this.cameraScrollCurve||!this.cameraScrollStartQuat)return;const e=this.cameraScrollCurve.getPoint(this.scrollProgress);v.position.copy(e),v.fov=this.CAMERA_FOV,v.updateProjectionMatrix();const t=(new s.Quaternion).setFromEuler(new s.Euler(-Math.PI/2,0,0)),r=new s.Quaternion;r.slerpQuaternions(this.cameraScrollStartQuat,t,this.scrollProgress),v.quaternion.copy(r)}animateTransition(e){this.transitionProgress+=e/this.TRANSITION_DURATION;const t=this.easeInOutCubic(Math.min(this.transitionProgress,1));Object.entries(O).forEach((([e,r])=>{if(this.homePathKeys.includes(e)){const o=this.homePaths[e];if(o){const c=o.getPointAt(this.homeProgress),n=this.transitionStartPositions[e];r.position.lerpVectors(n,c,t);const p=this.transitionStartRotations[e],i=o.getTangentAt(this.homeProgress).normalize(),a=new s.Euler;if("pacman"===e){const e=Math.atan2(i.x,i.z);a.set(Math.PI/2,Math.PI,e+Math.PI/2)}else a.setFromQuaternion((new s.Quaternion).setFromUnitVectors(new s.Vector3(0,0,1),i));const u=(new s.Quaternion).setFromEuler(p),y=(new s.Quaternion).setFromEuler(a),l=new s.Quaternion;l.slerpQuaternions(u,y,t),r.quaternion.copy(l),this.setGhostOpacity(r,1)}}})),this.transitionProgress>=1&&(this.state="HOME",this.isTransitioning=!1,this.homePositionsCaptured=!1)}restoreGhostsToHome(){Object.entries(O).forEach((([e,t])=>{this.homePositions[e]&&(t.position.copy(this.homePositions[e]),t.rotation.copy(this.homeRotations[e]),t.scale.copy(this.homeScales[e]),t.visible=!0,this.setGhostOpacity(t,1))})),this.state="HOME",this.homePositionsCaptured=!1}setGhostOpacity(e,t){function r(e){e.material&&(Array.isArray(e.material)?e.material:[e.material]).forEach((e=>{e&&(e.isMeshBasicMaterial||e.isMeshStandardMaterial||e.isMeshPhysicalMaterial||e.isMeshMatcapMaterial?(e.opacity=t,e.transparent=t<1,e.depthWrite=1===t,e.needsUpdate=!0):e.isShaderMaterial&&e.uniforms&&e.uniforms.opacity?(e.uniforms.opacity.value=t,e.needsUpdate=!0):"opacity"in e&&(e.opacity=t,e.transparent=t<1,e.depthWrite=1===t,e.needsUpdate=!0))}))}e instanceof s.Mesh?r(e):e instanceof s.Group&&e.traverse((e=>{e instanceof s.Mesh&&r(e)}))}easeInOutCubic(e){return e<.5?4*e*e*e:1-Math.pow(-2*e+2,3)/2}render(){w.render(l,v)}};function ce(){requestAnimationFrame(ce);const e=se.getDelta();ne&&ne.update(e),oe.update(e)}const se=new s.Clock;let ne=null;function pe(e){return e<.5?4*e*e*e:1-Math.pow(-2*e+2,3)/2}function ie(e){const t=F.introHeader;if(!t)return;let r=0,o=0;if(e>0&&e<1)if(e<=.2){const t=pe(e/.2);r=.8*t,o=t}else if(e<=.8)r=.8+(e-.2)/.6*.4,o=1;else{const t=(e-.8)/.2;r=1.2+.3*t,o=1-t}else e>=1?(r=1.5,o=0):(r=0,o=0);t.style.setProperty("transform",`scale(${r})`,"important"),t.style.opacity=o.toString()}function ae(e){const t=F.introBody;if(!t)return;let r=.5,o=0;if(e>0&&e<1)if(e<=.2){const t=pe(e/.2);r=.5+.3*t,o=t}else if(e<=.8)r=.8+(e-.2)/.6*.4,o=1;else{const t=(e-.8)/.2;r=1.2+.3*t,o=1-t}else e>=1?(r=1.5,o=0):(r=.5,o=0);t.style.setProperty("transform",`scale(${r})`,"important"),t.style.opacity=o.toString()}!async function(){try{n?w.setPixelRatio(Math.min(window.devicePixelRatio,2)):w.setPixelRatio(window.devicePixelRatio),w.shadowMap.enabled=!0,w.shadowMap.type=s.PCFSoftShadowMap,w.shadowMap.enabled=!0,w.shadowMap.type=s.PCFSoftShadowMap,y.mazeContainer?(w.setSize(y.mazeContainer.clientWidth,y.mazeContainer.clientHeight),y.mazeContainer.appendChild(w.domElement)):(w.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(w.domElement)),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",h):h(),window.addEventListener("resize",h),function(){const e=new s.AmbientLight(16777215);l.add(e);const t=new s.DirectionalLight(16777215,.8);l.add(t),t.position.set(-5,15,10),t.shadow.mapSize.width=4096,t.shadow.mapSize.height=4096,t.shadow.camera.left=-20,t.shadow.camera.right=20,t.shadow.camera.top=20,t.shadow.camera.bottom=-20,t.shadow.camera.near=.1,t.shadow.camera.far=50,t.shadow.bias=-.001,t.shadow.radius=3,t.castShadow=!0}(),v.position.copy(i),v.lookAt(u),window.addEventListener("resize",(()=>{v.aspect=window.innerWidth/window.innerHeight,v.updateProjectionMatrix()})),await async function(){return new Promise(((e,t)=>{f.load("https://c-am.b-cdn.net/CAM/c-am-assets-3.glb",(function(t){const r=t.scene;r.traverse((e=>{if("CAM-Pacman"===e.name){const r=[];e.traverse((e=>{if(e.isMesh&&"CAM-Pacman_Shell"!==e.name&&"CAM-Pacman_Shell_Boolean"!==e.name){const t=P[e.name]||P.default;e.material=t,r.push(e)}else"CAM-Pacman_Shell"!==e.name&&"CAM-Pacman_Shell_Boolean"!==e.name||(e.visible=!1)})),r.forEach((e=>O.pacman.add(e))),O.pacman.scale.set(.075,.075,.075),O.pacman.rotation.set(Math.PI/2,Math.PI/2,Math.PI/4),M=new s.AnimationMixer(O.pacman);const o={};t.animations.forEach((e=>{const t=M.clipAction(e);o[e.name]=t,t.setEffectiveWeight(1),t.play()}))}else if(e.name&&b[e.name]){const t=b[e.name],r=new s.Group;e.rotation.z=Math.PI,e.rotation.x=Math.PI/2,e.scale.set(.75,.75,.75);const o=[];e.traverse((e=>{e.isMesh&&(e.name&&e.name.startsWith("Ghost_Mesh")?e.material=d:e.name&&["EUR","CHF","YEN","USD","GBP"].includes(e.name)&&(e.visible=!1),o.push(e))})),o.forEach((e=>{e.name&&(e.name.includes("EUR")||e.name.startsWith("Ghost_Mesh"))?(e.rotation.z=Math.PI,e.rotation.x=Math.PI/2):e.rotation.set(0,0,0),r.add(e)})),t.add(r)}if(e.isMesh)if("CAM-Arena_LowRes_Top"===e.name)e.material=V,e.castShadow=!0;else if("CAM-Arena_LowRes_Bottom"===e.name)e.material=g,e.castShadow=!0;else if("CAM-Floor"===e.name){const t=e.clone();e.position.y=-.1,e.position.x=0,e.position.z=0,e.material=new s.MeshBasicMaterial({color:16777215,opacity:1,transparent:!1,depthWrite:!0,depthTest:!0,side:s.FrontSide}),e.receiveShadow=!1,e.castShadow=!0,e.scale.set(.5,.5,.5),t.material=A,t.position.y=-.5,t.receiveShadow=!0,l.add(t)}})),r.traverse((function(e){e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0)})),l.add(r),r.position.set(.5,.5,.5),e()}),(function(e){}),(function(e){t(e)}))}))}(),oe.restoreGhostsToHome(),ce(),async function(){try{const e=await Promise.resolve().then(c.t.bind(c,352,23)),t=await Promise.resolve().then(c.t.bind(c,774,23)),r=e.gsap||e.default,o=t.ScrollTrigger||t.default;if(!r||!o)throw new Error("GSAP modules not loaded properly");r.registerPlugin(o);const s=document.querySelector(".sc--home.sc");if(!s)return void console.warn("Home section not found, scroll animation disabled");r.timeline({scrollTrigger:{trigger:s,start:"top top",end:"bottom top",scrub:1}}).to({},{duration:1,onUpdate:function(){const e=this.progress();oe.setScrollProgress(e)}})}catch(e){console.error("❌ GSAP ScrollTrigger setup failed:",e),window.addEventListener("scroll",(()=>{const e=document.querySelector(".sc--home.sc");if(e){const t=e.getBoundingClientRect(),r=Math.max(0,Math.min(1,1-t.bottom/window.innerHeight));oe.setScrollProgress(r)}}))}}(),async function(){try{const e=await Promise.resolve().then(c.t.bind(c,352,23)),t=await Promise.resolve().then(c.t.bind(c,774,23)),r=e.gsap||e.default,o=t.ScrollTrigger||t.default;if(!r||!o)throw new Error("GSAP modules not loaded properly");r.registerPlugin(o),r.config({force3D:!0,nullTargetWarn:!1,autoSleep:60}),o.config({autoRefreshEvents:"visibilitychange,DOMContentLoaded,load",limitCallbacks:!0}),o.create({trigger:F.introSection,start:"top top",end:"center center",scrub:.3,pin:F.introHeader,pinSpacing:!1,invalidateOnRefresh:!0,onUpdate:e=>{ie(e.progress),ae(0)},onEnter:()=>F.introHeader.classList.add("intro-centered"),onEnterBack:()=>F.introHeader.classList.add("intro-centered"),onLeave:()=>F.introHeader.classList.remove("intro-centered"),onLeaveBack:()=>F.introHeader.classList.remove("intro-centered")}),o.create({trigger:F.introSection,start:"center center",end:"bottom bottom",scrub:.3,pin:F.introBody,pinSpacing:!1,invalidateOnRefresh:!0,onUpdate:e=>{const t=e.progress;ie(1),ae(t)},onEnter:()=>F.introBody.classList.add("intro-centered"),onEnterBack:()=>F.introBody.classList.add("intro-centered"),onLeave:()=>F.introBody.classList.remove("intro-centered"),onLeaveBack:()=>F.introBody.classList.remove("intro-centered")})}catch(e){console.error("❌ GSAP intro animations setup failed:",e),window.addEventListener("scroll",(()=>{if(F.introSection&&F.introHeader&&F.introBody){const e=F.introSection.getBoundingClientRect();if(e.top<=0&&e.bottom>=0){const t=Math.abs(e.top),r=Math.min(1,t/e.height);if(r<=.5)ie(r/.5),ae(0);else{const e=(r-.5)/.5;ie(1),ae(e)}}else ie(0),ae(0)}}))}}(),await async function(){if(!F.povSection)return console.error("POV section not found! Check if .sc--pov.sc exists in HTML"),console.log("Available DOM elements:",{homeSection:!!F.homeSection,introSection:!!F.introSection,povSection:!!F.povSection,finalSection:!!F.finalSection}),void console.log("All sections in document:",document.querySelectorAll('[class*="sc--"]'));if(console.log("POV section found:",F.povSection),!$.pacman)return console.error("POV paths not found! Check pathPoints.ts for POV path definitions"),void console.log("Available POV paths:",Object.keys($));console.log("POV paths loaded successfully:",Object.keys($));const e=W.filter((e=>!O[e]));e.length>0&&(console.warn("Some ghosts are missing:",e),console.log("Available ghosts:",Object.keys(O)));const t=Object.entries(U).filter((([e,t])=>!t.parent));t.length>0&&(console.warn("Some trigger elements are missing:",t.map((([e])=>e))),console.log("Available parent elements:",F.parentElements.length));const r=await Promise.resolve().then(c.t.bind(c,352,23)),o=await Promise.resolve().then(c.t.bind(c,774,23)),s=r.gsap||r.default,n=o.ScrollTrigger||o.default;s.registerPlugin(n);const p=n.create({trigger:".sc--pov",start:"top top",end:"bottom bottom",scrub:1.2,onUpdate:e=>{const t=e.progress;console.log(`POV ScrollTrigger onUpdate: progress=${t.toFixed(3)}`),ee(t)},onEnter:()=>{console.log("POV section entered!"),Q=!0},onLeave:()=>{console.log("POV section left!"),te()},onEnterBack:()=>{console.log("POV section entered (backward)!"),Q=!0},onLeaveBack:()=>{console.log("POV section left (backward)!"),te()}});console.log("POV Animation System initialized successfully!"),console.log("ScrollTrigger created:",p),window.testPOV=(e=.5)=>{console.log("=== MANUAL POV TEST ==="),function(e=.5){$.pacman?($.pacman.getPointAt(e),W.forEach((t=>{const r=$[t],o=O[t];r&&o&&r.getPointAt(e)})),ee(e)):console.error("POV camera path not found!")}(e)},window.startPOV=()=>{console.log("=== MANUAL POV START ==="),Q=!0,ee(.5)},window.stopPOV=()=>{console.log("=== MANUAL POV STOP ==="),te()}}()}catch(e){console.error("Initialization error:",e)}}()})();
//# sourceMappingURL=script.js.map