(()=>{"use strict";const e=THREE,t=window.innerWidth<768,n=new e.Vector3(.45175,.5,.55675),o=(new e.Vector3(.65725,.55,.75325),new e.Vector3(.9085,.55,.8035),new e.Vector3(.75775,.55,1.05475),new e.Vector3(.65725,.55,1.0045),new e.Vector3(.15475,.55,1.15525),{startMobile:new e.Vector3(.5,2.5,2.5),startDesktop:new e.Vector3(-2,2.5,2),secondMobile:new e.Vector3(.5,2.5,2),secondDesktop:new e.Vector3(-1.5,3,2),mobileLookAt:new e.Vector3(.5,.5,-1.5),desktopLookAt:new e.Vector3(-1.25,.5,.25)}),a=t?o.startMobile:o.startDesktop,i=t?o.mobileLookAt:o.desktopLookAt,s={mazeContainer:document.querySelector(".el--home-maze.el"),canvas:document.querySelector("canvas"),finalSection:document.querySelector(".sc--final.sc"),finalContainer:document.querySelector(".cr--final.cr"),parentElements:document.querySelectorAll(".cmp--pov.cmp")},r=new e.Scene,c=new e.WebGLRenderer({antialias:!0,alpha:!0,powerPreference:"high-performance",precision:"highp"}),m=new e.Clock;function h(){const e=Math.min(window.devicePixelRatio,t?2:3);c.setPixelRatio(e),s.mazeContainer?c.setSize(s.mazeContainer.clientWidth,s.mazeContainer.clientHeight):c.setSize(window.innerWidth,window.innerHeight)}const l=new e.PerspectiveCamera(50,window.innerWidth/window.innerHeight,.001,1e3);function d(){l.position.copy(a),l.lookAt(i)}l.quaternion.clone(),(new e.Quaternion).setFromEuler(new e.Euler(-1.5708,0,0));const w=(new e.TextureLoader).load("https://c-am.b-cdn.net/CAM/matcap24.png"),p=new e.MeshMatcapMaterial({matcap:w}),u=new e.MeshStandardMaterial({color:15923705,metalness:.4,roughness:0,envMapIntensity:10}),M=new e.MeshPhysicalMaterial({color:16777215,opacity:1,transparent:!0,depthWrite:!1,depthTest:!0,blending:e.NormalBlending,side:e.DoubleSide,roughness:.75,metalness:.2,transmission:.5}),A=new e.MeshStandardMaterial({color:16777215,opacity:.8,transparent:!0,roughness:.5,metalness:.1}),g={blue:new e.MeshBasicMaterial({color:1337811,transparent:!0,opacity:1}),white:new e.MeshBasicMaterial({color:16777215,transparent:!0,opacity:1}),default:new e.MeshBasicMaterial({color:1337811,transparent:!0,opacity:1})},S={CAM_Pacman_Backframe:g.blue,"CAM-Pacman_Bitcoin_1":g.white,"CAM-Pacman_Bitcoin_2":g.white,"CAM-Pacman_Bottom":g.blue,"CAM-Pacman_Top":g.blue,"CAM-Pacman_Eye":g.white,CAM_Pacman_Logo_1:g.white,CAM_Pacman_Logo_2:g.white,"CAM-Pacman_Shell_Boolean":g.blue,"CAM-Pacman_Shell":g.blue,"CAM-Pacman_Bottom_electronic":g.white,"CAM-Pacman_Top_electronic":g.white,"CAM-Pacman_Bottom_Text":g.white,"CAM-Pacman_Top_Text":g.white,default:g.blue},f=(Array(5).fill(M),new e.GLTFLoader);let P;const y=new e.Group;r.add(y);const C={pacman:y,ghost1:new e.Mesh(new e.BufferGeometry,M),ghost2:new e.Mesh(new e.BufferGeometry,M),ghost3:new e.Mesh(new e.BufferGeometry,M),ghost4:new e.Mesh(new e.BufferGeometry,M),ghost5:new e.Mesh(new e.BufferGeometry,M)},_={Ghost_EUR:C.ghost1,Ghost_CHF:C.ghost2,Ghost_YEN:C.ghost3,Ghost_USD:C.ghost4,Ghost_GBP:C.ghost5};Object.values(C).forEach((e=>r.add(e)));const b=new class{constructor(){this.state="IDLE",this.animationTime=0,this.animationDuration=3,this.isAnimating=!1,this.objectStartPositions={},console.log("AnimationSystem: Initializing..."),console.log("AnimationSystem: MAZE_CENTER:",n),this.cameraStartPosition=l.position.clone(),this.cameraEndPosition=new e.Vector3(n.x,n.y+2,n.z+3),this.cameraStartLookAt=new e.Vector3(0,0,0),this.cameraEndLookAt=n.clone(),console.log("AnimationSystem: Camera start position:",this.cameraStartPosition),console.log("AnimationSystem: Camera end position:",this.cameraEndPosition)}startHomeAnimation(){if(this.isAnimating)return;console.log("AnimationSystem: Starting home animation..."),console.log("AnimationSystem: Pacman position:",y.position),console.log("AnimationSystem: Ghosts:",C),this.state="HOME_ANIMATION",this.isAnimating=!0,this.animationTime=0,this.objectStartPositions={pacman:y.position.clone(),ghost1:C.ghost1.position.clone(),ghost2:C.ghost2.position.clone(),ghost3:C.ghost3.position.clone(),ghost4:C.ghost4.position.clone(),ghost5:C.ghost5.position.clone()};const t=new e.Vector3(0,0,-1);t.applyQuaternion(l.quaternion),this.cameraStartLookAt=l.position.clone().add(t.multiplyScalar(10)),console.log("AnimationSystem: Home animation started")}update(){if(!this.isAnimating)return;const e=m.getDelta();this.animationTime+=e,"HOME_ANIMATION"===this.state&&this.updateHomeAnimation()}updateHomeAnimation(){const e=Math.min(this.animationTime/this.animationDuration,1),t=this.easeInOutCubic(e);this.animateCamera(t),this.animateObjectsToCenter(t),e>=1&&this.completeHomeAnimation()}animateCamera(t){l.position.lerpVectors(this.cameraStartPosition,this.cameraEndPosition,t);const n=new e.Vector3;n.lerpVectors(this.cameraStartLookAt,this.cameraEndLookAt,t),l.lookAt(n),l.updateProjectionMatrix()}animateObjectsToCenter(t){const o=n.clone();o.y+=.5,y.position.lerpVectors(this.objectStartPositions.pacman,o,t),Object.keys(C).forEach(((n,a)=>{if("pacman"===n)return;const i=C[n],s=a/5*Math.PI*2,r=new e.Vector3(o.x+.8*Math.cos(s),o.y,o.z+.8*Math.sin(s));i.position.lerpVectors(this.objectStartPositions[n],r,t)}))}completeHomeAnimation(){this.isAnimating=!1,this.state="IDLE",console.log("AnimationSystem: Home animation completed")}easeInOutCubic(e){return e<.5?4*e*e*e:1-Math.pow(-2*e+2,3)/2}getState(){return this.state}isAnimationActive(){return this.isAnimating}render(){c.render(r,l)}};function E(){requestAnimationFrame(E),b.update(),b.render()}!async function(){try{t?c.setPixelRatio(Math.min(window.devicePixelRatio,2)):c.setPixelRatio(window.devicePixelRatio),c.shadowMap.enabled=!0,c.shadowMap.type=e.PCFSoftShadowMap,c.shadowMap.enabled=!0,c.shadowMap.type=e.PCFSoftShadowMap,s.mazeContainer?(console.log("Found maze container, using it for renderer"),c.setSize(s.mazeContainer.clientWidth,s.mazeContainer.clientHeight),s.mazeContainer.appendChild(c.domElement)):(console.log("Maze container not found, using body for renderer"),c.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(c.domElement)),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",h):h(),window.addEventListener("resize",h),function(){const t=new e.AmbientLight(16777215);r.add(t);const n=new e.DirectionalLight(16777215,.8);r.add(n),n.position.set(-5,15,10),n.shadow.mapSize.width=4096,n.shadow.mapSize.height=4096,n.shadow.camera.left=-20,n.shadow.camera.right=20,n.shadow.camera.top=20,n.shadow.camera.bottom=-20,n.shadow.camera.near=.1,n.shadow.camera.far=50,n.shadow.bias=-.001,n.shadow.radius=3,n.castShadow=!0}(),d(),window.addEventListener("resize",(()=>{l.aspect=window.innerWidth/window.innerHeight,l.updateProjectionMatrix()})),await async function(){return new Promise(((t,n)=>{f.load("https://c-am.b-cdn.net/CAM/c-am-assets-3.glb",(function(n){const o=n.scene;o.traverse((t=>{if("CAM-Pacman"===t.name){const o=[];t.traverse((e=>{if(e.isMesh&&"CAM-Pacman_Shell"!==e.name&&"CAM-Pacman_Shell_Boolean"!==e.name){const t=S[e.name]||S.default;e.material=t,o.push(e)}else"CAM-Pacman_Shell"!==e.name&&"CAM-Pacman_Shell_Boolean"!==e.name||(e.visible=!1)})),o.forEach((e=>C.pacman.add(e))),C.pacman.scale.set(.05,.05,.05),C.pacman.rotation.set(Math.PI/2,Math.PI/2,Math.PI/4),P=new e.AnimationMixer(C.pacman);const a={};n.animations.forEach((e=>{const t=P.clipAction(e);a[e.name]=t,t.setEffectiveWeight(1),t.play()}))}else if(t.name&&_[t.name]){const n=_[t.name],o=new e.Group;t.rotation.z=Math.PI,t.rotation.x=Math.PI/2,t.scale.set(.75,.75,.75);const a=[];t.traverse((e=>{e.isMesh&&(e.name&&e.name.startsWith("Ghost_Mesh")?e.material=M:e.name&&["EUR","CHF","YEN","USD","GBP"].includes(e.name)&&(e.visible=!1),a.push(e))})),a.forEach((e=>{e.name&&(e.name.includes("EUR")||e.name.startsWith("Ghost_Mesh"))?(e.rotation.z=Math.PI,e.rotation.x=Math.PI/2):e.rotation.set(0,0,0),o.add(e)})),n.add(o)}if(t.isMesh)if("CAM-Arena_LowRes_Top"===t.name)t.material=u,t.castShadow=!0;else if("CAM-Arena_LowRes_Bottom"===t.name)t.material=p,t.castShadow=!0;else if("CAM-Floor"===t.name){const n=t.clone();t.position.y=-.1,t.position.x=0,t.position.z=0,t.material=new e.MeshBasicMaterial({color:16777215,opacity:1,transparent:!1,depthWrite:!0,depthTest:!0,side:e.FrontSide}),t.receiveShadow=!1,t.castShadow=!0,t.scale.set(.5,.5,.5),n.material=A,n.position.y=-.5,n.receiveShadow=!0,r.add(n)}})),o.traverse((function(e){e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0)})),r.add(o),o.position.set(.5,.5,.5),t()}),(function(e){}),(function(e){n(e)}))}))}(),console.log("AnimationSystem: Initializing animation system..."),d(),console.log("AnimationSystem: Starting animation loop..."),E(),setTimeout((()=>{console.log("AnimationSystem: Auto-starting home animation..."),b.startHomeAnimation()}),1e3),E()}catch(e){console.error("Initialization error:",e)}}()})();
//# sourceMappingURL=script.js.map